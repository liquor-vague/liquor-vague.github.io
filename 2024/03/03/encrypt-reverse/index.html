<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>逆向中常见加解密算法总结（待更新） | BAG</title><meta name="author" content="Bag"><meta name="copyright" content="Bag"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="逆向过程中遇到的对称和非对称加密算法。">
<meta property="og:type" content="article">
<meta property="og:title" content="逆向中常见加解密算法总结（待更新）">
<meta property="og:url" content="http://liquor-vague.github.io/2024/03/03/encrypt-reverse/index.html">
<meta property="og:site_name" content="BAG">
<meta property="og:description" content="逆向过程中遇到的对称和非对称加密算法。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://liquor-vague.github.io/img/jill.jpg">
<meta property="article:published_time" content="2024-03-03T13:20:26.000Z">
<meta property="article:modified_time" content="2024-04-07T09:27:38.546Z">
<meta property="article:author" content="Bag">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://liquor-vague.github.io/img/jill.jpg"><link rel="shortcut icon" href="/img/bagicon.png"><link rel="canonical" href="http://liquor-vague.github.io/2024/03/03/encrypt-reverse/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '逆向中常见加解密算法总结（待更新）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-07 17:27:38'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/jill.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Posts</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/links"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="BAG"><span class="site-name">BAG</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Posts</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/links"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">逆向中常见加解密算法总结（待更新）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-03T13:20:26.000Z" title="发表于 2024-03-03 21:20:26">2024-03-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-07T09:27:38.546Z" title="更新于 2024-04-07 17:27:38">2024-04-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="逆向中常见加解密算法总结（待更新）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>逆向过程中遇到的对称和非对称加密算法。</p>
<span id="more"></span>



<h2 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h2><p>​		对称加密算法是指<strong>加密和解密使用同一把密钥的加密算法</strong>，它的基本实现原理是通过密钥将明文转化为密文，在传输过程中保证密文的安全性，接收方通过相同的密钥将密文还原为明文。 对称加密算法的加密脚本和解密脚本通常是相同的。</p>
<p>​		块密码(也称为 <strong>分组密码</strong> )和流密码属于对称密钥密码。块密码和流密码之间的主要区别在于，<strong>块密码</strong>通过一次获取<strong>纯文本的块</strong>将纯文本转换为密文。当<strong>流密码</strong>通过一次取 <strong>1 个字节</strong>的纯文本将纯文本转换为密文。</p>
<h3 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h3><p>​		RC4（Rivest Cipher 4）是一种<strong>流加密</strong>算法，密钥长度可变。通过生成<strong>伪随机流</strong>（S盒）（通常为256字节），与密文进行异或加密。</p>
<p>RC4的加密原理如下：</p>
<ol>
<li><p>初始化S盒，采用初始化算法KSA（Key Scheduling Algorithm）。</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//初始化函数ksa</span>
<span class="token keyword">void</span> <span class="token function">rc4_init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span>s<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> Len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> k<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>
        k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>key<span class="token punctuation">[</span>i<span class="token operator">%</span>Len<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        j<span class="token operator">=</span><span class="token punctuation">(</span>j<span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
        <span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//交换s[i]和s[j]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>伪随机密钥序列生成算法PRGA（Pseudo-Randomoeneration-Algorithm），对S盒进行加密。主要功能是将S-box搅乱，i确保S-box的每个元素都得到处理，j保证S-box的搅乱是随机的。</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//加解密PRGA</span>
<span class="token keyword">void</span> <span class="token function">rc4_crypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span>s<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span>Data<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> Len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>Len<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        i<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
        j<span class="token operator">=</span><span class="token punctuation">(</span>j<span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
        <span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//交换s[x]和s[y]</span>
        t<span class="token operator">=</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
        Data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^=</span>s<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h4 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span>  </span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//初始化函数ksa</span>
<span class="token keyword">void</span> <span class="token function">rc4_init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span>s<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> Len<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> k<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>
		k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>key<span class="token punctuation">[</span>i<span class="token operator">%</span>Len<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		j<span class="token operator">=</span><span class="token punctuation">(</span>j<span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
		<span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>							<span class="token comment">//交换s[i]和s[j]</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//加解密PRGA</span>
<span class="token keyword">void</span> <span class="token function">rc4_crypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span>s<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span>Data<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> Len<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> tmp<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> k<span class="token operator">&lt;</span>Len<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		i<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
		j<span class="token operator">=</span><span class="token punctuation">(</span>j<span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
		<span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>							<span class="token comment">//交换s[x]和s[y]</span>
		t<span class="token operator">=</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>
		Data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^=</span>s<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> s_copy<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>		<span class="token comment">//S-box和其备份</span>
	<span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"justfortest"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> pData<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pData<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//初始化s盒</span>
	<span class="token function">rc4_init</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>key<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//保存s盒</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>s_copy<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">//加密</span>
	<span class="token function">rc4_crypt</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>pData<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout<span class="token operator">&lt;&lt;</span>pData<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token comment">//解密</span>
    <span class="token function">rc4_crypt</span><span class="token punctuation">(</span>s_copy<span class="token punctuation">,</span>pData<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout<span class="token operator">&lt;&lt;</span>pData<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="TEA系列算法"><a href="#TEA系列算法" class="headerlink" title="TEA系列算法"></a>TEA系列算法</h3><p>​		<strong>微型加密算法</strong>（Tiny Encryption Algorithm，TEA）是一种易于描述和执行的<strong>块密码</strong>。</p>
<p>​		TEA系列最显著的特征是特征值<strong>delta &#x3D; 0x9e3779b9</strong></p>
<p>​		<strong>这里给出的脚本只对数组前两位的数据进行了处理，根据需求自行调整</strong>。</p>
<h4 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h4><p>TEA的分组长度为64位，密钥长度为128位，采用Feistel网络，建议32次循环加密即64轮。</p>
<p>由于加密时数相加，解密只需要将数相减即可。</p>
<p><strong>注意</strong>：tea在加密过程中会出现数溢出的情况，使用C&#x2F;C++编写脚本时，程序会自动对溢出的数进行求模处理；使用Python编写脚本时，由于Python支持大数运算，需要用<strong>ctypes</strong>库进行处理。</p>
<h5 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h5><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    sum <span class="token operator">+=</span> delta<span class="token punctuation">;</span>
    l <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    r <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>
  v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span>
  sum <span class="token operator">=</span> delta <span class="token operator">*</span><span class="token number">32</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    r <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    l <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> sum<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sum <span class="token operator">-=</span> delta<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>
  v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//test</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">encrypt</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">decrypt</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h4><p>加密算法更换，原理和TEA大同小异</p>
<h5 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h5><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    l <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sum <span class="token operator">+=</span> delta<span class="token punctuation">;</span>
    r <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> l<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>
  v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> l <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span>
  sum <span class="token operator">=</span> delta <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    r <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>l <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> l<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sum <span class="token operator">-=</span> delta<span class="token punctuation">;</span>
    l <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>
  v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//test</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">encrypt</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">decrypt</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h4><p>​		XXTEA使用更复杂的运算方式，它的块大小可以是任意的，密钥也可以是任意长度的。在加密时，XXTEA会对明文进行<strong>分块</strong>，然后每个块都会进行加密，加密后的结果再进行<strong>拼接</strong>，最终形成密文。在解密时，XXTEA会对密文进行分块，然后每个块都会进行解密，解密后的结果再进行拼接，最终形成明文。</p>
<h5 id="脚本-3"><a href="#脚本-3" class="headerlink" title="脚本"></a>脚本</h5><p><strong>注意：这个脚本可以直接传多位明文和密文加解密，无需修改</strong></p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MX</span> <span class="token punctuation">\</span>
  <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k<span class="token punctuation">[</span>p <span class="token operator">&amp;</span> <span class="token number">3</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token keyword">bool</span> <span class="token function">xxtea</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> DELTA <span class="token operator">=</span> <span class="token number">0x9e3779b9</span><span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> q<span class="token punctuation">;</span>
  <span class="token comment">//加密</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    q <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">/</span> n<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>q<span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>
      e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> z <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+=</span> MX<span class="token punctuation">;</span>
      y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> MX<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> 
  <span class="token comment">//解密</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    n <span class="token operator">=</span> <span class="token operator">-</span>n<span class="token punctuation">;</span>
    q <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">/</span> n<span class="token punctuation">;</span>
    sum <span class="token operator">=</span> q <span class="token operator">*</span> DELTA<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>sum <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> p <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> p<span class="token operator">--</span><span class="token punctuation">)</span>
        z <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-=</span> MX<span class="token punctuation">;</span>
      z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-=</span> MX<span class="token punctuation">;</span>
      sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// test</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">xxtea</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">xxtea</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u,%u\n"</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h3><p>IDEA的明文分组也是64位，密钥为128位，其加解密也是相似的，即可以用相同算法加密和解密。</p>
<h4 id="算法原理"><a href="#算法原理" class="headerlink" title="算法原理"></a>算法原理</h4><h5 id="子密钥生成"><a href="#子密钥生成" class="headerlink" title="子密钥生成"></a>子密钥生成</h5><p><strong>IDEA密钥长度为128位，子密钥长度为16位共52个</strong></p>
<p>a.128位密钥分为8个16位分组，直接作为前八个子密钥</p>
<p>b.128位密钥循环<strong>左移</strong>25位，生成的128位密钥分为8个16位分组，作为接下来的8个子密钥</p>
<p>c.继续执行步骤b，直至52个子密钥全部生成完毕</p>
<h5 id="IDEA加密"><a href="#IDEA加密" class="headerlink" title="IDEA加密"></a>IDEA加密</h5><p>64为明文被分成4个16位分组。每一轮加密都需要6个子密钥，最后的输出变换只需要4个子密钥，所以共需8*6+4&#x3D;52个子密钥。一轮加密中，4个16位子密钥分别通过2个模2^16+1（65537）乘法和2个模2^16(65536)加法运算与明文混合，并用2个16位子密钥按位异或对结果进行处理，<strong>前一轮加密结果作为后一轮加密的输入</strong>。总共进行8轮加密，最后用4个子密钥变换输出最终的密文。</p>
<h5 id="IDEA解密"><a href="#IDEA解密" class="headerlink" title="IDEA解密"></a>IDEA解密</h5><p>解密过程同加密过程，唯一不同的是子密钥不同。</p>
<p>解密所需的52个子密钥是加密子密钥相对于不同操作运输的逆元，且解密时子密钥使用顺序相反。（乘法逆元可以通过扩展欧几里得算法求出）</p>
<p>在data和key处修改需要加解密的密文和密钥，在linux环境下编译</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc <span class="token parameter variable">-o</span> idea idea.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// https://github.com/razvanalex/IDEA-encryption-algorithm</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">typedef</span> __uint32_t <span class="token keyword">uint32_t</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> __int32_t <span class="token keyword">int32_t</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> __uint16_t <span class="token keyword">uint16_t</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>idea_gen_key<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span><span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint16_t</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">uint16_t</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> a<span class="token punctuation">,</span> <span class="token keyword">uint16_t</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">uint32_t</span> c<span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> hi<span class="token punctuation">,</span> lo<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

  c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>a <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span>b<span class="token punctuation">;</span>
  hi <span class="token operator">=</span> c <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">;</span>
  lo <span class="token operator">=</span> c<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>lo <span class="token operator">></span> hi<span class="token punctuation">)</span>
    <span class="token keyword">return</span> lo <span class="token operator">-</span> hi<span class="token punctuation">;</span>
  <span class="token keyword">return</span> lo <span class="token operator">-</span> hi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">modInverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> m0 <span class="token operator">=</span> m<span class="token punctuation">,</span> t<span class="token punctuation">,</span> q<span class="token punctuation">;</span>
  <span class="token keyword">int</span> x0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> x1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>a <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// q is quotient</span>
    q <span class="token operator">=</span> a <span class="token operator">/</span> m<span class="token punctuation">;</span>
    t <span class="token operator">=</span> m<span class="token punctuation">;</span>

    <span class="token comment">// m is remainder now, process same as</span>
    <span class="token comment">// Euclid's algo</span>
    m <span class="token operator">=</span> a <span class="token operator">%</span> m<span class="token punctuation">;</span>
    a <span class="token operator">=</span> t<span class="token punctuation">;</span>

    t <span class="token operator">=</span> x0<span class="token punctuation">;</span>
    x0 <span class="token operator">=</span> x1 <span class="token operator">-</span> q <span class="token operator">*</span> x0<span class="token punctuation">;</span>
    x1 <span class="token operator">=</span> t<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// Make x1 positive</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    x1 <span class="token operator">+=</span> m0<span class="token punctuation">;</span>

  <span class="token keyword">return</span> x1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> subKey<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint16_t</span> key<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span>

  <span class="token comment">// Generate encryption keys</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">52</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span>
      subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
      subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span>
      subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
      subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> subKey<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint16_t</span> key<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> K<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// Compute encryption keys</span>
  <span class="token function">encrypt</span><span class="token punctuation">(</span>K<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Generate dencryption keys</span>
  subKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">modInverse</span><span class="token punctuation">(</span>K<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  subKey<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  subKey<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  subKey<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">modInverse</span><span class="token punctuation">(</span>K<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Keys: %04X %04X %04X %04X\n"</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         subKey<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">52</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">modInverse</span><span class="token punctuation">(</span>K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">46</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">modInverse</span><span class="token punctuation">(</span>K<span class="token punctuation">[</span><span class="token number">52</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Keys: %04X %04X %04X %04X %04X %04X\n"</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">IDEA</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">uint16_t</span> key<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> idea_gen_key func<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> subKey<span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// Generate keys</span>
  <span class="token function">func</span><span class="token punctuation">(</span>subKey<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">uint16_t</span> X0 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> X1 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> X2 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> X3 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> tmp1<span class="token punctuation">,</span> tmp2<span class="token punctuation">;</span>

  <span class="token comment">// Apply 8 rounds</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d:   %04X %04X %04X %04X\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> X0<span class="token punctuation">,</span> X1<span class="token punctuation">,</span> X2<span class="token punctuation">,</span> X3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    X0 <span class="token operator">=</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span>X0<span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Step 1</span>
    X1 <span class="token operator">+=</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token comment">// Step 2</span>
    X2 <span class="token operator">+=</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token comment">// Step 3</span>
    X3 <span class="token operator">=</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span>X3<span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Step 4</span>

    tmp1 <span class="token operator">=</span> X0 <span class="token operator">^</span> X2<span class="token punctuation">;</span>  <span class="token comment">// Step 5</span>
    tmp2 <span class="token operator">=</span> X1 <span class="token operator">^</span> X3<span class="token punctuation">;</span>  <span class="token comment">// Step 6</span>

    tmp1 <span class="token operator">=</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Step 7</span>
    tmp2 <span class="token operator">+=</span> tmp1<span class="token punctuation">;</span>                                 <span class="token comment">// Step 8</span>
    tmp2 <span class="token operator">=</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span>tmp2<span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Step 9</span>
    tmp1 <span class="token operator">+=</span> tmp2<span class="token punctuation">;</span>                                 <span class="token comment">// Step 10</span>

    X0 <span class="token operator">^=</span> tmp2<span class="token punctuation">;</span>
    X1 <span class="token operator">^=</span> tmp1<span class="token punctuation">;</span>
    X2 <span class="token operator">^=</span> tmp2<span class="token punctuation">;</span>
    X3 <span class="token operator">^=</span> tmp1<span class="token punctuation">;</span>

    <span class="token comment">// Swap X1 and X2</span>
    tmp1 <span class="token operator">=</span> X1<span class="token punctuation">;</span>
    X1 <span class="token operator">=</span> X2<span class="token punctuation">;</span>
    X2 <span class="token operator">=</span> tmp1<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  tmp1 <span class="token operator">=</span> X1<span class="token punctuation">;</span>
  tmp2 <span class="token operator">=</span> X2<span class="token punctuation">;</span>

  <span class="token comment">// Apply the half round</span>
  data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span>X0<span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp2 <span class="token operator">+</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp1 <span class="token operator">+</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mulMod65537</span><span class="token punctuation">(</span>X3<span class="token punctuation">,</span> subKey<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">uint16_t</span> <span class="token function">binToInt</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> pow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'1'</span><span class="token punctuation">)</span>
      result <span class="token operator">+=</span> pow<span class="token punctuation">;</span>
    pow <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">convertStringToBin</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> <span class="token keyword">uint16_t</span><span class="token operator">*</span> data<span class="token punctuation">,</span> <span class="token keyword">uint16_t</span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> sizeBlock <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
  <span class="token keyword">char</span> block<span class="token punctuation">[</span>sizeBlock <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       i <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>block<span class="token punctuation">,</span> str<span class="token punctuation">,</span> sizeBlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    block<span class="token punctuation">[</span>sizeBlock<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>

    data<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">binToInt</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
    str <span class="token operator">+=</span> sizeBlock<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> Data<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span>
      <span class="token string">"0000010100110010000010100110010000010100110010000001100111111010"</span><span class="token punctuation">;</span>
  <span class="token keyword">char</span> Key<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span>
      <span class="token string">"000000000110010000000000110010000000000100101100000000011001000000000001"</span>
      <span class="token string">"11110100000000100101100000000010101111000000001100100000"</span><span class="token punctuation">;</span>

  <span class="token keyword">uint16_t</span> data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">uint16_t</span> key<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">convertStringToBin</span><span class="token punctuation">(</span>Data<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">convertStringToBin</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Print initial data</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Initial data:   %04X %04X %04X %04X\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Encrypt data</span>
  <span class="token function">IDEA</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Encrypted data: %04X %04X %04X %04X\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Decrypt data</span>
  <span class="token function">IDEA</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> decrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Decrypted data: %04X %04X %04X %04X\n"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h3><p>​		DES(Data Encryption Standard)，是一种块密码，分组大小为64位，密钥长度为56位（长度总共为64位，实际为56位，第8、16、24、32、40、48、56、64位是校验位）</p>
<p>​		</p>
<p>​		逆向×密码学√</p>
<p><strong>DES加密原理</strong>如下：</p>
<img src="/2024/03/03/encrypt-reverse/802212-20161009222915538-1765873611.png" class="" title="img">



<img src="/2024/03/03/encrypt-reverse/image-20240118112522644.png" class="" title="image-20240118112522644">

<ol>
<li><strong>初始置换（Initial Permutation）：</strong> 明文经过一个初始的置换，将明文的每一位按照特定规则重新排列。</li>
<li><strong>轮函数（Feistel Network）：</strong> DES采用Feistel结构，将明文分成两个等长的半块，并且使用一个子密钥对其中一个半块进行处理。这个处理过程包括以下步骤：<ul>
<li>将右半块进行扩展，得到一个更长的半块。</li>
<li>将扩展后的半块与子密钥进行异或操作。</li>
<li>将异或的结果分成8个6位的块，每个块作为S盒的输入，经过S盒置换得到4位的输出。</li>
<li>将S盒输出合并，并经过一个固定的置换，得到一个4位的半块。</li>
<li>将这个半块与左半块进行异或操作，得到新的右半块。</li>
</ul>
</li>
<li><strong>16轮迭代：</strong> DES总共进行16轮的Feistel迭代，每轮使用不同的子密钥。</li>
<li><strong>最终置换（Final Permutation）：</strong> 在最后一轮迭代后，将左右两半块交换，然后进行一个最终的置换。</li>
<li><strong>密钥生成：</strong> DES使用56位的密钥，但实际上只有48位被用于加密过程。密钥经过置换、分割和循环左移等操作，生成16个子密钥，每个子密钥48位长。</li>
</ol>
<h4 id="脚本-4"><a href="#脚本-4" class="headerlink" title="脚本"></a>脚本</h4><p>注意：脚本只能加密8字节密文，cyberchef中使用了padding填充</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstdio></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span>

<span class="token comment">//  IP 初始置换表</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> IP_Init_Table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//  E 扩展表</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> E_Table<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token number">32</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
     <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>
    <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>  <span class="token number">1</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//  P 盒</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> P_Table<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
     <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">25</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//  IP 逆置换表</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> IPR_Table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span>
    <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span>
    <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">25</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//  密钥第一次置换表</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> PC1_Table<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//  密钥第二次置换表</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> PC2_Table<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span>
    <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">32</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//  S 盒</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> S_Box<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//  s1</span>
    <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token comment">//  s2</span>
    <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
    <span class="token comment">//  s3</span>
    <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token comment">//  s4</span>
    <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
    <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token comment">//  s5</span>
    <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token comment">//  s6</span>
    <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token comment">//  s7</span>
    <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token comment">//  s8</span>
    <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>  
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/*
 *  类型转换函数 I
 *  将 char 型转化为二进制形式
 *  8 * sizeof(char) = 8(位) 8 个字符 64 位
 */</span>
<span class="token keyword">void</span> <span class="token function">CharToBit</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> bits<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            output<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  类型转换函数 II
 *  将二进制形式转化为 char 型
 */</span>
<span class="token keyword">void</span> <span class="token function">BitToChar</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> intput<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> output<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> bits<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            output<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> output<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> intput<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  异或函数
 *  将数组 INA 和 INB 进行异或操作，并且保存在 INA 中
 */</span>
<span class="token keyword">void</span> <span class="token function">Xor</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>INA<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>INB<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>INA <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>INA <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>INB <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  IP 初始置换函数
 *  IP 根据 IP 初始置换表进行初始置换
 */</span>
<span class="token keyword">void</span> <span class="token function">IP_Init_Rep</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  E 扩展置换函数
 *  根据 E 扩展表进行扩展
 */</span>
<span class="token keyword">void</span> <span class="token function">E_Extend</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  P 置换函数
 *  根据 P 盒进行置换
 */</span>
<span class="token keyword">void</span> <span class="token function">P_Rep</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  IP 逆置换函数
 *  IP 根据 IP 逆置换表进行置换
 */</span>
<span class="token keyword">void</span> <span class="token function">IP_Inv_Rep</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  密匙第一次置换函数
 *  根据密匙第一次置换表进行置换
 */</span>
<span class="token keyword">void</span> <span class="token function">PC_1</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">56</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  密匙第二次置换函数
 *  根据密匙第二次置换表进行置换
 */</span>
<span class="token keyword">void</span> <span class="token function">PC_2</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  S 盒压缩函数
 *  根据 8 个 S 盒进行压缩
 */</span>
<span class="token keyword">void</span> <span class="token function">S_Comp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> INT<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        INT<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> table<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
               <span class="token operator">+</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
               <span class="token operator">+</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
               <span class="token operator">+</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
               <span class="token operator">+</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        j<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            output<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>INT<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  轮迭代函数
 *  DES 核心迭代部分
 */</span>
<span class="token keyword">void</span> <span class="token function">F_func</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> subKey<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> temp0<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> temp1<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">E_Extend</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> temp0<span class="token punctuation">,</span> E_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Xor</span><span class="token punctuation">(</span>temp0<span class="token punctuation">,</span> subKey<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">S_Comp</span><span class="token punctuation">(</span>temp0<span class="token punctuation">,</span> temp1<span class="token punctuation">,</span> S_Box<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">P_Rep</span><span class="token punctuation">(</span>temp1<span class="token punctuation">,</span> output<span class="token punctuation">,</span> P_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  密匙循环左移函数
 *  密匙在不同轮数都要进行不同的左移操作
 */</span>
<span class="token keyword">void</span> <span class="token function">RotateL</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> leftCount<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> input<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> leftCount<span class="token punctuation">)</span> <span class="token operator">%</span> len<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  子密匙生成函数
 *  生成 subKey，在第 1、2、9、16 轮循环左移 1 位，其他轮循环左移 2 位
 */</span>
<span class="token keyword">void</span> <span class="token function">subKey_fun</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> subKey<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> loop0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> loop1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> pc_1<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> pc_2<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> rotatel_c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> rotatel_d<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token function">PC_1</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> pc_1<span class="token punctuation">,</span> PC1_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">28</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> pc_1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> pc_1<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">int</span> leftCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">17</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">||</span> i <span class="token operator">==</span> <span class="token number">9</span> <span class="token operator">||</span> i <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            leftCount <span class="token operator">+=</span> loop0<span class="token punctuation">;</span>
            <span class="token function">RotateL</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> rotatel_c<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> leftCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">RotateL</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> rotatel_d<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> leftCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            leftCount <span class="token operator">+=</span> loop1<span class="token punctuation">;</span>
            <span class="token function">RotateL</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> rotatel_c<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> leftCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">RotateL</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> rotatel_d<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> leftCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">28</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            pc_2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> rotatel_c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            pc_2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> rotatel_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">PC_2</span><span class="token punctuation">(</span>pc_2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> PC2_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  DES 加密函数
 *  传入明文 input 和密匙 inKey，获取 64 位二进制密文 output
 */</span>
<span class="token keyword">void</span> <span class="token function">DES_Efun</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> inKey<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> ip<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> output_1<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> subKeys<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> chartobit<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> key<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> l<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">CharToBit</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> chartobit<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">IP_Init_Rep</span><span class="token punctuation">(</span>chartobit<span class="token punctuation">,</span> ip<span class="token punctuation">,</span> IP_Init_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CharToBit</span><span class="token punctuation">(</span>inKey<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">subKey_fun</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> subKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ip<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ip<span class="token punctuation">[</span><span class="token number">32</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token comment">//  15 轮迭代</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            l<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token function">F_func</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> subKeys<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Xor</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> l<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token comment">//  第 16 轮迭代</span>
    <span class="token punctuation">&#123;</span>
        r<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">F_func</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> l<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKeys<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Xor</span><span class="token punctuation">(</span>l<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> l<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output_1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
        output_1<span class="token punctuation">[</span><span class="token number">32</span> <span class="token operator">+</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">IP_Inv_Rep</span><span class="token punctuation">(</span>output_1<span class="token punctuation">,</span> output<span class="token punctuation">,</span> IPR_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
 *  DES 解密函数
 *  传入 64 位二进制密文 input 和密匙 inKey 获取明文 output
 */</span>
<span class="token keyword">void</span> <span class="token function">DES_Dfun</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> input<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> inKey<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> output<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> ip<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> output_1<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> output_2<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> subKeys<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> key<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> l<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">IP_Init_Rep</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> ip<span class="token punctuation">,</span> IP_Init_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CharToBit</span><span class="token punctuation">(</span>inKey<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">subKey_fun</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> subKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ip<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ip<span class="token punctuation">[</span><span class="token number">32</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token comment">//  15 轮迭代</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            l<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token function">F_func</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> subKeys<span class="token punctuation">[</span><span class="token number">16</span> <span class="token operator">-</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Xor</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> l<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token comment">//  第 16 轮迭代</span>
    <span class="token punctuation">&#123;</span>
        r<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">F_func</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> l<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> subKeys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Xor</span><span class="token punctuation">(</span>l<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> l<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        output_1<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
        output_1<span class="token punctuation">[</span><span class="token number">32</span> <span class="token operator">+</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">IP_Inv_Rep</span><span class="token punctuation">(</span>output_1<span class="token punctuation">,</span> output_2<span class="token punctuation">,</span> IPR_Table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BitToChar</span><span class="token punctuation">(</span>output_2<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> output<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> A<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> B<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入明文(8字节)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入密匙(8字节)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">DES_Efun</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"对明文进行加密\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"密文:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> output<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token char">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"对密文进行解密\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">DES_Dfun</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> B<span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"明文:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>代码的主要流程：</p>
<ol>
<li>输入明文和密钥。</li>
<li>将明文和密钥转换为二进制形式。</li>
<li>初始置换（IP_Init_Rep）：对明文进行初始置换。</li>
<li>子密钥生成（subKey_fun）：生成16轮的子密钥。</li>
<li>进行16轮的迭代加密&#x2F;解密过程（F_func、Xor）。</li>
<li>逆置换（IP_Inv_Rep）：对得到的结果进行逆置换，得到最终加密&#x2F;解密结果。</li>
<li>输出密文或明文。</li>
</ol>
<h4 id="拓展：3DES"><a href="#拓展：3DES" class="headerlink" title="拓展：3DES"></a>拓展：3DES</h4><p>3DES使用“密钥包”，其包含3个DES密钥，K1，K2和K3，均为56位（除去奇偶校验位）。加密算法为：</p>
<p>使用K1为密钥进行DES加密，再用K2为密钥进行DES“解密”，最后以K3进行DES加密。</p>
<p>而解密则为其反过程：</p>
<p>即以K3解密，以K2“加密”，最后以K1解密。</p>
<p>每次加密操作都只处理64位数据，称为一块。</p>
<p>无论是加密还是解密，中间一步都是前后两步的逆。这种做法提高了使用密钥选项2时的算法强度，并在使用密钥选项3时与DES兼容。</p>
<ul>
<li>密钥选项1：三个密钥是独立的。</li>
<li>密钥选项2：K1和K2是独立的，而K3&#x3D;K1</li>
<li>密钥选项3：三个密钥均相等，即K1&#x3D;K2&#x3D;K3</li>
</ul>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>AES（Advanced Encryption Standard）是一种对称加密算法，其加密过程涉及几个主要步骤，包括轮密钥加、轮替代、轮混淆和轮置换。以下是AES加密的简要过程：</p>
<ol>
<li><strong>密钥扩展（Key Expansion）：</strong><ul>
<li>根据初始密钥，生成一系列轮密钥（Round Keys），这些轮密钥将用于后续的加密轮次。</li>
</ul>
</li>
<li><strong>初始轮密钥加（AddRoundKey）：</strong><ul>
<li>将明文与第一个轮密钥进行异或操作。</li>
</ul>
</li>
<li><strong>多轮加密（Rounds）：</strong><ul>
<li>AES的加密过程包含多轮加密。标准的AES分为10轮（128位密钥）、12轮（192位密钥）和14轮（256位密钥）。</li>
<li>每一轮加密包括四个步骤：轮替代（SubBytes）、行移位（ShiftRows）、列混淆（MixColumns）和轮密钥加（AddRoundKey）。<ul>
<li><strong>轮替代（SubBytes）：</strong> 对每个字节使用S盒进行替代。</li>
<li><strong>行移位（ShiftRows）：</strong> 对每一行进行循环左移。第一行不移动，第二行左移1字节，第三行左移2字节，第四行左移3字节。</li>
<li><strong>列混淆（MixColumns）：</strong> 对列进行混淆操作，涉及到一系列的线性变换。</li>
<li><strong>轮密钥加（AddRoundKey）：</strong> 将当前状态与对应的轮密钥进行异或操作。</li>
</ul>
</li>
</ul>
</li>
<li><strong>最终轮：</strong><ul>
<li>在最后一轮，省略列混淆步骤，只执行轮替代、行移位和轮密钥加。</li>
</ul>
</li>
<li><strong>输出密文：</strong><ul>
<li>在多轮加密完成后，得到最终的密文。</li>
</ul>
</li>
</ol>
<p>总体而言，AES的加密过程是一个迭代的过程，每一轮都涉及一系列的操作，其中包括字节替代、行移位、列混淆和轮密钥加。这些步骤的组合确保了AES的安全性。密文的长度等于明文块的长度，AES支持128位、192位和256位的密钥，对应不同的安全级别。</p>
<p>在加解密过程中，如果输入的数据的长度非16的倍数，则需要对该数据进行padding处理。</p>
<p><strong>简单总结AES</strong>：</p>
<p>明文与密钥表进行异或，然后多轮（每轮先用S盒替换，再行移位，列混淆，轮密钥异或），最后一轮省略列混淆。</p>
<h4 id="AES的分类"><a href="#AES的分类" class="headerlink" title="AES的分类"></a>AES的分类</h4><p><code>cbc</code>本质上和<code>ecb</code>差别不大，唯一区别是<code>cbc</code>将前一次加密结果，与要加密的内容异或。因此，<code>cbc</code>的并行性较差，因为每次都要等待前一次的结果，而<code>ecb</code>则不用，速度较快。</p>
<p>加密过程比较复杂，可以看这个视频：</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1i341187fK/?share_source=copy_web&vd_source=e96311532f2f7af12b275834dfed9adb">【AES加密算法】| AES加密过程详解| 对称加密| Rijndael-128| 密码学| 信息安全</a></p>
<p>脚本来源：<a target="_blank" rel="noopener" href="https://github.com/dhuertas/AES">GitHub - dhuertas&#x2F;AES: AES algorithm implementation in C</a></p>
<p>在Linux运行，修改main.c里面的数据即可。好像这个只能对16字节明文加密。</p>
<h3 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h3><p>SM4是一种<strong>分组密码算法</strong>，由我国国家密码管理局在2012年发布，常用于无线互联网加密等领域。</p>
<h4 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h4><p><strong>F函数</strong></p>
<p><em>F(X0, X1, X2, X3, rk) &#x3D; X0 ⊕ T(X1 ⊕ X2 ⊕ X3 ⊕ rk)</em></p>
<p><strong>合成置换T</strong></p>
<p>由非线性变换τ 和线性变换L复合合成 <em>T(x)&#x3D;L(τ(x))</em></p>
<p><strong>非线性变换τ</strong></p>
<p>τ由四个并行的S-box组成（S-box为16*16 * 8bits，输入8bits，输出8bits）</p>
<p>若输出为<em>A(A0, A1, A2, A3)*，输出为*B(B0, B1, B2, B3)</em></p>
<p>则<em>B(B0, B1, B2, B3) &#x3D; τ(A) &#x3D; (S-box(A0), S-box(A1), S-box(A2), S-box(A3)</em></p>
<p><strong>线性变换L</strong></p>
<p>线性变换L的输入是非线性变换τ的输出</p>
<p>输出<em>C &#x3D; L(B) &#x3D; B ⊕ (B &lt;&lt;&lt; 2) ⊕ (B &lt;&lt;&lt; 10) ⊕ (B &lt;&lt;&lt; 18) ⊕ (B &lt;&lt;&lt; 24)</em></p>
<p><strong>T’变换</strong></p>
<p><em>T’(x)&#x3D;L’(τ(x))</em></p>
<p><strong>L’变换</strong></p>
<p><em>C &#x3D; L(B) &#x3D; B ⊕ (B &lt;&lt;&lt; 13) ⊕ (B &lt;&lt;&lt; 23)</em></p>
<p>反序变换<em>R(A0, A1, A2, A3) &#x3D; (A3, A2, A1, A0)</em></p>
<h4 id="密钥扩展算法"><a href="#密钥扩展算法" class="headerlink" title="密钥扩展算法"></a>密钥扩展算法</h4><p>加密密钥128位为 <em>MK(MK0, MK1, MK2, MK3)</em></p>
<p>子密钥128位，共32个为<em>rk0, rk1 , … , rk31</em></p>
<p>系统参数<strong>FKi</strong>取值为FK[4] &#x3D; {0xa3b1bac6, 0x56aa3350, 0x677d9197, 0xb27022dc}</p>
<p>固定参数<strong>CKi</strong>取值为 CK[32] &#x3D; {</p>
<p> 0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1,</p>
<p> 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249,</p>
<p> 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1,</p>
<p> 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299,</p>
<p> 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41,</p>
<p> 0x484f565d, 0x646b7279};</p>
<p><strong>子密钥生成算法如下</strong></p>
<p>(K0,K1,K2,K3)&#x3D;(MK0 ⊕ FK0, MK1⊕FK1, MK2⊕FK2, MK3⊕FK3)</p>
<p>rki &#x3D; K(i+4) &#x3D; Ki ⊕ T’(K(i+1) ⊕ K(i+2) ⊕ K(i+3) ⊕ CKi) (i &#x3D; 0 ,1 , … , 31)*</p>
<h4 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h4><p>明文输入为X(X0, X1, X2, X3)*，密文输出为*Y(Y0, Y1, Y2, Y3)</p>
<p>Xi+4 &#x3D; F(Xi, Xi+1, Xi+2, Xi+3, rki) &#x3D; Xi ⊕ T(Xi+1 ⊕ Xi+2 ⊕ Xi+3 ⊕ rki) (i &#x3D; 0 ,1 , … , 31)</p>
<p>Y(Y0, Y1, Y2, Y3) &#x3D; R(X32, X33, X34, X35) &#x3D; (X35, X34, X33, X32)</p>
<h4 id="解密算法"><a href="#解密算法" class="headerlink" title="解密算法"></a>解密算法</h4><p>解密算法和加密算法相同，唯一区别是密钥使用顺序要<strong>逆序</strong>使用</p>
<h4 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h4><p>CK值是固定的</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> CK<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token number">0x00070e15</span><span class="token punctuation">,</span> <span class="token number">0x1c232a31</span><span class="token punctuation">,</span> <span class="token number">0x383f464d</span><span class="token punctuation">,</span> <span class="token number">0x545b6269</span><span class="token punctuation">,</span> <span class="token number">0x70777e85</span><span class="token punctuation">,</span> <span class="token number">0x8c939aa1</span><span class="token punctuation">,</span>
    <span class="token number">0xa8afb6bd</span><span class="token punctuation">,</span> <span class="token number">0xc4cbd2d9</span><span class="token punctuation">,</span> <span class="token number">0xe0e7eef5</span><span class="token punctuation">,</span> <span class="token number">0xfc030a11</span><span class="token punctuation">,</span> <span class="token number">0x181f262d</span><span class="token punctuation">,</span> <span class="token number">0x343b4249</span><span class="token punctuation">,</span>
    <span class="token number">0x50575e65</span><span class="token punctuation">,</span> <span class="token number">0x6c737a81</span><span class="token punctuation">,</span> <span class="token number">0x888f969d</span><span class="token punctuation">,</span> <span class="token number">0xa4abb2b9</span><span class="token punctuation">,</span> <span class="token number">0xc0c7ced5</span><span class="token punctuation">,</span> <span class="token number">0xdce3eaf1</span><span class="token punctuation">,</span>
    <span class="token number">0xf8ff060d</span><span class="token punctuation">,</span> <span class="token number">0x141b2229</span><span class="token punctuation">,</span> <span class="token number">0x30373e45</span><span class="token punctuation">,</span> <span class="token number">0x4c535a61</span><span class="token punctuation">,</span> <span class="token number">0x686f767d</span><span class="token punctuation">,</span> <span class="token number">0x848b9299</span><span class="token punctuation">,</span>
    <span class="token number">0xa0a7aeb5</span><span class="token punctuation">,</span> <span class="token number">0xbcc3cad1</span><span class="token punctuation">,</span> <span class="token number">0xd8dfe6ed</span><span class="token punctuation">,</span> <span class="token number">0xf4fb0209</span><span class="token punctuation">,</span> <span class="token number">0x10171e25</span><span class="token punctuation">,</span> <span class="token number">0x2c333a41</span><span class="token punctuation">,</span>
    <span class="token number">0x484f565d</span><span class="token punctuation">,</span> <span class="token number">0x646b7279</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="脚本-5"><a href="#脚本-5" class="headerlink" title="脚本"></a>脚本</h4><p>只进行ecb加密</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/**
 * \file sm4.h
 */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">XYSSL_SM4_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">XYSSL_SM4_H</span></span>
 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SM4_ENCRYPT</span>     <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SM4_DECRYPT</span>     <span class="token expression"><span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">GET_ULONG_BE</span></span>
<span class="token comment">//将字符型数组b的第i到第i+3位的二进制拼接成一个4*8=32bit的整数，存入n中</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GET_ULONG_BE</span><span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">,</span>b<span class="token punctuation">,</span>i<span class="token punctuation">)</span>                             </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">&#123;</span>                                                       </span><span class="token punctuation">\</span>
    <span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span> <span class="token punctuation">)</span>        </span><span class="token punctuation">\</span>
        <span class="token expression"><span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token punctuation">)</span>        </span><span class="token punctuation">\</span>
        <span class="token expression"><span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span>  <span class="token number">8</span> <span class="token punctuation">)</span>        </span><span class="token punctuation">\</span>
        <span class="token expression"><span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span>       <span class="token punctuation">)</span><span class="token punctuation">;</span>       </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">&#125;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token comment">//将整数n的32位的二进制表示转换为4个char的数组，存入数组b的第i到第i+3位</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">PUT_ULONG_BE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">PUT_ULONG_BE</span><span class="token expression"><span class="token punctuation">(</span>n<span class="token punctuation">,</span>b<span class="token punctuation">,</span>i<span class="token punctuation">)</span>                             </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">&#123;</span>                                                       </span><span class="token punctuation">\</span>
    <span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">24</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       </span><span class="token punctuation">\</span>
    <span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       </span><span class="token punctuation">\</span>
    <span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">>></span>  <span class="token number">8</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       </span><span class="token punctuation">\</span>
    <span class="token expression"><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>       <span class="token punctuation">)</span><span class="token punctuation">;</span>       </span><span class="token punctuation">\</span>
<span class="token expression"><span class="token punctuation">&#125;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token comment">//循环左移 的巧妙实现（SHL(x,n)可以得到左移n位之后的结果，然后与右移的结果((x) >> (32 - n))逐位或来将右边空缺的n位补齐，效率比较高。） </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name function">SHL</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> n<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">SHL</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SWAP</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> t <span class="token operator">=</span> a<span class="token punctuation">;</span> a <span class="token operator">=</span> b<span class="token punctuation">;</span> b <span class="token operator">=</span> t<span class="token punctuation">;</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></span></span>
 
<span class="token comment">/**
 * \brief          SM4 context structure
 */</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> mode<span class="token punctuation">;</span>                   <span class="token comment">/*!&lt;  encrypt/decrypt   */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sk<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">/*!&lt;  SM4 subkeys       */</span>
<span class="token punctuation">&#125;</span>
sm4_context<span class="token punctuation">;</span>
 
 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token punctuation">&#123;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
 
<span class="token comment">/**
 * \brief          SM4 key schedule (128-bit, encryption)
 *
 * \param ctx      SM4 context to be initialized
 * \param key      16-byte secret key
 */</span>
<span class="token keyword">void</span> <span class="token function">sm4_setkey_enc</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * \brief          SM4 key schedule (128-bit, decryption)
 *
 * \param ctx      SM4 context to be initialized
 * \param key      16-byte secret key
 */</span>
<span class="token keyword">void</span> <span class="token function">sm4_setkey_dec</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * \brief          SM4-ECB block encryption/decryption
 * \param ctx      SM4 context
 * \param mode     SM4_ENCRYPT or SM4_DECRYPT
 * \param length   length of the input data
 * \param input    input block
 * \param output   output block
 */</span>
<span class="token keyword">void</span> <span class="token function">sm4_crypt_ecb</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span>
				     <span class="token keyword">int</span> mode<span class="token punctuation">,</span>
					 <span class="token keyword">int</span> length<span class="token punctuation">,</span>
                     <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">,</span>
                     <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * \brief          SM4-CBC buffer encryption/decryption
 * \param ctx      SM4 context
 * \param mode     SM4_ENCRYPT or SM4_DECRYPT
 * \param length   length of the input data
 * \param iv       initialization vector (updated after use)
 * \param input    buffer holding the input data
 * \param output   buffer holding the output data
 */</span>
<span class="token keyword">void</span> <span class="token function">sm4_crypt_cbc</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span>
                     <span class="token keyword">int</span> mode<span class="token punctuation">,</span>
                     <span class="token keyword">int</span> length<span class="token punctuation">,</span>
                     <span class="token keyword">unsigned</span> <span class="token keyword">char</span> iv<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">,</span>
                     <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>output <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">&#125;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">/* sm4.h */</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/*
sm4.cpp
*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"sm4.h"</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

 
<span class="token comment">//S盒 </span>
<span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> Sbox<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  
    <span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span>  
    <span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span>  
    <span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span>  
    <span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span>  
    <span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span>  
    <span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span>  
    <span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span>  
    <span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span>  
    <span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span>  
    <span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span>  
    <span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span>  
    <span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span>  
    <span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span>  
    <span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span>  
    <span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span>  
    <span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x48</span>  
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">//CK为固定参数 </span>
<span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> CK<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  
    <span class="token number">0x00070e15</span><span class="token punctuation">,</span> <span class="token number">0x1c232a31</span><span class="token punctuation">,</span> <span class="token number">0x383f464d</span><span class="token punctuation">,</span> <span class="token number">0x545b6269</span><span class="token punctuation">,</span>  
    <span class="token number">0x70777e85</span><span class="token punctuation">,</span> <span class="token number">0x8c939aa1</span><span class="token punctuation">,</span> <span class="token number">0xa8afb6bd</span><span class="token punctuation">,</span> <span class="token number">0xc4cbd2d9</span><span class="token punctuation">,</span>  
    <span class="token number">0xe0e7eef5</span><span class="token punctuation">,</span> <span class="token number">0xfc030a11</span><span class="token punctuation">,</span> <span class="token number">0x181f262d</span><span class="token punctuation">,</span> <span class="token number">0x343b4249</span><span class="token punctuation">,</span>  
    <span class="token number">0x50575e65</span><span class="token punctuation">,</span> <span class="token number">0x6c737a81</span><span class="token punctuation">,</span> <span class="token number">0x888f969d</span><span class="token punctuation">,</span> <span class="token number">0xa4abb2b9</span><span class="token punctuation">,</span>  
    <span class="token number">0xc0c7ced5</span><span class="token punctuation">,</span> <span class="token number">0xdce3eaf1</span><span class="token punctuation">,</span> <span class="token number">0xf8ff060d</span><span class="token punctuation">,</span> <span class="token number">0x141b2229</span><span class="token punctuation">,</span>  
    <span class="token number">0x30373e45</span><span class="token punctuation">,</span> <span class="token number">0x4c535a61</span><span class="token punctuation">,</span> <span class="token number">0x686f767d</span><span class="token punctuation">,</span> <span class="token number">0x848b9299</span><span class="token punctuation">,</span>  
    <span class="token number">0xa0a7aeb5</span><span class="token punctuation">,</span> <span class="token number">0xbcc3cad1</span><span class="token punctuation">,</span> <span class="token number">0xd8dfe6ed</span><span class="token punctuation">,</span> <span class="token number">0xf4fb0209</span><span class="token punctuation">,</span>  
    <span class="token number">0x10171e25</span><span class="token punctuation">,</span> <span class="token number">0x2c333a41</span><span class="token punctuation">,</span> <span class="token number">0x484f565d</span><span class="token punctuation">,</span> <span class="token number">0x646b7279</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">//FK为系统参数 </span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> FK<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0xa3b1bac6</span><span class="token punctuation">,</span><span class="token number">0x56aa3350</span><span class="token punctuation">,</span><span class="token number">0x677d9197</span><span class="token punctuation">,</span><span class="token number">0xb27022dc</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> inch<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pTable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>Sbox<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> retVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pTable<span class="token punctuation">[</span>inch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> retVal<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//已知加密密钥MK，求轮转密钥rk</span>
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">sm4CaliRk</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> ka<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//复合变换T</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> bb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//unsigned long 4字节( 32bit ) </span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> rk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ka<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">//换转成8bit一个字符 </span>
	b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4Sbox</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">//将变换结果转换为32bit的整数</span>
	<span class="token comment">//对得到的32位整数bb进行线性变换	</span>
	rk <span class="token operator">=</span> bb<span class="token operator">^</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> rk<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sm4_setkey</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> SK<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> MK<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> k<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>MK<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>MK<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>MK<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>MK<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> MK<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>FK<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">32</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span><span class="token function">sm4CaliRk</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>CK<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		SK<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>	
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">sm4_setkey_enc</span><span class="token punctuation">(</span>sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	ctx<span class="token operator">-></span>mode <span class="token operator">=</span> SM4_ENCRYPT<span class="token punctuation">;</span>
	<span class="token function">sm4_setkey</span><span class="token punctuation">(</span>ctx<span class="token operator">-></span>sk<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">sm4Lt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> ka<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> bb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ka<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">//    b[0] = sm4Sbox(a[0]);</span>
<span class="token comment">//    b[1] = sm4Sbox(a[1]);</span>
<span class="token comment">//    b[2] = sm4Sbox(a[2]);</span>
<span class="token comment">//    b[3] = sm4Sbox(a[3]);</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> Sbox<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> Sbox<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> Sbox<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> Sbox<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span>bb<span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ROTL</span><span class="token punctuation">(</span>bb<span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//一轮加密 </span>
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">sm4F</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> x0<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> x1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> x2<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> x3<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> rk<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>x0<span class="token operator">^</span><span class="token function">sm4Lt</span><span class="token punctuation">(</span>x1<span class="token operator">^</span>x2<span class="token operator">^</span>x3<span class="token operator">^</span>rk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sm4_one_round</span><span class="token punctuation">(</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sk<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> output<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> ulbuf<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">memset</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span>
    <span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">)</span>
    <span class="token function">GET_ULONG_BE</span><span class="token punctuation">(</span> ulbuf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">12</span> <span class="token punctuation">)</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sm4F</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ulbuf<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sk<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// #ifdef _DEBUG</span>
<span class="token comment">//          printf("rk(%02d) = 0x%08x,  X(%02d) = 0x%08x \n",i,sk[i], i, ulbuf[i+4] );</span>
<span class="token comment">// #endif</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PUT_ULONG_BE</span><span class="token punctuation">(</span>ulbuf<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ECB模式 </span>
<span class="token keyword">void</span> <span class="token function">sm4_crypt_ecb</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span>
				   <span class="token keyword">int</span> mode<span class="token punctuation">,</span>
				   <span class="token keyword">int</span> length<span class="token punctuation">,</span>
				   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">,</span>
                   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>output<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span> length <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">sm4_one_round</span><span class="token punctuation">(</span> ctx<span class="token operator">-></span>sk<span class="token punctuation">,</span> input<span class="token punctuation">,</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>
        input  <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
        output <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
        length <span class="token operator">-=</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
 
<span class="token punctuation">&#125;</span>
<span class="token comment">//ECB模式解密密钥 </span>
<span class="token keyword">void</span> <span class="token function">sm4_setkey_dec</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
	ctx<span class="token operator">-></span>mode <span class="token operator">=</span> SM4_ENCRYPT<span class="token punctuation">;</span>
    <span class="token function">sm4_setkey</span><span class="token punctuation">(</span> ctx<span class="token operator">-></span>sk<span class="token punctuation">,</span> key <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">SWAP</span><span class="token punctuation">(</span> ctx<span class="token operator">-></span>sk<span class="token punctuation">[</span> i <span class="token punctuation">]</span><span class="token punctuation">,</span> ctx<span class="token operator">-></span>sk<span class="token punctuation">[</span> <span class="token number">31</span><span class="token operator">-</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//CBC模式加解密 </span>
<span class="token keyword">void</span> <span class="token function">sm4_crypt_cbc</span><span class="token punctuation">(</span> sm4_context <span class="token operator">*</span>ctx<span class="token punctuation">,</span>
                    <span class="token keyword">int</span> mode<span class="token punctuation">,</span>
                    <span class="token keyword">int</span> length<span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> iv<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>output <span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
    <span class="token keyword">if</span><span class="token punctuation">(</span> mode <span class="token operator">==</span> SM4_ENCRYPT <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span> length <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span>
                output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span> input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
            <span class="token function">sm4_one_round</span><span class="token punctuation">(</span> ctx<span class="token operator">-></span>sk<span class="token punctuation">,</span> output<span class="token punctuation">,</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">memcpy</span><span class="token punctuation">(</span> iv<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
            input  <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
            output <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
            length <span class="token operator">-=</span> <span class="token number">16</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token comment">/* SM4_DECRYPT */</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span> length <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">memcpy</span><span class="token punctuation">(</span> temp<span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">sm4_one_round</span><span class="token punctuation">(</span> ctx<span class="token operator">-></span>sk<span class="token punctuation">,</span> input<span class="token punctuation">,</span> output <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
            <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span>
                output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span> output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
            <span class="token function">memcpy</span><span class="token punctuation">(</span> iv<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
            input  <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
            output <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
            length <span class="token operator">-=</span> <span class="token number">16</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> output<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	sm4_context ctx<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> i<span class="token punctuation">;</span>
	<span class="token comment">//encrypt</span>
	<span class="token function">sm4_setkey_enc</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">sm4_crypt_ecb</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span>input<span class="token punctuation">,</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//加密结果 </span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"encrypt：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span>output<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">sm4_setkey_dec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">sm4_crypt_ecb</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span>output<span class="token punctuation">,</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//解密结果 </span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"decrypt：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span>output<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> 
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>两个文件放在同一目录下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">g++ <span class="token parameter variable">-o</span> sm4 sm4.cpp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h3 id="BlowFish"><a href="#BlowFish" class="headerlink" title="BlowFish"></a>BlowFish</h3><p> <strong>BlowFish</strong> 是一个对称加密的加密算法。由<strong>Bruce Schneier</strong>，1993年设计的。是一个免费自由使用的加密算法。</p>
<ul>
<li>BlowFish是一个对称区块加密算法。每次加密数据为 <strong>64位</strong> （8 Byte)</li>
<li>BlowFish 密钥采用32-448位(密钥可以是动态长度)</li>
<li>BlowFish是由一个16轮循环的Feistel结构进行加密的。</li>
</ul>
<p>总结：就是将一个数 拆分为 左右各32位数值 （也就是 8个字节 左边四个字节，右边四个字节），然后左边进行 ^ key_pbox 当作下一次循环的右边。 右边则是 右边 ^ F(左边) 下次当作循环的左边。</p>
<img src="/2024/03/03/encrypt-reverse/1197364-20210614225109286-1752341738.png" class="" title="img">

<h4 id="算法原理-1"><a href="#算法原理-1" class="headerlink" title="算法原理"></a>算法原理</h4><h5 id="子密钥生成-1"><a href="#子密钥生成-1" class="headerlink" title="子密钥生成"></a>子密钥生成</h5><p>子密钥生成使用了由18个32位字组成的<strong>P数组</strong>，就是要将我们的<strong>Key</strong> 与 <strong>pbox</strong>进行 异或</p>
<p>4个8*32的包含1024个32位字的S-box</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">uint32_t</span> P<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">uint32_t</span> S<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>步骤：</strong></p>
<p>1.按顺序使用常数Π的小数部分初始化P数组和S-box</p>
<p>2.对P数组和密钥进行逐位异或，必要时重用密钥</p>
<p>3.使用当前的P数组和S-box对全0的64位分组使用BlowFish算法进行加密，用输出代替P[1]、P[2]</p>
<p>4.重复以上步骤使用当前的P数组和S-box对上一步输出进行加密，并用输出代替P[3]、P[4]，直到按顺序替代所有的P数组和S-box中的元素为止</p>
<h5 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h5><p>f函数输入是一个32位双字，共4个字节，分别作为4个S-box的索引，取出相应的S-box的值然后进行模2^32加运算</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">F</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">F</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>S1<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">+</span> S2<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> S3<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> S4<span class="token punctuation">[</span>d<span class="token punctuation">]</span>
<span class="token comment">// x = a &lt;&lt; 24 + b &lt;&lt; 16 + c &lt;&lt; 8 + d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>加密是由16轮的Feistel网络组成</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">encrypt</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span> <span class="token operator">&amp;</span> L<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span> <span class="token operator">&amp;</span> R<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">16</span> <span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      L <span class="token operator">^=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      R <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
      R <span class="token operator">^=</span> P<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      L <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span>
   L <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   R <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token function">swap</span> <span class="token punctuation">(</span>L<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h5><p>解密方法与加密方法相同，只是P数组要逆序使用</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">decrypt</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span> <span class="token operator">&amp;</span> L<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span> <span class="token operator">&amp;</span> R<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">16</span> <span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      L <span class="token operator">^=</span> P<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      R <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
      R <span class="token operator">^=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      L <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span>
   L <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   R <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token function">swap</span> <span class="token punctuation">(</span>L<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="脚本-6"><a href="#脚本-6" class="headerlink" title="脚本"></a>脚本</h4><p>目前只找到这个，具体怎么样把明文分割为l和r有待研究</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token comment">// P array</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> P<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x243F6A88L</span><span class="token punctuation">,</span> <span class="token number">0x85A308D3L</span><span class="token punctuation">,</span> <span class="token number">0x13198A2EL</span><span class="token punctuation">,</span> <span class="token number">0x03707344L</span><span class="token punctuation">,</span>
                      <span class="token number">0xA4093822L</span><span class="token punctuation">,</span> <span class="token number">0x299F31D0L</span><span class="token punctuation">,</span> <span class="token number">0x082EFA98L</span><span class="token punctuation">,</span> <span class="token number">0xEC4E6C89L</span><span class="token punctuation">,</span>
                      <span class="token number">0x452821E6L</span><span class="token punctuation">,</span> <span class="token number">0x38D01377L</span><span class="token punctuation">,</span> <span class="token number">0xBE5466CFL</span><span class="token punctuation">,</span> <span class="token number">0x34E90C6CL</span><span class="token punctuation">,</span>
                      <span class="token number">0xC0AC29B7L</span><span class="token punctuation">,</span> <span class="token number">0xC97C50DDL</span><span class="token punctuation">,</span> <span class="token number">0x3F84D5B5L</span><span class="token punctuation">,</span> <span class="token number">0xB5470917L</span><span class="token punctuation">,</span>
                      <span class="token number">0x9216D5D9L</span><span class="token punctuation">,</span> <span class="token number">0x8979FB1BL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// S-box</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> S<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#123;</span><span class="token number">0xD1310BA6L</span><span class="token punctuation">,</span> <span class="token number">0x98DFB5ACL</span><span class="token punctuation">,</span> <span class="token number">0x2FFD72DBL</span><span class="token punctuation">,</span> <span class="token number">0xD01ADFB7L</span><span class="token punctuation">,</span> <span class="token number">0xB8E1AFEDL</span><span class="token punctuation">,</span>
     <span class="token number">0x6A267E96L</span><span class="token punctuation">,</span> <span class="token number">0xBA7C9045L</span><span class="token punctuation">,</span> <span class="token number">0xF12C7F99L</span><span class="token punctuation">,</span> <span class="token number">0x24A19947L</span><span class="token punctuation">,</span> <span class="token number">0xB3916CF7L</span><span class="token punctuation">,</span>
     <span class="token number">0x0801F2E2L</span><span class="token punctuation">,</span> <span class="token number">0x858EFC16L</span><span class="token punctuation">,</span> <span class="token number">0x636920D8L</span><span class="token punctuation">,</span> <span class="token number">0x71574E69L</span><span class="token punctuation">,</span> <span class="token number">0xA458FEA3L</span><span class="token punctuation">,</span>
     <span class="token number">0xF4933D7EL</span><span class="token punctuation">,</span> <span class="token number">0x0D95748FL</span><span class="token punctuation">,</span> <span class="token number">0x728EB658L</span><span class="token punctuation">,</span> <span class="token number">0x718BCD58L</span><span class="token punctuation">,</span> <span class="token number">0x82154AEEL</span><span class="token punctuation">,</span>
     <span class="token number">0x7B54A41DL</span><span class="token punctuation">,</span> <span class="token number">0xC25A59B5L</span><span class="token punctuation">,</span> <span class="token number">0x9C30D539L</span><span class="token punctuation">,</span> <span class="token number">0x2AF26013L</span><span class="token punctuation">,</span> <span class="token number">0xC5D1B023L</span><span class="token punctuation">,</span>
     <span class="token number">0x286085F0L</span><span class="token punctuation">,</span> <span class="token number">0xCA417918L</span><span class="token punctuation">,</span> <span class="token number">0xB8DB38EFL</span><span class="token punctuation">,</span> <span class="token number">0x8E79DCB0L</span><span class="token punctuation">,</span> <span class="token number">0x603A180EL</span><span class="token punctuation">,</span>
     <span class="token number">0x6C9E0E8BL</span><span class="token punctuation">,</span> <span class="token number">0xB01E8A3EL</span><span class="token punctuation">,</span> <span class="token number">0xD71577C1L</span><span class="token punctuation">,</span> <span class="token number">0xBD314B27L</span><span class="token punctuation">,</span> <span class="token number">0x78AF2FDAL</span><span class="token punctuation">,</span>
     <span class="token number">0x55605C60L</span><span class="token punctuation">,</span> <span class="token number">0xE65525F3L</span><span class="token punctuation">,</span> <span class="token number">0xAA55AB94L</span><span class="token punctuation">,</span> <span class="token number">0x57489862L</span><span class="token punctuation">,</span> <span class="token number">0x63E81440L</span><span class="token punctuation">,</span>
     <span class="token number">0x55CA396AL</span><span class="token punctuation">,</span> <span class="token number">0x2AAB10B6L</span><span class="token punctuation">,</span> <span class="token number">0xB4CC5C34L</span><span class="token punctuation">,</span> <span class="token number">0x1141E8CEL</span><span class="token punctuation">,</span> <span class="token number">0xA15486AFL</span><span class="token punctuation">,</span>
     <span class="token number">0x7C72E993L</span><span class="token punctuation">,</span> <span class="token number">0xB3EE1411L</span><span class="token punctuation">,</span> <span class="token number">0x636FBC2AL</span><span class="token punctuation">,</span> <span class="token number">0x2BA9C55DL</span><span class="token punctuation">,</span> <span class="token number">0x741831F6L</span><span class="token punctuation">,</span>
     <span class="token number">0xCE5C3E16L</span><span class="token punctuation">,</span> <span class="token number">0x9B87931EL</span><span class="token punctuation">,</span> <span class="token number">0xAFD6BA33L</span><span class="token punctuation">,</span> <span class="token number">0x6C24CF5CL</span><span class="token punctuation">,</span> <span class="token number">0x7A325381L</span><span class="token punctuation">,</span>
     <span class="token number">0x28958677L</span><span class="token punctuation">,</span> <span class="token number">0x3B8F4898L</span><span class="token punctuation">,</span> <span class="token number">0x6B4BB9AFL</span><span class="token punctuation">,</span> <span class="token number">0xC4BFE81BL</span><span class="token punctuation">,</span> <span class="token number">0x66282193L</span><span class="token punctuation">,</span>
     <span class="token number">0x61D809CCL</span><span class="token punctuation">,</span> <span class="token number">0xFB21A991L</span><span class="token punctuation">,</span> <span class="token number">0x487CAC60L</span><span class="token punctuation">,</span> <span class="token number">0x5DEC8032L</span><span class="token punctuation">,</span> <span class="token number">0xEF845D5DL</span><span class="token punctuation">,</span>
     <span class="token number">0xE98575B1L</span><span class="token punctuation">,</span> <span class="token number">0xDC262302L</span><span class="token punctuation">,</span> <span class="token number">0xEB651B88L</span><span class="token punctuation">,</span> <span class="token number">0x23893E81L</span><span class="token punctuation">,</span> <span class="token number">0xD396ACC5L</span><span class="token punctuation">,</span>
     <span class="token number">0x0F6D6FF3L</span><span class="token punctuation">,</span> <span class="token number">0x83F44239L</span><span class="token punctuation">,</span> <span class="token number">0x2E0B4482L</span><span class="token punctuation">,</span> <span class="token number">0xA4842004L</span><span class="token punctuation">,</span> <span class="token number">0x69C8F04AL</span><span class="token punctuation">,</span>
     <span class="token number">0x9E1F9B5EL</span><span class="token punctuation">,</span> <span class="token number">0x21C66842L</span><span class="token punctuation">,</span> <span class="token number">0xF6E96C9AL</span><span class="token punctuation">,</span> <span class="token number">0x670C9C61L</span><span class="token punctuation">,</span> <span class="token number">0xABD388F0L</span><span class="token punctuation">,</span>
     <span class="token number">0x6A51A0D2L</span><span class="token punctuation">,</span> <span class="token number">0xD8542F68L</span><span class="token punctuation">,</span> <span class="token number">0x960FA728L</span><span class="token punctuation">,</span> <span class="token number">0xAB5133A3L</span><span class="token punctuation">,</span> <span class="token number">0x6EEF0B6CL</span><span class="token punctuation">,</span>
     <span class="token number">0x137A3BE4L</span><span class="token punctuation">,</span> <span class="token number">0xBA3BF050L</span><span class="token punctuation">,</span> <span class="token number">0x7EFB2A98L</span><span class="token punctuation">,</span> <span class="token number">0xA1F1651DL</span><span class="token punctuation">,</span> <span class="token number">0x39AF0176L</span><span class="token punctuation">,</span>
     <span class="token number">0x66CA593EL</span><span class="token punctuation">,</span> <span class="token number">0x82430E88L</span><span class="token punctuation">,</span> <span class="token number">0x8CEE8619L</span><span class="token punctuation">,</span> <span class="token number">0x456F9FB4L</span><span class="token punctuation">,</span> <span class="token number">0x7D84A5C3L</span><span class="token punctuation">,</span>
     <span class="token number">0x3B8B5EBEL</span><span class="token punctuation">,</span> <span class="token number">0xE06F75D8L</span><span class="token punctuation">,</span> <span class="token number">0x85C12073L</span><span class="token punctuation">,</span> <span class="token number">0x401A449FL</span><span class="token punctuation">,</span> <span class="token number">0x56C16AA6L</span><span class="token punctuation">,</span>
     <span class="token number">0x4ED3AA62L</span><span class="token punctuation">,</span> <span class="token number">0x363F7706L</span><span class="token punctuation">,</span> <span class="token number">0x1BFEDF72L</span><span class="token punctuation">,</span> <span class="token number">0x429B023DL</span><span class="token punctuation">,</span> <span class="token number">0x37D0D724L</span><span class="token punctuation">,</span>
     <span class="token number">0xD00A1248L</span><span class="token punctuation">,</span> <span class="token number">0xDB0FEAD3L</span><span class="token punctuation">,</span> <span class="token number">0x49F1C09BL</span><span class="token punctuation">,</span> <span class="token number">0x075372C9L</span><span class="token punctuation">,</span> <span class="token number">0x80991B7BL</span><span class="token punctuation">,</span>
     <span class="token number">0x25D479D8L</span><span class="token punctuation">,</span> <span class="token number">0xF6E8DEF7L</span><span class="token punctuation">,</span> <span class="token number">0xE3FE501AL</span><span class="token punctuation">,</span> <span class="token number">0xB6794C3BL</span><span class="token punctuation">,</span> <span class="token number">0x976CE0BDL</span><span class="token punctuation">,</span>
     <span class="token number">0x04C006BAL</span><span class="token punctuation">,</span> <span class="token number">0xC1A94FB6L</span><span class="token punctuation">,</span> <span class="token number">0x409F60C4L</span><span class="token punctuation">,</span> <span class="token number">0x5E5C9EC2L</span><span class="token punctuation">,</span> <span class="token number">0x196A2463L</span><span class="token punctuation">,</span>
     <span class="token number">0x68FB6FAFL</span><span class="token punctuation">,</span> <span class="token number">0x3E6C53B5L</span><span class="token punctuation">,</span> <span class="token number">0x1339B2EBL</span><span class="token punctuation">,</span> <span class="token number">0x3B52EC6FL</span><span class="token punctuation">,</span> <span class="token number">0x6DFC511FL</span><span class="token punctuation">,</span>
     <span class="token number">0x9B30952CL</span><span class="token punctuation">,</span> <span class="token number">0xCC814544L</span><span class="token punctuation">,</span> <span class="token number">0xAF5EBD09L</span><span class="token punctuation">,</span> <span class="token number">0xBEE3D004L</span><span class="token punctuation">,</span> <span class="token number">0xDE334AFDL</span><span class="token punctuation">,</span>
     <span class="token number">0x660F2807L</span><span class="token punctuation">,</span> <span class="token number">0x192E4BB3L</span><span class="token punctuation">,</span> <span class="token number">0xC0CBA857L</span><span class="token punctuation">,</span> <span class="token number">0x45C8740FL</span><span class="token punctuation">,</span> <span class="token number">0xD20B5F39L</span><span class="token punctuation">,</span>
     <span class="token number">0xB9D3FBDBL</span><span class="token punctuation">,</span> <span class="token number">0x5579C0BDL</span><span class="token punctuation">,</span> <span class="token number">0x1A60320AL</span><span class="token punctuation">,</span> <span class="token number">0xD6A100C6L</span><span class="token punctuation">,</span> <span class="token number">0x402C7279L</span><span class="token punctuation">,</span>
     <span class="token number">0x679F25FEL</span><span class="token punctuation">,</span> <span class="token number">0xFB1FA3CCL</span><span class="token punctuation">,</span> <span class="token number">0x8EA5E9F8L</span><span class="token punctuation">,</span> <span class="token number">0xDB3222F8L</span><span class="token punctuation">,</span> <span class="token number">0x3C7516DFL</span><span class="token punctuation">,</span>
     <span class="token number">0xFD616B15L</span><span class="token punctuation">,</span> <span class="token number">0x2F501EC8L</span><span class="token punctuation">,</span> <span class="token number">0xAD0552ABL</span><span class="token punctuation">,</span> <span class="token number">0x323DB5FAL</span><span class="token punctuation">,</span> <span class="token number">0xFD238760L</span><span class="token punctuation">,</span>
     <span class="token number">0x53317B48L</span><span class="token punctuation">,</span> <span class="token number">0x3E00DF82L</span><span class="token punctuation">,</span> <span class="token number">0x9E5C57BBL</span><span class="token punctuation">,</span> <span class="token number">0xCA6F8CA0L</span><span class="token punctuation">,</span> <span class="token number">0x1A87562EL</span><span class="token punctuation">,</span>
     <span class="token number">0xDF1769DBL</span><span class="token punctuation">,</span> <span class="token number">0xD542A8F6L</span><span class="token punctuation">,</span> <span class="token number">0x287EFFC3L</span><span class="token punctuation">,</span> <span class="token number">0xAC6732C6L</span><span class="token punctuation">,</span> <span class="token number">0x8C4F5573L</span><span class="token punctuation">,</span>
     <span class="token number">0x695B27B0L</span><span class="token punctuation">,</span> <span class="token number">0xBBCA58C8L</span><span class="token punctuation">,</span> <span class="token number">0xE1FFA35DL</span><span class="token punctuation">,</span> <span class="token number">0xB8F011A0L</span><span class="token punctuation">,</span> <span class="token number">0x10FA3D98L</span><span class="token punctuation">,</span>
     <span class="token number">0xFD2183B8L</span><span class="token punctuation">,</span> <span class="token number">0x4AFCB56CL</span><span class="token punctuation">,</span> <span class="token number">0x2DD1D35BL</span><span class="token punctuation">,</span> <span class="token number">0x9A53E479L</span><span class="token punctuation">,</span> <span class="token number">0xB6F84565L</span><span class="token punctuation">,</span>
     <span class="token number">0xD28E49BCL</span><span class="token punctuation">,</span> <span class="token number">0x4BFB9790L</span><span class="token punctuation">,</span> <span class="token number">0xE1DDF2DAL</span><span class="token punctuation">,</span> <span class="token number">0xA4CB7E33L</span><span class="token punctuation">,</span> <span class="token number">0x62FB1341L</span><span class="token punctuation">,</span>
     <span class="token number">0xCEE4C6E8L</span><span class="token punctuation">,</span> <span class="token number">0xEF20CADAL</span><span class="token punctuation">,</span> <span class="token number">0x36774C01L</span><span class="token punctuation">,</span> <span class="token number">0xD07E9EFEL</span><span class="token punctuation">,</span> <span class="token number">0x2BF11FB4L</span><span class="token punctuation">,</span>
     <span class="token number">0x95DBDA4DL</span><span class="token punctuation">,</span> <span class="token number">0xAE909198L</span><span class="token punctuation">,</span> <span class="token number">0xEAAD8E71L</span><span class="token punctuation">,</span> <span class="token number">0x6B93D5A0L</span><span class="token punctuation">,</span> <span class="token number">0xD08ED1D0L</span><span class="token punctuation">,</span>
     <span class="token number">0xAFC725E0L</span><span class="token punctuation">,</span> <span class="token number">0x8E3C5B2FL</span><span class="token punctuation">,</span> <span class="token number">0x8E7594B7L</span><span class="token punctuation">,</span> <span class="token number">0x8FF6E2FBL</span><span class="token punctuation">,</span> <span class="token number">0xF2122B64L</span><span class="token punctuation">,</span>
     <span class="token number">0x8888B812L</span><span class="token punctuation">,</span> <span class="token number">0x900DF01CL</span><span class="token punctuation">,</span> <span class="token number">0x4FAD5EA0L</span><span class="token punctuation">,</span> <span class="token number">0x688FC31CL</span><span class="token punctuation">,</span> <span class="token number">0xD1CFF191L</span><span class="token punctuation">,</span>
     <span class="token number">0xB3A8C1ADL</span><span class="token punctuation">,</span> <span class="token number">0x2F2F2218L</span><span class="token punctuation">,</span> <span class="token number">0xBE0E1777L</span><span class="token punctuation">,</span> <span class="token number">0xEA752DFEL</span><span class="token punctuation">,</span> <span class="token number">0x8B021FA1L</span><span class="token punctuation">,</span>
     <span class="token number">0xE5A0CC0FL</span><span class="token punctuation">,</span> <span class="token number">0xB56F74E8L</span><span class="token punctuation">,</span> <span class="token number">0x18ACF3D6L</span><span class="token punctuation">,</span> <span class="token number">0xCE89E299L</span><span class="token punctuation">,</span> <span class="token number">0xB4A84FE0L</span><span class="token punctuation">,</span>
     <span class="token number">0xFD13E0B7L</span><span class="token punctuation">,</span> <span class="token number">0x7CC43B81L</span><span class="token punctuation">,</span> <span class="token number">0xD2ADA8D9L</span><span class="token punctuation">,</span> <span class="token number">0x165FA266L</span><span class="token punctuation">,</span> <span class="token number">0x80957705L</span><span class="token punctuation">,</span>
     <span class="token number">0x93CC7314L</span><span class="token punctuation">,</span> <span class="token number">0x211A1477L</span><span class="token punctuation">,</span> <span class="token number">0xE6AD2065L</span><span class="token punctuation">,</span> <span class="token number">0x77B5FA86L</span><span class="token punctuation">,</span> <span class="token number">0xC75442F5L</span><span class="token punctuation">,</span>
     <span class="token number">0xFB9D35CFL</span><span class="token punctuation">,</span> <span class="token number">0xEBCDAF0CL</span><span class="token punctuation">,</span> <span class="token number">0x7B3E89A0L</span><span class="token punctuation">,</span> <span class="token number">0xD6411BD3L</span><span class="token punctuation">,</span> <span class="token number">0xAE1E7E49L</span><span class="token punctuation">,</span>
     <span class="token number">0x00250E2DL</span><span class="token punctuation">,</span> <span class="token number">0x2071B35EL</span><span class="token punctuation">,</span> <span class="token number">0x226800BBL</span><span class="token punctuation">,</span> <span class="token number">0x57B8E0AFL</span><span class="token punctuation">,</span> <span class="token number">0x2464369BL</span><span class="token punctuation">,</span>
     <span class="token number">0xF009B91EL</span><span class="token punctuation">,</span> <span class="token number">0x5563911DL</span><span class="token punctuation">,</span> <span class="token number">0x59DFA6AAL</span><span class="token punctuation">,</span> <span class="token number">0x78C14389L</span><span class="token punctuation">,</span> <span class="token number">0xD95A537FL</span><span class="token punctuation">,</span>
     <span class="token number">0x207D5BA2L</span><span class="token punctuation">,</span> <span class="token number">0x02E5B9C5L</span><span class="token punctuation">,</span> <span class="token number">0x83260376L</span><span class="token punctuation">,</span> <span class="token number">0x6295CFA9L</span><span class="token punctuation">,</span> <span class="token number">0x11C81968L</span><span class="token punctuation">,</span>
     <span class="token number">0x4E734A41L</span><span class="token punctuation">,</span> <span class="token number">0xB3472DCAL</span><span class="token punctuation">,</span> <span class="token number">0x7B14A94AL</span><span class="token punctuation">,</span> <span class="token number">0x1B510052L</span><span class="token punctuation">,</span> <span class="token number">0x9A532915L</span><span class="token punctuation">,</span>
     <span class="token number">0xD60F573FL</span><span class="token punctuation">,</span> <span class="token number">0xBC9BC6E4L</span><span class="token punctuation">,</span> <span class="token number">0x2B60A476L</span><span class="token punctuation">,</span> <span class="token number">0x81E67400L</span><span class="token punctuation">,</span> <span class="token number">0x08BA6FB5L</span><span class="token punctuation">,</span>
     <span class="token number">0x571BE91FL</span><span class="token punctuation">,</span> <span class="token number">0xF296EC6BL</span><span class="token punctuation">,</span> <span class="token number">0x2A0DD915L</span><span class="token punctuation">,</span> <span class="token number">0xB6636521L</span><span class="token punctuation">,</span> <span class="token number">0xE7B9F9B6L</span><span class="token punctuation">,</span>
     <span class="token number">0xFF34052EL</span><span class="token punctuation">,</span> <span class="token number">0xC5855664L</span><span class="token punctuation">,</span> <span class="token number">0x53B02D5DL</span><span class="token punctuation">,</span> <span class="token number">0xA99F8FA1L</span><span class="token punctuation">,</span> <span class="token number">0x08BA4799L</span><span class="token punctuation">,</span>
     <span class="token number">0x6E85076AL</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token number">0x4B7A70E9L</span><span class="token punctuation">,</span> <span class="token number">0xB5B32944L</span><span class="token punctuation">,</span> <span class="token number">0xDB75092EL</span><span class="token punctuation">,</span> <span class="token number">0xC4192623L</span><span class="token punctuation">,</span> <span class="token number">0xAD6EA6B0L</span><span class="token punctuation">,</span>
     <span class="token number">0x49A7DF7DL</span><span class="token punctuation">,</span> <span class="token number">0x9CEE60B8L</span><span class="token punctuation">,</span> <span class="token number">0x8FEDB266L</span><span class="token punctuation">,</span> <span class="token number">0xECAA8C71L</span><span class="token punctuation">,</span> <span class="token number">0x699A17FFL</span><span class="token punctuation">,</span>
     <span class="token number">0x5664526CL</span><span class="token punctuation">,</span> <span class="token number">0xC2B19EE1L</span><span class="token punctuation">,</span> <span class="token number">0x193602A5L</span><span class="token punctuation">,</span> <span class="token number">0x75094C29L</span><span class="token punctuation">,</span> <span class="token number">0xA0591340L</span><span class="token punctuation">,</span>
     <span class="token number">0xE4183A3EL</span><span class="token punctuation">,</span> <span class="token number">0x3F54989AL</span><span class="token punctuation">,</span> <span class="token number">0x5B429D65L</span><span class="token punctuation">,</span> <span class="token number">0x6B8FE4D6L</span><span class="token punctuation">,</span> <span class="token number">0x99F73FD6L</span><span class="token punctuation">,</span>
     <span class="token number">0xA1D29C07L</span><span class="token punctuation">,</span> <span class="token number">0xEFE830F5L</span><span class="token punctuation">,</span> <span class="token number">0x4D2D38E6L</span><span class="token punctuation">,</span> <span class="token number">0xF0255DC1L</span><span class="token punctuation">,</span> <span class="token number">0x4CDD2086L</span><span class="token punctuation">,</span>
     <span class="token number">0x8470EB26L</span><span class="token punctuation">,</span> <span class="token number">0x6382E9C6L</span><span class="token punctuation">,</span> <span class="token number">0x021ECC5EL</span><span class="token punctuation">,</span> <span class="token number">0x09686B3FL</span><span class="token punctuation">,</span> <span class="token number">0x3EBAEFC9L</span><span class="token punctuation">,</span>
     <span class="token number">0x3C971814L</span><span class="token punctuation">,</span> <span class="token number">0x6B6A70A1L</span><span class="token punctuation">,</span> <span class="token number">0x687F3584L</span><span class="token punctuation">,</span> <span class="token number">0x52A0E286L</span><span class="token punctuation">,</span> <span class="token number">0xB79C5305L</span><span class="token punctuation">,</span>
     <span class="token number">0xAA500737L</span><span class="token punctuation">,</span> <span class="token number">0x3E07841CL</span><span class="token punctuation">,</span> <span class="token number">0x7FDEAE5CL</span><span class="token punctuation">,</span> <span class="token number">0x8E7D44ECL</span><span class="token punctuation">,</span> <span class="token number">0x5716F2B8L</span><span class="token punctuation">,</span>
     <span class="token number">0xB03ADA37L</span><span class="token punctuation">,</span> <span class="token number">0xF0500C0DL</span><span class="token punctuation">,</span> <span class="token number">0xF01C1F04L</span><span class="token punctuation">,</span> <span class="token number">0x0200B3FFL</span><span class="token punctuation">,</span> <span class="token number">0xAE0CF51AL</span><span class="token punctuation">,</span>
     <span class="token number">0x3CB574B2L</span><span class="token punctuation">,</span> <span class="token number">0x25837A58L</span><span class="token punctuation">,</span> <span class="token number">0xDC0921BDL</span><span class="token punctuation">,</span> <span class="token number">0xD19113F9L</span><span class="token punctuation">,</span> <span class="token number">0x7CA92FF6L</span><span class="token punctuation">,</span>
     <span class="token number">0x94324773L</span><span class="token punctuation">,</span> <span class="token number">0x22F54701L</span><span class="token punctuation">,</span> <span class="token number">0x3AE5E581L</span><span class="token punctuation">,</span> <span class="token number">0x37C2DADCL</span><span class="token punctuation">,</span> <span class="token number">0xC8B57634L</span><span class="token punctuation">,</span>
     <span class="token number">0x9AF3DDA7L</span><span class="token punctuation">,</span> <span class="token number">0xA9446146L</span><span class="token punctuation">,</span> <span class="token number">0x0FD0030EL</span><span class="token punctuation">,</span> <span class="token number">0xECC8C73EL</span><span class="token punctuation">,</span> <span class="token number">0xA4751E41L</span><span class="token punctuation">,</span>
     <span class="token number">0xE238CD99L</span><span class="token punctuation">,</span> <span class="token number">0x3BEA0E2FL</span><span class="token punctuation">,</span> <span class="token number">0x3280BBA1L</span><span class="token punctuation">,</span> <span class="token number">0x183EB331L</span><span class="token punctuation">,</span> <span class="token number">0x4E548B38L</span><span class="token punctuation">,</span>
     <span class="token number">0x4F6DB908L</span><span class="token punctuation">,</span> <span class="token number">0x6F420D03L</span><span class="token punctuation">,</span> <span class="token number">0xF60A04BFL</span><span class="token punctuation">,</span> <span class="token number">0x2CB81290L</span><span class="token punctuation">,</span> <span class="token number">0x24977C79L</span><span class="token punctuation">,</span>
     <span class="token number">0x5679B072L</span><span class="token punctuation">,</span> <span class="token number">0xBCAF89AFL</span><span class="token punctuation">,</span> <span class="token number">0xDE9A771FL</span><span class="token punctuation">,</span> <span class="token number">0xD9930810L</span><span class="token punctuation">,</span> <span class="token number">0xB38BAE12L</span><span class="token punctuation">,</span>
     <span class="token number">0xDCCF3F2EL</span><span class="token punctuation">,</span> <span class="token number">0x5512721FL</span><span class="token punctuation">,</span> <span class="token number">0x2E6B7124L</span><span class="token punctuation">,</span> <span class="token number">0x501ADDE6L</span><span class="token punctuation">,</span> <span class="token number">0x9F84CD87L</span><span class="token punctuation">,</span>
     <span class="token number">0x7A584718L</span><span class="token punctuation">,</span> <span class="token number">0x7408DA17L</span><span class="token punctuation">,</span> <span class="token number">0xBC9F9ABCL</span><span class="token punctuation">,</span> <span class="token number">0xE94B7D8CL</span><span class="token punctuation">,</span> <span class="token number">0xEC7AEC3AL</span><span class="token punctuation">,</span>
     <span class="token number">0xDB851DFAL</span><span class="token punctuation">,</span> <span class="token number">0x63094366L</span><span class="token punctuation">,</span> <span class="token number">0xC464C3D2L</span><span class="token punctuation">,</span> <span class="token number">0xEF1C1847L</span><span class="token punctuation">,</span> <span class="token number">0x3215D908L</span><span class="token punctuation">,</span>
     <span class="token number">0xDD433B37L</span><span class="token punctuation">,</span> <span class="token number">0x24C2BA16L</span><span class="token punctuation">,</span> <span class="token number">0x12A14D43L</span><span class="token punctuation">,</span> <span class="token number">0x2A65C451L</span><span class="token punctuation">,</span> <span class="token number">0x50940002L</span><span class="token punctuation">,</span>
     <span class="token number">0x133AE4DDL</span><span class="token punctuation">,</span> <span class="token number">0x71DFF89EL</span><span class="token punctuation">,</span> <span class="token number">0x10314E55L</span><span class="token punctuation">,</span> <span class="token number">0x81AC77D6L</span><span class="token punctuation">,</span> <span class="token number">0x5F11199BL</span><span class="token punctuation">,</span>
     <span class="token number">0x043556F1L</span><span class="token punctuation">,</span> <span class="token number">0xD7A3C76BL</span><span class="token punctuation">,</span> <span class="token number">0x3C11183BL</span><span class="token punctuation">,</span> <span class="token number">0x5924A509L</span><span class="token punctuation">,</span> <span class="token number">0xF28FE6EDL</span><span class="token punctuation">,</span>
     <span class="token number">0x97F1FBFAL</span><span class="token punctuation">,</span> <span class="token number">0x9EBABF2CL</span><span class="token punctuation">,</span> <span class="token number">0x1E153C6EL</span><span class="token punctuation">,</span> <span class="token number">0x86E34570L</span><span class="token punctuation">,</span> <span class="token number">0xEAE96FB1L</span><span class="token punctuation">,</span>
     <span class="token number">0x860E5E0AL</span><span class="token punctuation">,</span> <span class="token number">0x5A3E2AB3L</span><span class="token punctuation">,</span> <span class="token number">0x771FE71CL</span><span class="token punctuation">,</span> <span class="token number">0x4E3D06FAL</span><span class="token punctuation">,</span> <span class="token number">0x2965DCB9L</span><span class="token punctuation">,</span>
     <span class="token number">0x99E71D0FL</span><span class="token punctuation">,</span> <span class="token number">0x803E89D6L</span><span class="token punctuation">,</span> <span class="token number">0x5266C825L</span><span class="token punctuation">,</span> <span class="token number">0x2E4CC978L</span><span class="token punctuation">,</span> <span class="token number">0x9C10B36AL</span><span class="token punctuation">,</span>
     <span class="token number">0xC6150EBAL</span><span class="token punctuation">,</span> <span class="token number">0x94E2EA78L</span><span class="token punctuation">,</span> <span class="token number">0xA5FC3C53L</span><span class="token punctuation">,</span> <span class="token number">0x1E0A2DF4L</span><span class="token punctuation">,</span> <span class="token number">0xF2F74EA7L</span><span class="token punctuation">,</span>
     <span class="token number">0x361D2B3DL</span><span class="token punctuation">,</span> <span class="token number">0x1939260FL</span><span class="token punctuation">,</span> <span class="token number">0x19C27960L</span><span class="token punctuation">,</span> <span class="token number">0x5223A708L</span><span class="token punctuation">,</span> <span class="token number">0xF71312B6L</span><span class="token punctuation">,</span>
     <span class="token number">0xEBADFE6EL</span><span class="token punctuation">,</span> <span class="token number">0xEAC31F66L</span><span class="token punctuation">,</span> <span class="token number">0xE3BC4595L</span><span class="token punctuation">,</span> <span class="token number">0xA67BC883L</span><span class="token punctuation">,</span> <span class="token number">0xB17F37D1L</span><span class="token punctuation">,</span>
     <span class="token number">0x018CFF28L</span><span class="token punctuation">,</span> <span class="token number">0xC332DDEFL</span><span class="token punctuation">,</span> <span class="token number">0xBE6C5AA5L</span><span class="token punctuation">,</span> <span class="token number">0x65582185L</span><span class="token punctuation">,</span> <span class="token number">0x68AB9802L</span><span class="token punctuation">,</span>
     <span class="token number">0xEECEA50FL</span><span class="token punctuation">,</span> <span class="token number">0xDB2F953BL</span><span class="token punctuation">,</span> <span class="token number">0x2AEF7DADL</span><span class="token punctuation">,</span> <span class="token number">0x5B6E2F84L</span><span class="token punctuation">,</span> <span class="token number">0x1521B628L</span><span class="token punctuation">,</span>
     <span class="token number">0x29076170L</span><span class="token punctuation">,</span> <span class="token number">0xECDD4775L</span><span class="token punctuation">,</span> <span class="token number">0x619F1510L</span><span class="token punctuation">,</span> <span class="token number">0x13CCA830L</span><span class="token punctuation">,</span> <span class="token number">0xEB61BD96L</span><span class="token punctuation">,</span>
     <span class="token number">0x0334FE1EL</span><span class="token punctuation">,</span> <span class="token number">0xAA0363CFL</span><span class="token punctuation">,</span> <span class="token number">0xB5735C90L</span><span class="token punctuation">,</span> <span class="token number">0x4C70A239L</span><span class="token punctuation">,</span> <span class="token number">0xD59E9E0BL</span><span class="token punctuation">,</span>
     <span class="token number">0xCBAADE14L</span><span class="token punctuation">,</span> <span class="token number">0xEECC86BCL</span><span class="token punctuation">,</span> <span class="token number">0x60622CA7L</span><span class="token punctuation">,</span> <span class="token number">0x9CAB5CABL</span><span class="token punctuation">,</span> <span class="token number">0xB2F3846EL</span><span class="token punctuation">,</span>
     <span class="token number">0x648B1EAFL</span><span class="token punctuation">,</span> <span class="token number">0x19BDF0CAL</span><span class="token punctuation">,</span> <span class="token number">0xA02369B9L</span><span class="token punctuation">,</span> <span class="token number">0x655ABB50L</span><span class="token punctuation">,</span> <span class="token number">0x40685A32L</span><span class="token punctuation">,</span>
     <span class="token number">0x3C2AB4B3L</span><span class="token punctuation">,</span> <span class="token number">0x319EE9D5L</span><span class="token punctuation">,</span> <span class="token number">0xC021B8F7L</span><span class="token punctuation">,</span> <span class="token number">0x9B540B19L</span><span class="token punctuation">,</span> <span class="token number">0x875FA099L</span><span class="token punctuation">,</span>
     <span class="token number">0x95F7997EL</span><span class="token punctuation">,</span> <span class="token number">0x623D7DA8L</span><span class="token punctuation">,</span> <span class="token number">0xF837889AL</span><span class="token punctuation">,</span> <span class="token number">0x97E32D77L</span><span class="token punctuation">,</span> <span class="token number">0x11ED935FL</span><span class="token punctuation">,</span>
     <span class="token number">0x16681281L</span><span class="token punctuation">,</span> <span class="token number">0x0E358829L</span><span class="token punctuation">,</span> <span class="token number">0xC7E61FD6L</span><span class="token punctuation">,</span> <span class="token number">0x96DEDFA1L</span><span class="token punctuation">,</span> <span class="token number">0x7858BA99L</span><span class="token punctuation">,</span>
     <span class="token number">0x57F584A5L</span><span class="token punctuation">,</span> <span class="token number">0x1B227263L</span><span class="token punctuation">,</span> <span class="token number">0x9B83C3FFL</span><span class="token punctuation">,</span> <span class="token number">0x1AC24696L</span><span class="token punctuation">,</span> <span class="token number">0xCDB30AEBL</span><span class="token punctuation">,</span>
     <span class="token number">0x532E3054L</span><span class="token punctuation">,</span> <span class="token number">0x8FD948E4L</span><span class="token punctuation">,</span> <span class="token number">0x6DBC3128L</span><span class="token punctuation">,</span> <span class="token number">0x58EBF2EFL</span><span class="token punctuation">,</span> <span class="token number">0x34C6FFEAL</span><span class="token punctuation">,</span>
     <span class="token number">0xFE28ED61L</span><span class="token punctuation">,</span> <span class="token number">0xEE7C3C73L</span><span class="token punctuation">,</span> <span class="token number">0x5D4A14D9L</span><span class="token punctuation">,</span> <span class="token number">0xE864B7E3L</span><span class="token punctuation">,</span> <span class="token number">0x42105D14L</span><span class="token punctuation">,</span>
     <span class="token number">0x203E13E0L</span><span class="token punctuation">,</span> <span class="token number">0x45EEE2B6L</span><span class="token punctuation">,</span> <span class="token number">0xA3AAABEAL</span><span class="token punctuation">,</span> <span class="token number">0xDB6C4F15L</span><span class="token punctuation">,</span> <span class="token number">0xFACB4FD0L</span><span class="token punctuation">,</span>
     <span class="token number">0xC742F442L</span><span class="token punctuation">,</span> <span class="token number">0xEF6ABBB5L</span><span class="token punctuation">,</span> <span class="token number">0x654F3B1DL</span><span class="token punctuation">,</span> <span class="token number">0x41CD2105L</span><span class="token punctuation">,</span> <span class="token number">0xD81E799EL</span><span class="token punctuation">,</span>
     <span class="token number">0x86854DC7L</span><span class="token punctuation">,</span> <span class="token number">0xE44B476AL</span><span class="token punctuation">,</span> <span class="token number">0x3D816250L</span><span class="token punctuation">,</span> <span class="token number">0xCF62A1F2L</span><span class="token punctuation">,</span> <span class="token number">0x5B8D2646L</span><span class="token punctuation">,</span>
     <span class="token number">0xFC8883A0L</span><span class="token punctuation">,</span> <span class="token number">0xC1C7B6A3L</span><span class="token punctuation">,</span> <span class="token number">0x7F1524C3L</span><span class="token punctuation">,</span> <span class="token number">0x69CB7492L</span><span class="token punctuation">,</span> <span class="token number">0x47848A0BL</span><span class="token punctuation">,</span>
     <span class="token number">0x5692B285L</span><span class="token punctuation">,</span> <span class="token number">0x095BBF00L</span><span class="token punctuation">,</span> <span class="token number">0xAD19489DL</span><span class="token punctuation">,</span> <span class="token number">0x1462B174L</span><span class="token punctuation">,</span> <span class="token number">0x23820E00L</span><span class="token punctuation">,</span>
     <span class="token number">0x58428D2AL</span><span class="token punctuation">,</span> <span class="token number">0x0C55F5EAL</span><span class="token punctuation">,</span> <span class="token number">0x1DADF43EL</span><span class="token punctuation">,</span> <span class="token number">0x233F7061L</span><span class="token punctuation">,</span> <span class="token number">0x3372F092L</span><span class="token punctuation">,</span>
     <span class="token number">0x8D937E41L</span><span class="token punctuation">,</span> <span class="token number">0xD65FECF1L</span><span class="token punctuation">,</span> <span class="token number">0x6C223BDBL</span><span class="token punctuation">,</span> <span class="token number">0x7CDE3759L</span><span class="token punctuation">,</span> <span class="token number">0xCBEE7460L</span><span class="token punctuation">,</span>
     <span class="token number">0x4085F2A7L</span><span class="token punctuation">,</span> <span class="token number">0xCE77326EL</span><span class="token punctuation">,</span> <span class="token number">0xA6078084L</span><span class="token punctuation">,</span> <span class="token number">0x19F8509EL</span><span class="token punctuation">,</span> <span class="token number">0xE8EFD855L</span><span class="token punctuation">,</span>
     <span class="token number">0x61D99735L</span><span class="token punctuation">,</span> <span class="token number">0xA969A7AAL</span><span class="token punctuation">,</span> <span class="token number">0xC50C06C2L</span><span class="token punctuation">,</span> <span class="token number">0x5A04ABFCL</span><span class="token punctuation">,</span> <span class="token number">0x800BCADCL</span><span class="token punctuation">,</span>
     <span class="token number">0x9E447A2EL</span><span class="token punctuation">,</span> <span class="token number">0xC3453484L</span><span class="token punctuation">,</span> <span class="token number">0xFDD56705L</span><span class="token punctuation">,</span> <span class="token number">0x0E1E9EC9L</span><span class="token punctuation">,</span> <span class="token number">0xDB73DBD3L</span><span class="token punctuation">,</span>
     <span class="token number">0x105588CDL</span><span class="token punctuation">,</span> <span class="token number">0x675FDA79L</span><span class="token punctuation">,</span> <span class="token number">0xE3674340L</span><span class="token punctuation">,</span> <span class="token number">0xC5C43465L</span><span class="token punctuation">,</span> <span class="token number">0x713E38D8L</span><span class="token punctuation">,</span>
     <span class="token number">0x3D28F89EL</span><span class="token punctuation">,</span> <span class="token number">0xF16DFF20L</span><span class="token punctuation">,</span> <span class="token number">0x153E21E7L</span><span class="token punctuation">,</span> <span class="token number">0x8FB03D4AL</span><span class="token punctuation">,</span> <span class="token number">0xE6E39F2BL</span><span class="token punctuation">,</span>
     <span class="token number">0xDB83ADF7L</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token number">0xE93D5A68L</span><span class="token punctuation">,</span> <span class="token number">0x948140F7L</span><span class="token punctuation">,</span> <span class="token number">0xF64C261CL</span><span class="token punctuation">,</span> <span class="token number">0x94692934L</span><span class="token punctuation">,</span> <span class="token number">0x411520F7L</span><span class="token punctuation">,</span>
     <span class="token number">0x7602D4F7L</span><span class="token punctuation">,</span> <span class="token number">0xBCF46B2EL</span><span class="token punctuation">,</span> <span class="token number">0xD4A20068L</span><span class="token punctuation">,</span> <span class="token number">0xD4082471L</span><span class="token punctuation">,</span> <span class="token number">0x3320F46AL</span><span class="token punctuation">,</span>
     <span class="token number">0x43B7D4B7L</span><span class="token punctuation">,</span> <span class="token number">0x500061AFL</span><span class="token punctuation">,</span> <span class="token number">0x1E39F62EL</span><span class="token punctuation">,</span> <span class="token number">0x97244546L</span><span class="token punctuation">,</span> <span class="token number">0x14214F74L</span><span class="token punctuation">,</span>
     <span class="token number">0xBF8B8840L</span><span class="token punctuation">,</span> <span class="token number">0x4D95FC1DL</span><span class="token punctuation">,</span> <span class="token number">0x96B591AFL</span><span class="token punctuation">,</span> <span class="token number">0x70F4DDD3L</span><span class="token punctuation">,</span> <span class="token number">0x66A02F45L</span><span class="token punctuation">,</span>
     <span class="token number">0xBFBC09ECL</span><span class="token punctuation">,</span> <span class="token number">0x03BD9785L</span><span class="token punctuation">,</span> <span class="token number">0x7FAC6DD0L</span><span class="token punctuation">,</span> <span class="token number">0x31CB8504L</span><span class="token punctuation">,</span> <span class="token number">0x96EB27B3L</span><span class="token punctuation">,</span>
     <span class="token number">0x55FD3941L</span><span class="token punctuation">,</span> <span class="token number">0xDA2547E6L</span><span class="token punctuation">,</span> <span class="token number">0xABCA0A9AL</span><span class="token punctuation">,</span> <span class="token number">0x28507825L</span><span class="token punctuation">,</span> <span class="token number">0x530429F4L</span><span class="token punctuation">,</span>
     <span class="token number">0x0A2C86DAL</span><span class="token punctuation">,</span> <span class="token number">0xE9B66DFBL</span><span class="token punctuation">,</span> <span class="token number">0x68DC1462L</span><span class="token punctuation">,</span> <span class="token number">0xD7486900L</span><span class="token punctuation">,</span> <span class="token number">0x680EC0A4L</span><span class="token punctuation">,</span>
     <span class="token number">0x27A18DEEL</span><span class="token punctuation">,</span> <span class="token number">0x4F3FFEA2L</span><span class="token punctuation">,</span> <span class="token number">0xE887AD8CL</span><span class="token punctuation">,</span> <span class="token number">0xB58CE006L</span><span class="token punctuation">,</span> <span class="token number">0x7AF4D6B6L</span><span class="token punctuation">,</span>
     <span class="token number">0xAACE1E7CL</span><span class="token punctuation">,</span> <span class="token number">0xD3375FECL</span><span class="token punctuation">,</span> <span class="token number">0xCE78A399L</span><span class="token punctuation">,</span> <span class="token number">0x406B2A42L</span><span class="token punctuation">,</span> <span class="token number">0x20FE9E35L</span><span class="token punctuation">,</span>
     <span class="token number">0xD9F385B9L</span><span class="token punctuation">,</span> <span class="token number">0xEE39D7ABL</span><span class="token punctuation">,</span> <span class="token number">0x3B124E8BL</span><span class="token punctuation">,</span> <span class="token number">0x1DC9FAF7L</span><span class="token punctuation">,</span> <span class="token number">0x4B6D1856L</span><span class="token punctuation">,</span>
     <span class="token number">0x26A36631L</span><span class="token punctuation">,</span> <span class="token number">0xEAE397B2L</span><span class="token punctuation">,</span> <span class="token number">0x3A6EFA74L</span><span class="token punctuation">,</span> <span class="token number">0xDD5B4332L</span><span class="token punctuation">,</span> <span class="token number">0x6841E7F7L</span><span class="token punctuation">,</span>
     <span class="token number">0xCA7820FBL</span><span class="token punctuation">,</span> <span class="token number">0xFB0AF54EL</span><span class="token punctuation">,</span> <span class="token number">0xD8FEB397L</span><span class="token punctuation">,</span> <span class="token number">0x454056ACL</span><span class="token punctuation">,</span> <span class="token number">0xBA489527L</span><span class="token punctuation">,</span>
     <span class="token number">0x55533A3AL</span><span class="token punctuation">,</span> <span class="token number">0x20838D87L</span><span class="token punctuation">,</span> <span class="token number">0xFE6BA9B7L</span><span class="token punctuation">,</span> <span class="token number">0xD096954BL</span><span class="token punctuation">,</span> <span class="token number">0x55A867BCL</span><span class="token punctuation">,</span>
     <span class="token number">0xA1159A58L</span><span class="token punctuation">,</span> <span class="token number">0xCCA92963L</span><span class="token punctuation">,</span> <span class="token number">0x99E1DB33L</span><span class="token punctuation">,</span> <span class="token number">0xA62A4A56L</span><span class="token punctuation">,</span> <span class="token number">0x3F3125F9L</span><span class="token punctuation">,</span>
     <span class="token number">0x5EF47E1CL</span><span class="token punctuation">,</span> <span class="token number">0x9029317CL</span><span class="token punctuation">,</span> <span class="token number">0xFDF8E802L</span><span class="token punctuation">,</span> <span class="token number">0x04272F70L</span><span class="token punctuation">,</span> <span class="token number">0x80BB155CL</span><span class="token punctuation">,</span>
     <span class="token number">0x05282CE3L</span><span class="token punctuation">,</span> <span class="token number">0x95C11548L</span><span class="token punctuation">,</span> <span class="token number">0xE4C66D22L</span><span class="token punctuation">,</span> <span class="token number">0x48C1133FL</span><span class="token punctuation">,</span> <span class="token number">0xC70F86DCL</span><span class="token punctuation">,</span>
     <span class="token number">0x07F9C9EEL</span><span class="token punctuation">,</span> <span class="token number">0x41041F0FL</span><span class="token punctuation">,</span> <span class="token number">0x404779A4L</span><span class="token punctuation">,</span> <span class="token number">0x5D886E17L</span><span class="token punctuation">,</span> <span class="token number">0x325F51EBL</span><span class="token punctuation">,</span>
     <span class="token number">0xD59BC0D1L</span><span class="token punctuation">,</span> <span class="token number">0xF2BCC18FL</span><span class="token punctuation">,</span> <span class="token number">0x41113564L</span><span class="token punctuation">,</span> <span class="token number">0x257B7834L</span><span class="token punctuation">,</span> <span class="token number">0x602A9C60L</span><span class="token punctuation">,</span>
     <span class="token number">0xDFF8E8A3L</span><span class="token punctuation">,</span> <span class="token number">0x1F636C1BL</span><span class="token punctuation">,</span> <span class="token number">0x0E12B4C2L</span><span class="token punctuation">,</span> <span class="token number">0x02E1329EL</span><span class="token punctuation">,</span> <span class="token number">0xAF664FD1L</span><span class="token punctuation">,</span>
     <span class="token number">0xCAD18115L</span><span class="token punctuation">,</span> <span class="token number">0x6B2395E0L</span><span class="token punctuation">,</span> <span class="token number">0x333E92E1L</span><span class="token punctuation">,</span> <span class="token number">0x3B240B62L</span><span class="token punctuation">,</span> <span class="token number">0xEEBEB922L</span><span class="token punctuation">,</span>
     <span class="token number">0x85B2A20EL</span><span class="token punctuation">,</span> <span class="token number">0xE6BA0D99L</span><span class="token punctuation">,</span> <span class="token number">0xDE720C8CL</span><span class="token punctuation">,</span> <span class="token number">0x2DA2F728L</span><span class="token punctuation">,</span> <span class="token number">0xD0127845L</span><span class="token punctuation">,</span>
     <span class="token number">0x95B794FDL</span><span class="token punctuation">,</span> <span class="token number">0x647D0862L</span><span class="token punctuation">,</span> <span class="token number">0xE7CCF5F0L</span><span class="token punctuation">,</span> <span class="token number">0x5449A36FL</span><span class="token punctuation">,</span> <span class="token number">0x877D48FAL</span><span class="token punctuation">,</span>
     <span class="token number">0xC39DFD27L</span><span class="token punctuation">,</span> <span class="token number">0xF33E8D1EL</span><span class="token punctuation">,</span> <span class="token number">0x0A476341L</span><span class="token punctuation">,</span> <span class="token number">0x992EFF74L</span><span class="token punctuation">,</span> <span class="token number">0x3A6F6EABL</span><span class="token punctuation">,</span>
     <span class="token number">0xF4F8FD37L</span><span class="token punctuation">,</span> <span class="token number">0xA812DC60L</span><span class="token punctuation">,</span> <span class="token number">0xA1EBDDF8L</span><span class="token punctuation">,</span> <span class="token number">0x991BE14CL</span><span class="token punctuation">,</span> <span class="token number">0xDB6E6B0DL</span><span class="token punctuation">,</span>
     <span class="token number">0xC67B5510L</span><span class="token punctuation">,</span> <span class="token number">0x6D672C37L</span><span class="token punctuation">,</span> <span class="token number">0x2765D43BL</span><span class="token punctuation">,</span> <span class="token number">0xDCD0E804L</span><span class="token punctuation">,</span> <span class="token number">0xF1290DC7L</span><span class="token punctuation">,</span>
     <span class="token number">0xCC00FFA3L</span><span class="token punctuation">,</span> <span class="token number">0xB5390F92L</span><span class="token punctuation">,</span> <span class="token number">0x690FED0BL</span><span class="token punctuation">,</span> <span class="token number">0x667B9FFBL</span><span class="token punctuation">,</span> <span class="token number">0xCEDB7D9CL</span><span class="token punctuation">,</span>
     <span class="token number">0xA091CF0BL</span><span class="token punctuation">,</span> <span class="token number">0xD9155EA3L</span><span class="token punctuation">,</span> <span class="token number">0xBB132F88L</span><span class="token punctuation">,</span> <span class="token number">0x515BAD24L</span><span class="token punctuation">,</span> <span class="token number">0x7B9479BFL</span><span class="token punctuation">,</span>
     <span class="token number">0x763BD6EBL</span><span class="token punctuation">,</span> <span class="token number">0x37392EB3L</span><span class="token punctuation">,</span> <span class="token number">0xCC115979L</span><span class="token punctuation">,</span> <span class="token number">0x8026E297L</span><span class="token punctuation">,</span> <span class="token number">0xF42E312DL</span><span class="token punctuation">,</span>
     <span class="token number">0x6842ADA7L</span><span class="token punctuation">,</span> <span class="token number">0xC66A2B3BL</span><span class="token punctuation">,</span> <span class="token number">0x12754CCCL</span><span class="token punctuation">,</span> <span class="token number">0x782EF11CL</span><span class="token punctuation">,</span> <span class="token number">0x6A124237L</span><span class="token punctuation">,</span>
     <span class="token number">0xB79251E7L</span><span class="token punctuation">,</span> <span class="token number">0x06A1BBE6L</span><span class="token punctuation">,</span> <span class="token number">0x4BFB6350L</span><span class="token punctuation">,</span> <span class="token number">0x1A6B1018L</span><span class="token punctuation">,</span> <span class="token number">0x11CAEDFAL</span><span class="token punctuation">,</span>
     <span class="token number">0x3D25BDD8L</span><span class="token punctuation">,</span> <span class="token number">0xE2E1C3C9L</span><span class="token punctuation">,</span> <span class="token number">0x44421659L</span><span class="token punctuation">,</span> <span class="token number">0x0A121386L</span><span class="token punctuation">,</span> <span class="token number">0xD90CEC6EL</span><span class="token punctuation">,</span>
     <span class="token number">0xD5ABEA2AL</span><span class="token punctuation">,</span> <span class="token number">0x64AF674EL</span><span class="token punctuation">,</span> <span class="token number">0xDA86A85FL</span><span class="token punctuation">,</span> <span class="token number">0xBEBFE988L</span><span class="token punctuation">,</span> <span class="token number">0x64E4C3FEL</span><span class="token punctuation">,</span>
     <span class="token number">0x9DBC8057L</span><span class="token punctuation">,</span> <span class="token number">0xF0F7C086L</span><span class="token punctuation">,</span> <span class="token number">0x60787BF8L</span><span class="token punctuation">,</span> <span class="token number">0x6003604DL</span><span class="token punctuation">,</span> <span class="token number">0xD1FD8346L</span><span class="token punctuation">,</span>
     <span class="token number">0xF6381FB0L</span><span class="token punctuation">,</span> <span class="token number">0x7745AE04L</span><span class="token punctuation">,</span> <span class="token number">0xD736FCCCL</span><span class="token punctuation">,</span> <span class="token number">0x83426B33L</span><span class="token punctuation">,</span> <span class="token number">0xF01EAB71L</span><span class="token punctuation">,</span>
     <span class="token number">0xB0804187L</span><span class="token punctuation">,</span> <span class="token number">0x3C005E5FL</span><span class="token punctuation">,</span> <span class="token number">0x77A057BEL</span><span class="token punctuation">,</span> <span class="token number">0xBDE8AE24L</span><span class="token punctuation">,</span> <span class="token number">0x55464299L</span><span class="token punctuation">,</span>
     <span class="token number">0xBF582E61L</span><span class="token punctuation">,</span> <span class="token number">0x4E58F48FL</span><span class="token punctuation">,</span> <span class="token number">0xF2DDFDA2L</span><span class="token punctuation">,</span> <span class="token number">0xF474EF38L</span><span class="token punctuation">,</span> <span class="token number">0x8789BDC2L</span><span class="token punctuation">,</span>
     <span class="token number">0x5366F9C3L</span><span class="token punctuation">,</span> <span class="token number">0xC8B38E74L</span><span class="token punctuation">,</span> <span class="token number">0xB475F255L</span><span class="token punctuation">,</span> <span class="token number">0x46FCD9B9L</span><span class="token punctuation">,</span> <span class="token number">0x7AEB2661L</span><span class="token punctuation">,</span>
     <span class="token number">0x8B1DDF84L</span><span class="token punctuation">,</span> <span class="token number">0x846A0E79L</span><span class="token punctuation">,</span> <span class="token number">0x915F95E2L</span><span class="token punctuation">,</span> <span class="token number">0x466E598EL</span><span class="token punctuation">,</span> <span class="token number">0x20B45770L</span><span class="token punctuation">,</span>
     <span class="token number">0x8CD55591L</span><span class="token punctuation">,</span> <span class="token number">0xC902DE4CL</span><span class="token punctuation">,</span> <span class="token number">0xB90BACE1L</span><span class="token punctuation">,</span> <span class="token number">0xBB8205D0L</span><span class="token punctuation">,</span> <span class="token number">0x11A86248L</span><span class="token punctuation">,</span>
     <span class="token number">0x7574A99EL</span><span class="token punctuation">,</span> <span class="token number">0xB77F19B6L</span><span class="token punctuation">,</span> <span class="token number">0xE0A9DC09L</span><span class="token punctuation">,</span> <span class="token number">0x662D09A1L</span><span class="token punctuation">,</span> <span class="token number">0xC4324633L</span><span class="token punctuation">,</span>
     <span class="token number">0xE85A1F02L</span><span class="token punctuation">,</span> <span class="token number">0x09F0BE8CL</span><span class="token punctuation">,</span> <span class="token number">0x4A99A025L</span><span class="token punctuation">,</span> <span class="token number">0x1D6EFE10L</span><span class="token punctuation">,</span> <span class="token number">0x1AB93D1DL</span><span class="token punctuation">,</span>
     <span class="token number">0x0BA5A4DFL</span><span class="token punctuation">,</span> <span class="token number">0xA186F20FL</span><span class="token punctuation">,</span> <span class="token number">0x2868F169L</span><span class="token punctuation">,</span> <span class="token number">0xDCB7DA83L</span><span class="token punctuation">,</span> <span class="token number">0x573906FEL</span><span class="token punctuation">,</span>
     <span class="token number">0xA1E2CE9BL</span><span class="token punctuation">,</span> <span class="token number">0x4FCD7F52L</span><span class="token punctuation">,</span> <span class="token number">0x50115E01L</span><span class="token punctuation">,</span> <span class="token number">0xA70683FAL</span><span class="token punctuation">,</span> <span class="token number">0xA002B5C4L</span><span class="token punctuation">,</span>
     <span class="token number">0x0DE6D027L</span><span class="token punctuation">,</span> <span class="token number">0x9AF88C27L</span><span class="token punctuation">,</span> <span class="token number">0x773F8641L</span><span class="token punctuation">,</span> <span class="token number">0xC3604C06L</span><span class="token punctuation">,</span> <span class="token number">0x61A806B5L</span><span class="token punctuation">,</span>
     <span class="token number">0xF0177A28L</span><span class="token punctuation">,</span> <span class="token number">0xC0F586E0L</span><span class="token punctuation">,</span> <span class="token number">0x006058AAL</span><span class="token punctuation">,</span> <span class="token number">0x30DC7D62L</span><span class="token punctuation">,</span> <span class="token number">0x11E69ED7L</span><span class="token punctuation">,</span>
     <span class="token number">0x2338EA63L</span><span class="token punctuation">,</span> <span class="token number">0x53C2DD94L</span><span class="token punctuation">,</span> <span class="token number">0xC2C21634L</span><span class="token punctuation">,</span> <span class="token number">0xBBCBEE56L</span><span class="token punctuation">,</span> <span class="token number">0x90BCB6DEL</span><span class="token punctuation">,</span>
     <span class="token number">0xEBFC7DA1L</span><span class="token punctuation">,</span> <span class="token number">0xCE591D76L</span><span class="token punctuation">,</span> <span class="token number">0x6F05E409L</span><span class="token punctuation">,</span> <span class="token number">0x4B7C0188L</span><span class="token punctuation">,</span> <span class="token number">0x39720A3DL</span><span class="token punctuation">,</span>
     <span class="token number">0x7C927C24L</span><span class="token punctuation">,</span> <span class="token number">0x86E3725FL</span><span class="token punctuation">,</span> <span class="token number">0x724D9DB9L</span><span class="token punctuation">,</span> <span class="token number">0x1AC15BB4L</span><span class="token punctuation">,</span> <span class="token number">0xD39EB8FCL</span><span class="token punctuation">,</span>
     <span class="token number">0xED545578L</span><span class="token punctuation">,</span> <span class="token number">0x08FCA5B5L</span><span class="token punctuation">,</span> <span class="token number">0xD83D7CD3L</span><span class="token punctuation">,</span> <span class="token number">0x4DAD0FC4L</span><span class="token punctuation">,</span> <span class="token number">0x1E50EF5EL</span><span class="token punctuation">,</span>
     <span class="token number">0xB161E6F8L</span><span class="token punctuation">,</span> <span class="token number">0xA28514D9L</span><span class="token punctuation">,</span> <span class="token number">0x6C51133CL</span><span class="token punctuation">,</span> <span class="token number">0x6FD5C7E7L</span><span class="token punctuation">,</span> <span class="token number">0x56E14EC4L</span><span class="token punctuation">,</span>
     <span class="token number">0x362ABFCEL</span><span class="token punctuation">,</span> <span class="token number">0xDDC6C837L</span><span class="token punctuation">,</span> <span class="token number">0xD79A3234L</span><span class="token punctuation">,</span> <span class="token number">0x92638212L</span><span class="token punctuation">,</span> <span class="token number">0x670EFA8EL</span><span class="token punctuation">,</span>
     <span class="token number">0x406000E0L</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token number">0x3A39CE37L</span><span class="token punctuation">,</span> <span class="token number">0xD3FAF5CFL</span><span class="token punctuation">,</span> <span class="token number">0xABC27737L</span><span class="token punctuation">,</span> <span class="token number">0x5AC52D1BL</span><span class="token punctuation">,</span> <span class="token number">0x5CB0679EL</span><span class="token punctuation">,</span>
     <span class="token number">0x4FA33742L</span><span class="token punctuation">,</span> <span class="token number">0xD3822740L</span><span class="token punctuation">,</span> <span class="token number">0x99BC9BBEL</span><span class="token punctuation">,</span> <span class="token number">0xD5118E9DL</span><span class="token punctuation">,</span> <span class="token number">0xBF0F7315L</span><span class="token punctuation">,</span>
     <span class="token number">0xD62D1C7EL</span><span class="token punctuation">,</span> <span class="token number">0xC700C47BL</span><span class="token punctuation">,</span> <span class="token number">0xB78C1B6BL</span><span class="token punctuation">,</span> <span class="token number">0x21A19045L</span><span class="token punctuation">,</span> <span class="token number">0xB26EB1BEL</span><span class="token punctuation">,</span>
     <span class="token number">0x6A366EB4L</span><span class="token punctuation">,</span> <span class="token number">0x5748AB2FL</span><span class="token punctuation">,</span> <span class="token number">0xBC946E79L</span><span class="token punctuation">,</span> <span class="token number">0xC6A376D2L</span><span class="token punctuation">,</span> <span class="token number">0x6549C2C8L</span><span class="token punctuation">,</span>
     <span class="token number">0x530FF8EEL</span><span class="token punctuation">,</span> <span class="token number">0x468DDE7DL</span><span class="token punctuation">,</span> <span class="token number">0xD5730A1DL</span><span class="token punctuation">,</span> <span class="token number">0x4CD04DC6L</span><span class="token punctuation">,</span> <span class="token number">0x2939BBDBL</span><span class="token punctuation">,</span>
     <span class="token number">0xA9BA4650L</span><span class="token punctuation">,</span> <span class="token number">0xAC9526E8L</span><span class="token punctuation">,</span> <span class="token number">0xBE5EE304L</span><span class="token punctuation">,</span> <span class="token number">0xA1FAD5F0L</span><span class="token punctuation">,</span> <span class="token number">0x6A2D519AL</span><span class="token punctuation">,</span>
     <span class="token number">0x63EF8CE2L</span><span class="token punctuation">,</span> <span class="token number">0x9A86EE22L</span><span class="token punctuation">,</span> <span class="token number">0xC089C2B8L</span><span class="token punctuation">,</span> <span class="token number">0x43242EF6L</span><span class="token punctuation">,</span> <span class="token number">0xA51E03AAL</span><span class="token punctuation">,</span>
     <span class="token number">0x9CF2D0A4L</span><span class="token punctuation">,</span> <span class="token number">0x83C061BAL</span><span class="token punctuation">,</span> <span class="token number">0x9BE96A4DL</span><span class="token punctuation">,</span> <span class="token number">0x8FE51550L</span><span class="token punctuation">,</span> <span class="token number">0xBA645BD6L</span><span class="token punctuation">,</span>
     <span class="token number">0x2826A2F9L</span><span class="token punctuation">,</span> <span class="token number">0xA73A3AE1L</span><span class="token punctuation">,</span> <span class="token number">0x4BA99586L</span><span class="token punctuation">,</span> <span class="token number">0xEF5562E9L</span><span class="token punctuation">,</span> <span class="token number">0xC72FEFD3L</span><span class="token punctuation">,</span>
     <span class="token number">0xF752F7DAL</span><span class="token punctuation">,</span> <span class="token number">0x3F046F69L</span><span class="token punctuation">,</span> <span class="token number">0x77FA0A59L</span><span class="token punctuation">,</span> <span class="token number">0x80E4A915L</span><span class="token punctuation">,</span> <span class="token number">0x87B08601L</span><span class="token punctuation">,</span>
     <span class="token number">0x9B09E6ADL</span><span class="token punctuation">,</span> <span class="token number">0x3B3EE593L</span><span class="token punctuation">,</span> <span class="token number">0xE990FD5AL</span><span class="token punctuation">,</span> <span class="token number">0x9E34D797L</span><span class="token punctuation">,</span> <span class="token number">0x2CF0B7D9L</span><span class="token punctuation">,</span>
     <span class="token number">0x022B8B51L</span><span class="token punctuation">,</span> <span class="token number">0x96D5AC3AL</span><span class="token punctuation">,</span> <span class="token number">0x017DA67DL</span><span class="token punctuation">,</span> <span class="token number">0xD1CF3ED6L</span><span class="token punctuation">,</span> <span class="token number">0x7C7D2D28L</span><span class="token punctuation">,</span>
     <span class="token number">0x1F9F25CFL</span><span class="token punctuation">,</span> <span class="token number">0xADF2B89BL</span><span class="token punctuation">,</span> <span class="token number">0x5AD6B472L</span><span class="token punctuation">,</span> <span class="token number">0x5A88F54CL</span><span class="token punctuation">,</span> <span class="token number">0xE029AC71L</span><span class="token punctuation">,</span>
     <span class="token number">0xE019A5E6L</span><span class="token punctuation">,</span> <span class="token number">0x47B0ACFDL</span><span class="token punctuation">,</span> <span class="token number">0xED93FA9BL</span><span class="token punctuation">,</span> <span class="token number">0xE8D3C48DL</span><span class="token punctuation">,</span> <span class="token number">0x283B57CCL</span><span class="token punctuation">,</span>
     <span class="token number">0xF8D56629L</span><span class="token punctuation">,</span> <span class="token number">0x79132E28L</span><span class="token punctuation">,</span> <span class="token number">0x785F0191L</span><span class="token punctuation">,</span> <span class="token number">0xED756055L</span><span class="token punctuation">,</span> <span class="token number">0xF7960E44L</span><span class="token punctuation">,</span>
     <span class="token number">0xE3D35E8CL</span><span class="token punctuation">,</span> <span class="token number">0x15056DD4L</span><span class="token punctuation">,</span> <span class="token number">0x88F46DBAL</span><span class="token punctuation">,</span> <span class="token number">0x03A16125L</span><span class="token punctuation">,</span> <span class="token number">0x0564F0BDL</span><span class="token punctuation">,</span>
     <span class="token number">0xC3EB9E15L</span><span class="token punctuation">,</span> <span class="token number">0x3C9057A2L</span><span class="token punctuation">,</span> <span class="token number">0x97271AECL</span><span class="token punctuation">,</span> <span class="token number">0xA93A072AL</span><span class="token punctuation">,</span> <span class="token number">0x1B3F6D9BL</span><span class="token punctuation">,</span>
     <span class="token number">0x1E6321F5L</span><span class="token punctuation">,</span> <span class="token number">0xF59C66FBL</span><span class="token punctuation">,</span> <span class="token number">0x26DCF319L</span><span class="token punctuation">,</span> <span class="token number">0x7533D928L</span><span class="token punctuation">,</span> <span class="token number">0xB155FDF5L</span><span class="token punctuation">,</span>
     <span class="token number">0x03563482L</span><span class="token punctuation">,</span> <span class="token number">0x8ABA3CBBL</span><span class="token punctuation">,</span> <span class="token number">0x28517711L</span><span class="token punctuation">,</span> <span class="token number">0xC20AD9F8L</span><span class="token punctuation">,</span> <span class="token number">0xABCC5167L</span><span class="token punctuation">,</span>
     <span class="token number">0xCCAD925FL</span><span class="token punctuation">,</span> <span class="token number">0x4DE81751L</span><span class="token punctuation">,</span> <span class="token number">0x3830DC8EL</span><span class="token punctuation">,</span> <span class="token number">0x379D5862L</span><span class="token punctuation">,</span> <span class="token number">0x9320F991L</span><span class="token punctuation">,</span>
     <span class="token number">0xEA7A90C2L</span><span class="token punctuation">,</span> <span class="token number">0xFB3E7BCEL</span><span class="token punctuation">,</span> <span class="token number">0x5121CE64L</span><span class="token punctuation">,</span> <span class="token number">0x774FBE32L</span><span class="token punctuation">,</span> <span class="token number">0xA8B6E37EL</span><span class="token punctuation">,</span>
     <span class="token number">0xC3293D46L</span><span class="token punctuation">,</span> <span class="token number">0x48DE5369L</span><span class="token punctuation">,</span> <span class="token number">0x6413E680L</span><span class="token punctuation">,</span> <span class="token number">0xA2AE0810L</span><span class="token punctuation">,</span> <span class="token number">0xDD6DB224L</span><span class="token punctuation">,</span>
     <span class="token number">0x69852DFDL</span><span class="token punctuation">,</span> <span class="token number">0x09072166L</span><span class="token punctuation">,</span> <span class="token number">0xB39A460AL</span><span class="token punctuation">,</span> <span class="token number">0x6445C0DDL</span><span class="token punctuation">,</span> <span class="token number">0x586CDECFL</span><span class="token punctuation">,</span>
     <span class="token number">0x1C20C8AEL</span><span class="token punctuation">,</span> <span class="token number">0x5BBEF7DDL</span><span class="token punctuation">,</span> <span class="token number">0x1B588D40L</span><span class="token punctuation">,</span> <span class="token number">0xCCD2017FL</span><span class="token punctuation">,</span> <span class="token number">0x6BB4E3BBL</span><span class="token punctuation">,</span>
     <span class="token number">0xDDA26A7EL</span><span class="token punctuation">,</span> <span class="token number">0x3A59FF45L</span><span class="token punctuation">,</span> <span class="token number">0x3E350A44L</span><span class="token punctuation">,</span> <span class="token number">0xBCB4CDD5L</span><span class="token punctuation">,</span> <span class="token number">0x72EACEA8L</span><span class="token punctuation">,</span>
     <span class="token number">0xFA6484BBL</span><span class="token punctuation">,</span> <span class="token number">0x8D6612AEL</span><span class="token punctuation">,</span> <span class="token number">0xBF3C6F47L</span><span class="token punctuation">,</span> <span class="token number">0xD29BE463L</span><span class="token punctuation">,</span> <span class="token number">0x542F5D9EL</span><span class="token punctuation">,</span>
     <span class="token number">0xAEC2771BL</span><span class="token punctuation">,</span> <span class="token number">0xF64E6370L</span><span class="token punctuation">,</span> <span class="token number">0x740E0D8DL</span><span class="token punctuation">,</span> <span class="token number">0xE75B1357L</span><span class="token punctuation">,</span> <span class="token number">0xF8721671L</span><span class="token punctuation">,</span>
     <span class="token number">0xAF537D5DL</span><span class="token punctuation">,</span> <span class="token number">0x4040CB08L</span><span class="token punctuation">,</span> <span class="token number">0x4EB4E2CCL</span><span class="token punctuation">,</span> <span class="token number">0x34D2466AL</span><span class="token punctuation">,</span> <span class="token number">0x0115AF84L</span><span class="token punctuation">,</span>
     <span class="token number">0xE1B00428L</span><span class="token punctuation">,</span> <span class="token number">0x95983A1DL</span><span class="token punctuation">,</span> <span class="token number">0x06B89FB4L</span><span class="token punctuation">,</span> <span class="token number">0xCE6EA048L</span><span class="token punctuation">,</span> <span class="token number">0x6F3F3B82L</span><span class="token punctuation">,</span>
     <span class="token number">0x3520AB82L</span><span class="token punctuation">,</span> <span class="token number">0x011A1D4BL</span><span class="token punctuation">,</span> <span class="token number">0x277227F8L</span><span class="token punctuation">,</span> <span class="token number">0x611560B1L</span><span class="token punctuation">,</span> <span class="token number">0xE7933FDCL</span><span class="token punctuation">,</span>
     <span class="token number">0xBB3A792BL</span><span class="token punctuation">,</span> <span class="token number">0x344525BDL</span><span class="token punctuation">,</span> <span class="token number">0xA08839E1L</span><span class="token punctuation">,</span> <span class="token number">0x51CE794BL</span><span class="token punctuation">,</span> <span class="token number">0x2F32C9B7L</span><span class="token punctuation">,</span>
     <span class="token number">0xA01FBAC9L</span><span class="token punctuation">,</span> <span class="token number">0xE01CC87EL</span><span class="token punctuation">,</span> <span class="token number">0xBCC7D1F6L</span><span class="token punctuation">,</span> <span class="token number">0xCF0111C3L</span><span class="token punctuation">,</span> <span class="token number">0xA1E8AAC7L</span><span class="token punctuation">,</span>
     <span class="token number">0x1A908749L</span><span class="token punctuation">,</span> <span class="token number">0xD44FBD9AL</span><span class="token punctuation">,</span> <span class="token number">0xD0DADECBL</span><span class="token punctuation">,</span> <span class="token number">0xD50ADA38L</span><span class="token punctuation">,</span> <span class="token number">0x0339C32AL</span><span class="token punctuation">,</span>
     <span class="token number">0xC6913667L</span><span class="token punctuation">,</span> <span class="token number">0x8DF9317CL</span><span class="token punctuation">,</span> <span class="token number">0xE0B12B4FL</span><span class="token punctuation">,</span> <span class="token number">0xF79E59B7L</span><span class="token punctuation">,</span> <span class="token number">0x43F5BB3AL</span><span class="token punctuation">,</span>
     <span class="token number">0xF2D519FFL</span><span class="token punctuation">,</span> <span class="token number">0x27D9459CL</span><span class="token punctuation">,</span> <span class="token number">0xBF97222CL</span><span class="token punctuation">,</span> <span class="token number">0x15E6FC2AL</span><span class="token punctuation">,</span> <span class="token number">0x0F91FC71L</span><span class="token punctuation">,</span>
     <span class="token number">0x9B941525L</span><span class="token punctuation">,</span> <span class="token number">0xFAE59361L</span><span class="token punctuation">,</span> <span class="token number">0xCEB69CEBL</span><span class="token punctuation">,</span> <span class="token number">0xC2A86459L</span><span class="token punctuation">,</span> <span class="token number">0x12BAA8D1L</span><span class="token punctuation">,</span>
     <span class="token number">0xB6C1075EL</span><span class="token punctuation">,</span> <span class="token number">0xE3056A0CL</span><span class="token punctuation">,</span> <span class="token number">0x10D25065L</span><span class="token punctuation">,</span> <span class="token number">0xCB03A442L</span><span class="token punctuation">,</span> <span class="token number">0xE0EC6E0EL</span><span class="token punctuation">,</span>
     <span class="token number">0x1698DB3BL</span><span class="token punctuation">,</span> <span class="token number">0x4C98A0BEL</span><span class="token punctuation">,</span> <span class="token number">0x3278E964L</span><span class="token punctuation">,</span> <span class="token number">0x9F1F9532L</span><span class="token punctuation">,</span> <span class="token number">0xE0D392DFL</span><span class="token punctuation">,</span>
     <span class="token number">0xD3A0342BL</span><span class="token punctuation">,</span> <span class="token number">0x8971F21EL</span><span class="token punctuation">,</span> <span class="token number">0x1B0A7441L</span><span class="token punctuation">,</span> <span class="token number">0x4BA3348CL</span><span class="token punctuation">,</span> <span class="token number">0xC5BE7120L</span><span class="token punctuation">,</span>
     <span class="token number">0xC37632D8L</span><span class="token punctuation">,</span> <span class="token number">0xDF359F8DL</span><span class="token punctuation">,</span> <span class="token number">0x9B992F2EL</span><span class="token punctuation">,</span> <span class="token number">0xE60B6F47L</span><span class="token punctuation">,</span> <span class="token number">0x0FE3F11DL</span><span class="token punctuation">,</span>
     <span class="token number">0xE54CDA54L</span><span class="token punctuation">,</span> <span class="token number">0x1EDAD891L</span><span class="token punctuation">,</span> <span class="token number">0xCE6279CFL</span><span class="token punctuation">,</span> <span class="token number">0xCD3E7E6FL</span><span class="token punctuation">,</span> <span class="token number">0x1618B166L</span><span class="token punctuation">,</span>
     <span class="token number">0xFD2C1D05L</span><span class="token punctuation">,</span> <span class="token number">0x848FD2C5L</span><span class="token punctuation">,</span> <span class="token number">0xF6FB2299L</span><span class="token punctuation">,</span> <span class="token number">0xF523F357L</span><span class="token punctuation">,</span> <span class="token number">0xA6327623L</span><span class="token punctuation">,</span>
     <span class="token number">0x93A83531L</span><span class="token punctuation">,</span> <span class="token number">0x56CCCD02L</span><span class="token punctuation">,</span> <span class="token number">0xACF08162L</span><span class="token punctuation">,</span> <span class="token number">0x5A75EBB5L</span><span class="token punctuation">,</span> <span class="token number">0x6E163697L</span><span class="token punctuation">,</span>
     <span class="token number">0x88D273CCL</span><span class="token punctuation">,</span> <span class="token number">0xDE966292L</span><span class="token punctuation">,</span> <span class="token number">0x81B949D0L</span><span class="token punctuation">,</span> <span class="token number">0x4C50901BL</span><span class="token punctuation">,</span> <span class="token number">0x71C65614L</span><span class="token punctuation">,</span>
     <span class="token number">0xE6C6C7BDL</span><span class="token punctuation">,</span> <span class="token number">0x327A140AL</span><span class="token punctuation">,</span> <span class="token number">0x45E1D006L</span><span class="token punctuation">,</span> <span class="token number">0xC3F27B9AL</span><span class="token punctuation">,</span> <span class="token number">0xC9AA53FDL</span><span class="token punctuation">,</span>
     <span class="token number">0x62A80F00L</span><span class="token punctuation">,</span> <span class="token number">0xBB25BFE2L</span><span class="token punctuation">,</span> <span class="token number">0x35BDD2F6L</span><span class="token punctuation">,</span> <span class="token number">0x71126905L</span><span class="token punctuation">,</span> <span class="token number">0xB2040222L</span><span class="token punctuation">,</span>
     <span class="token number">0xB6CBCF7CL</span><span class="token punctuation">,</span> <span class="token number">0xCD769C2BL</span><span class="token punctuation">,</span> <span class="token number">0x53113EC0L</span><span class="token punctuation">,</span> <span class="token number">0x1640E3D3L</span><span class="token punctuation">,</span> <span class="token number">0x38ABBD60L</span><span class="token punctuation">,</span>
     <span class="token number">0x2547ADF0L</span><span class="token punctuation">,</span> <span class="token number">0xBA38209CL</span><span class="token punctuation">,</span> <span class="token number">0xF746CE76L</span><span class="token punctuation">,</span> <span class="token number">0x77AFA1C5L</span><span class="token punctuation">,</span> <span class="token number">0x20756060L</span><span class="token punctuation">,</span>
     <span class="token number">0x85CBFE4EL</span><span class="token punctuation">,</span> <span class="token number">0x8AE88DD8L</span><span class="token punctuation">,</span> <span class="token number">0x7AAAF9B0L</span><span class="token punctuation">,</span> <span class="token number">0x4CF9AA7EL</span><span class="token punctuation">,</span> <span class="token number">0x1948C25CL</span><span class="token punctuation">,</span>
     <span class="token number">0x02FB8A8CL</span><span class="token punctuation">,</span> <span class="token number">0x01C36AE4L</span><span class="token punctuation">,</span> <span class="token number">0xD6EBE1F9L</span><span class="token punctuation">,</span> <span class="token number">0x90D4F869L</span><span class="token punctuation">,</span> <span class="token number">0xA65CDEA0L</span><span class="token punctuation">,</span>
     <span class="token number">0x3F09252DL</span><span class="token punctuation">,</span> <span class="token number">0xC208E69FL</span><span class="token punctuation">,</span> <span class="token number">0xB74E6132L</span><span class="token punctuation">,</span> <span class="token number">0xCE77E25BL</span><span class="token punctuation">,</span> <span class="token number">0x578FDFE3L</span><span class="token punctuation">,</span>
     <span class="token number">0x3AC372E6L</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// f函数</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> res<span class="token punctuation">;</span>
  res <span class="token operator">=</span> S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  res <span class="token operator">+=</span> S<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  res <span class="token operator">^=</span> S<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  res <span class="token operator">+=</span> S<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>x <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> L<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> R<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">*</span>L <span class="token operator">^=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>R <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>R <span class="token operator">^=</span> P<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>L <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token operator">*</span>L <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token operator">*</span>R <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">*</span>L<span class="token punctuation">;</span>
  <span class="token operator">*</span>L <span class="token operator">=</span> <span class="token operator">*</span>R<span class="token punctuation">;</span>
  <span class="token operator">*</span>R <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> L<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span> R<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">*</span>L <span class="token operator">^=</span> P<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>R <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>R <span class="token operator">^=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>L <span class="token operator">^=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token operator">*</span>L <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token operator">*</span>R <span class="token operator">^=</span> P<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">*</span>L<span class="token punctuation">;</span>
  <span class="token operator">*</span>L <span class="token operator">=</span> <span class="token operator">*</span>R<span class="token punctuation">;</span>
  <span class="token operator">*</span>R <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> keylen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">//对P数组和密钥进行逐位异或，必要时重用密钥</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">18</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    data <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      data <span class="token operator">&lt;&lt;=</span> <span class="token number">8</span><span class="token punctuation">;</span>
      data <span class="token operator">|=</span> key<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
      index<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> keylen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// 使用当前的P数组和S-box对全0的64位分组使用BlowFish算法进行加密，用输出代替P[1]、P[2]</span>
  <span class="token comment">// 重复以上步骤使用当前的P数组和S-box对上一步输出进行加密，并用输出代替P[3]、P[4]，</span>
  <span class="token comment">//   直到按顺序替代所有的P数组和S-box中的元素为止</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">18</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
    P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>
    P<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> j <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>
      S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token string">"ASimpleKey"</span><span class="token punctuation">;</span>
  <span class="token function">init</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//init subkey</span>
  <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//encrypt</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%x,%x\n"</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="非对称密码"><a href="#非对称密码" class="headerlink" title="非对称密码"></a>非对称密码</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/RC4">RC4_百度百科</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/reverse/identify-encode-encryption/introduction/">常见加密算法和编码识别 - CTF Wiki </a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1016180">DES算法-C&#x2F;C++实现</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1KQ4y127AT/?share_source=copy_web&vd_source=e96311532f2f7af12b275834dfed9adb">DES加密算法｜密码学｜信息安全</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xzj8023tp/p/12970790.html">AES加解密-CBC ECB - 独孤剑—宇枫 - 博客园 </a></p>
<p><a target="_blank" rel="noopener" href="https://yfli.top/2020/02/18/encrypt_document/">对称加密算法&amp;&amp;Hash算法 文档 | feng’s blog (yfli.top)</a></p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/SM4.0/3901780">SM4.0 百度百科</a></p>
<p><a target="_blank" rel="noopener" href="https://n0va-scy.github.io/2022/02/14/sm4%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">国密加密算法sm4 </a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://liquor-vague.github.io">Bag</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://liquor-vague.github.io/2024/03/03/encrypt-reverse/">http://liquor-vague.github.io/2024/03/03/encrypt-reverse/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://liquor-vague.github.io" target="_blank">BAG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="/img/jill.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/19/2024-algorithm-learning/" title="2024算法复健"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">2024算法复健</div></div></a></div><div class="next-post pull-right"><a href="/2024/02/28/2024-learning-records/" title="2024的学习记录"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2024的学习记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/28/2024-ctf-training/" title="2024_ctf_training"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-28</div><div class="title">2024_ctf_training</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/jill.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Bag</div><div class="author-info__description">A rolling stone gathers no moss.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://liquor-vague.github/"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Here is Bag</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">对称加密算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RC4"><span class="toc-number">1.1.</span> <span class="toc-text">RC4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC"><span class="toc-number">1.1.1.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TEA%E7%B3%BB%E5%88%97%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">TEA系列算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TEA"><span class="toc-number">1.2.1.</span> <span class="toc-text">TEA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-1"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XTEA"><span class="toc-number">1.2.2.</span> <span class="toc-text">XTEA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-2"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XXTEA"><span class="toc-number">1.2.3.</span> <span class="toc-text">XXTEA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-3"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDEA"><span class="toc-number">1.3.</span> <span class="toc-text">IDEA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%90%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">子密钥生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#IDEA%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">IDEA加密</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#IDEA%E8%A7%A3%E5%AF%86"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">IDEA解密</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DES"><span class="toc-number">1.4.</span> <span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-4"><span class="toc-number">1.4.1.</span> <span class="toc-text">脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%93%E5%B1%95%EF%BC%9A3DES"><span class="toc-number">1.4.2.</span> <span class="toc-text">拓展：3DES</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES"><span class="toc-number">1.5.</span> <span class="toc-text">AES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AES%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.1.</span> <span class="toc-text">AES的分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SM4"><span class="toc-number">1.6.</span> <span class="toc-text">SM4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.6.1.</span> <span class="toc-text">前置知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.2.</span> <span class="toc-text">密钥扩展算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.3.</span> <span class="toc-text">加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.4.</span> <span class="toc-text">解密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81"><span class="toc-number">1.6.5.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-5"><span class="toc-number">1.6.6.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BlowFish"><span class="toc-number">1.7.</span> <span class="toc-text">BlowFish</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86-1"><span class="toc-number">1.7.1.</span> <span class="toc-text">算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%90%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90-1"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">子密钥生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">加密</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">解密</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-6"><span class="toc-number">1.7.2.</span> <span class="toc-text">脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">非对称密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">3.</span> <span class="toc-text">参考资料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/03/Assembly-Language-Experiment-5/" title="汇编语言实验五">汇编语言实验五</a><time datetime="2024-04-03T08:52:36.000Z" title="发表于 2024-04-03 16:52:36">2024-04-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/01/Assembly-Language-Experiment-4/" title="汇编语言实验四">汇编语言实验四</a><time datetime="2024-04-01T13:36:28.000Z" title="发表于 2024-04-01 21:36:28">2024-04-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/28/2024-ctf-training/" title="2024_ctf_training">2024_ctf_training</a><time datetime="2024-03-28T03:27:48.000Z" title="发表于 2024-03-28 11:27:48">2024-03-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/19/2024-algorithm-learning/" title="2024算法复健">2024算法复健</a><time datetime="2024-03-19T02:22:30.000Z" title="发表于 2024-03-19 10:22:30">2024-03-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/03/encrypt-reverse/" title="逆向中常见加解密算法总结（待更新）">逆向中常见加解密算法总结（待更新）</a><time datetime="2024-03-03T13:20:26.000Z" title="发表于 2024-03-03 21:20:26">2024-03-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Bag</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>