<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>逆向中常见加解密算法总结（待更新） | BAG</title><meta name="author" content="Bag"><meta name="copyright" content="Bag"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="逆向过程中遇到的对称和非对称加密算法。">
<meta property="og:type" content="article">
<meta property="og:title" content="逆向中常见加解密算法总结（待更新）">
<meta property="og:url" content="http://liquor-vague.github.io/2024/03/03/encrypt-reverse/index.html">
<meta property="og:site_name" content="BAG">
<meta property="og:description" content="逆向过程中遇到的对称和非对称加密算法。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://liquor-vague.github.io/img/jill.jpg">
<meta property="article:published_time" content="2024-03-03T13:20:26.000Z">
<meta property="article:modified_time" content="2024-04-07T09:27:38.546Z">
<meta property="article:author" content="Bag">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://liquor-vague.github.io/img/jill.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://liquor-vague.github.io/2024/03/03/encrypt-reverse/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '逆向中常见加解密算法总结（待更新）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-07 17:27:38'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/jill.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Posts</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/links"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="BAG"><span class="site-name">BAG</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Posts</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/links"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">逆向中常见加解密算法总结（待更新）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-03T13:20:26.000Z" title="发表于 2024-03-03 21:20:26">2024-03-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-07T09:27:38.546Z" title="更新于 2024-04-07 17:27:38">2024-04-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="逆向中常见加解密算法总结（待更新）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>逆向过程中遇到的对称和非对称加密算法。</p>
<span id="more"></span>



<h2 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h2><p>​		对称加密算法是指<strong>加密和解密使用同一把密钥的加密算法</strong>，它的基本实现原理是通过密钥将明文转化为密文，在传输过程中保证密文的安全性，接收方通过相同的密钥将密文还原为明文。 对称加密算法的加密脚本和解密脚本通常是相同的。</p>
<p>​		块密码(也称为 <strong>分组密码</strong> )和流密码属于对称密钥密码。块密码和流密码之间的主要区别在于，<strong>块密码</strong>通过一次获取<strong>纯文本的块</strong>将纯文本转换为密文。当<strong>流密码</strong>通过一次取 <strong>1 个字节</strong>的纯文本将纯文本转换为密文。</p>
<h3 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h3><p>​		RC4（Rivest Cipher 4）是一种<strong>流加密</strong>算法，密钥长度可变。通过生成<strong>伪随机流</strong>（S盒）（通常为256字节），与密文进行异或加密。</p>
<p>RC4的加密原理如下：</p>
<ol>
<li><p>初始化S盒，采用初始化算法KSA（Key Scheduling Algorithm）。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//初始化函数ksa</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>*s,<span class="type">unsigned</span> <span class="type">char</span>*key, <span class="type">unsigned</span> <span class="type">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> k[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) &#123;</span><br><span class="line">        s[i]=i;</span><br><span class="line">        k[i]=key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) &#123;</span><br><span class="line">        j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">        <span class="built_in">swap</span>(s[i],s[j]);<span class="comment">//交换s[i]和s[j]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>伪随机密钥序列生成算法PRGA（Pseudo-Randomoeneration-Algorithm），对S盒进行加密。主要功能是将S-box搅乱，i确保S-box的每个元素都得到处理，j保证S-box的搅乱是随机的。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加解密PRGA</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>*s,<span class="type">unsigned</span> <span class="type">char</span>*Data,<span class="type">unsigned</span> <span class="type">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;Len;k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">        j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">        <span class="built_in">swap</span>(s[i],s[j]);<span class="comment">//交换s[x]和s[y]</span></span><br><span class="line">        t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">        Data[k]^=s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span>  </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化函数ksa</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>*s,<span class="type">char</span>*key, <span class="type">unsigned</span> <span class="type">long</span> Len)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> k[<span class="number">256</span>]= &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">256</span>; i++) &#123;</span><br><span class="line">		s[i]=i;</span><br><span class="line">		k[i]=key[i%Len];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">256</span>; i++) &#123;</span><br><span class="line">		j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">		<span class="built_in">swap</span>(s[i],s[j]);							<span class="comment">//交换s[i]和s[j]</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加解密PRGA</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>*s,<span class="type">char</span>*Data,<span class="type">unsigned</span> <span class="type">long</span> Len)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> k=<span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">	<span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;Len; k++) &#123;</span><br><span class="line">		i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">		j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">		<span class="built_in">swap</span>(s[i],s[j]);							<span class="comment">//交换s[x]和s[y]</span></span><br><span class="line">		t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">		Data[k]^=s[t];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> s[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;, s_copy[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;		<span class="comment">//S-box和其备份</span></span><br><span class="line">	<span class="type">char</span> key[<span class="number">256</span>] = &#123; <span class="string">&quot;justfortest&quot;</span> &#125;;</span><br><span class="line">	<span class="type">char</span> pData[<span class="number">512</span>] = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> len = <span class="built_in">strlen</span>(pData);</span><br><span class="line">	<span class="comment">//初始化s盒</span></span><br><span class="line">	<span class="built_in">rc4_init</span>(s,key,len);</span><br><span class="line">	<span class="comment">//保存s盒</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i&lt;<span class="number">256</span>; i++)s_copy[i] = s[i];</span><br><span class="line">	<span class="comment">//加密</span></span><br><span class="line">	<span class="built_in">rc4_crypt</span>(s,pData,len);</span><br><span class="line">    cout&lt;&lt;pData&lt;&lt;endl;</span><br><span class="line">    <span class="comment">//解密</span></span><br><span class="line">    <span class="built_in">rc4_crypt</span>(s_copy,pData,len);</span><br><span class="line">    cout&lt;&lt;pData&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="TEA系列算法"><a href="#TEA系列算法" class="headerlink" title="TEA系列算法"></a>TEA系列算法</h3><p>​		<strong>微型加密算法</strong>（Tiny Encryption Algorithm，TEA）是一种易于描述和执行的<strong>块密码</strong>。</p>
<p>​		TEA系列最显著的特征是特征值<strong>delta &#x3D; 0x9e3779b9</strong></p>
<p>​		<strong>这里给出的脚本只对数组前两位的数据进行了处理，根据需求自行调整</strong>。</p>
<h4 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h4><p>TEA的分组长度为64位，密钥长度为128位，采用Feistel网络，建议32次循环加密即64轮。</p>
<p>由于加密时数相加，解密只需要将数相减即可。</p>
<p><strong>注意</strong>：tea在加密过程中会出现数溢出的情况，使用C&#x2F;C++编写脚本时，程序会自动对溢出的数进行求模处理；使用Python编写脚本时，由于Python支持大数运算，需要用<strong>ctypes</strong>库进行处理。</p>
<h5 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">unsigned</span> <span class="type">int</span>* key)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> l = v[<span class="number">0</span>], r = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">    sum += delta;</span><br><span class="line">    l += ((r &lt;&lt; <span class="number">4</span>) + key[<span class="number">0</span>]) ^ (r + sum) ^ ((r &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]);</span><br><span class="line">    r += ((l &lt;&lt; <span class="number">4</span>) + key[<span class="number">2</span>]) ^ (l + sum) ^ ((l &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = l;</span><br><span class="line">  v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">unsigned</span> <span class="type">int</span>* key)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> l = v[<span class="number">0</span>], r = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  sum = delta *<span class="number">32</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">    r -= ((l &lt;&lt; <span class="number">4</span>) + key[<span class="number">2</span>]) ^ (l + sum) ^ ((l &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]);</span><br><span class="line">    l -= ((r &lt;&lt; <span class="number">4</span>) + key[<span class="number">0</span>]) ^ (r + sum) ^ ((r &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]);</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = l;</span><br><span class="line">  v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//test</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,key[<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">encrypt</span>(v,key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">decrypt</span>(v,key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h4><p>加密算法更换，原理和TEA大同小异</p>
<h5 id="脚本-2"><a href="#脚本-2" class="headerlink" title="脚本"></a>脚本</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">unsigned</span> <span class="type">int</span>* key)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> l = v[<span class="number">0</span>], r = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">    l += (((r &lt;&lt; <span class="number">4</span>) ^ (r &gt;&gt; <span class="number">5</span>)) + r) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    sum += delta;</span><br><span class="line">    r += (((l &lt;&lt; <span class="number">4</span>) ^ (l &gt;&gt; <span class="number">5</span>)) + l) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = l;</span><br><span class="line">  v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">unsigned</span> <span class="type">int</span>* key)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> l = v[<span class="number">0</span>], r = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  sum = delta * <span class="number">32</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">    r -= (((l &lt;&lt; <span class="number">4</span>) ^ (l &gt;&gt; <span class="number">5</span>)) + l) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    sum -= delta;</span><br><span class="line">    l -= (((r &lt;&lt; <span class="number">4</span>) ^ (r &gt;&gt; <span class="number">5</span>)) + r) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = l;</span><br><span class="line">  v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//test</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,key[<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">encrypt</span>(v,key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">decrypt</span>(v,key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h4><p>​		XXTEA使用更复杂的运算方式，它的块大小可以是任意的，密钥也可以是任意长度的。在加密时，XXTEA会对明文进行<strong>分块</strong>，然后每个块都会进行加密，加密后的结果再进行<strong>拼接</strong>，最终形成密文。在解密时，XXTEA会对密文进行分块，然后每个块都会进行解密，解密后的结果再进行拼接，最终形成明文。</p>
<h5 id="脚本-3"><a href="#脚本-3" class="headerlink" title="脚本"></a>脚本</h5><p><strong>注意：这个脚本可以直接传多位明文和密文加解密，无需修改</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX \</span></span><br><span class="line"><span class="meta">  ((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4) ^ (sum ^ y) + (k[p &amp; 3 ^ e] ^ z))</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">xxtea</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">int</span> n, <span class="type">unsigned</span> <span class="type">int</span>* k)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> z = v[n - <span class="number">1</span>], y = v[<span class="number">0</span>], sum = <span class="number">0</span>, e, DELTA = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> p, q;</span><br><span class="line">  <span class="comment">//加密</span></span><br><span class="line">  <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">    <span class="keyword">while</span> (q-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      sum += DELTA;</span><br><span class="line">      e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)</span><br><span class="line">        y = v[p + <span class="number">1</span>], z = v[p] += MX;</span><br><span class="line">      y = v[<span class="number">0</span>];</span><br><span class="line">      z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="comment">//解密</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>) &#123; </span><br><span class="line">    n = -n;</span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">    sum = q * DELTA;</span><br><span class="line">    <span class="keyword">while</span> (sum != <span class="number">0</span>) &#123;</span><br><span class="line">      e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--)</span><br><span class="line">        z = v[p - <span class="number">1</span>], y = v[p] -= MX;</span><br><span class="line">      z = v[n - <span class="number">1</span>];</span><br><span class="line">      y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">      sum -= DELTA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span>* argv[])</span> </span>&#123;</span><br><span class="line">  <span class="comment">// test</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">2</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>&#125;, key[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">xxtea</span>(v, <span class="number">2</span>, key);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">xxtea</span>(v, <span class="number">-2</span>, key);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%u,%u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h3><p>IDEA的明文分组也是64位，密钥为128位，其加解密也是相似的，即可以用相同算法加密和解密。</p>
<h4 id="算法原理"><a href="#算法原理" class="headerlink" title="算法原理"></a>算法原理</h4><h5 id="子密钥生成"><a href="#子密钥生成" class="headerlink" title="子密钥生成"></a>子密钥生成</h5><p><strong>IDEA密钥长度为128位，子密钥长度为16位共52个</strong></p>
<p>a.128位密钥分为8个16位分组，直接作为前八个子密钥</p>
<p>b.128位密钥循环<strong>左移</strong>25位，生成的128位密钥分为8个16位分组，作为接下来的8个子密钥</p>
<p>c.继续执行步骤b，直至52个子密钥全部生成完毕</p>
<h5 id="IDEA加密"><a href="#IDEA加密" class="headerlink" title="IDEA加密"></a>IDEA加密</h5><p>64为明文被分成4个16位分组。每一轮加密都需要6个子密钥，最后的输出变换只需要4个子密钥，所以共需8*6+4&#x3D;52个子密钥。一轮加密中，4个16位子密钥分别通过2个模2^16+1（65537）乘法和2个模2^16(65536)加法运算与明文混合，并用2个16位子密钥按位异或对结果进行处理，<strong>前一轮加密结果作为后一轮加密的输入</strong>。总共进行8轮加密，最后用4个子密钥变换输出最终的密文。</p>
<h5 id="IDEA解密"><a href="#IDEA解密" class="headerlink" title="IDEA解密"></a>IDEA解密</h5><p>解密过程同加密过程，唯一不同的是子密钥不同。</p>
<p>解密所需的52个子密钥是加密子密钥相对于不同操作运输的逆元，且解密时子密钥使用顺序相反。（乘法逆元可以通过扩展欧几里得算法求出）</p>
<p>在data和key处修改需要加解密的密文和密钥，在linux环境下编译</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o idea idea.c</span><br></pre></td></tr></table></figure>



<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://github.com/razvanalex/IDEA-encryption-algorithm</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">__uint32_t</span> <span class="type">uint32_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">__int32_t</span> <span class="type">int32_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">__uint16_t</span> <span class="type">uint16_t</span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*idea_gen_key)</span><span class="params">(<span class="type">uint16_t</span>[<span class="number">52</span>], <span class="type">uint16_t</span>[<span class="number">8</span>])</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint16_t</span> <span class="title">mulMod65537</span><span class="params">(<span class="type">uint16_t</span> a, <span class="type">uint16_t</span> b)</span> </span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> c;</span><br><span class="line">  <span class="type">uint16_t</span> hi, lo;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (a == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> -b + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (b == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> -a + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  c = (<span class="type">uint32_t</span>)a * (<span class="type">uint32_t</span>)b;</span><br><span class="line">  hi = c &gt;&gt; <span class="number">16</span>;</span><br><span class="line">  lo = c;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (lo &gt; hi)</span><br><span class="line">    <span class="keyword">return</span> lo - hi;</span><br><span class="line">  <span class="keyword">return</span> lo - hi + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">modInverse</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> m0 = m, t, q;</span><br><span class="line">  <span class="type">int</span> x0 = <span class="number">0</span>, x1 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (m == <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (a &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// q is quotient</span></span><br><span class="line">    q = a / m;</span><br><span class="line">    t = m;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// m is remainder now, process same as</span></span><br><span class="line">    <span class="comment">// Euclid&#x27;s algo</span></span><br><span class="line">    m = a % m;</span><br><span class="line">    a = t;</span><br><span class="line"></span><br><span class="line">    t = x0;</span><br><span class="line">    x0 = x1 - q * x0;</span><br><span class="line">    x1 = t;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Make x1 positive</span></span><br><span class="line">  <span class="keyword">if</span> (x1 &lt; <span class="number">0</span>)</span><br><span class="line">    x1 += m0;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> x1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">uint16_t</span> subKey[<span class="number">52</span>], <span class="type">uint16_t</span> key[<span class="number">8</span>])</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Generate encryption keys</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">52</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="number">8</span>)</span><br><span class="line">      subKey[i] = key[i];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">8</span> == <span class="number">6</span>)</span><br><span class="line">      subKey[i] = (subKey[i - <span class="number">7</span>] &lt;&lt; <span class="number">9</span>) | (subKey[i - <span class="number">14</span>] &gt;&gt; <span class="number">7</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">8</span> == <span class="number">7</span>)</span><br><span class="line">      subKey[i] = (subKey[i - <span class="number">15</span>] &lt;&lt; <span class="number">9</span>) | (subKey[i - <span class="number">14</span>] &gt;&gt; <span class="number">7</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      subKey[i] = (subKey[i - <span class="number">7</span>] &lt;&lt; <span class="number">9</span>) | (subKey[i - <span class="number">6</span>] &gt;&gt; <span class="number">7</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint16_t</span> subKey[<span class="number">52</span>], <span class="type">uint16_t</span> key[<span class="number">8</span>])</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">uint16_t</span> K[<span class="number">52</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Compute encryption keys</span></span><br><span class="line">  <span class="built_in">encrypt</span>(K, key);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Generate dencryption keys</span></span><br><span class="line">  subKey[<span class="number">0</span>] = <span class="built_in">modInverse</span>(K[<span class="number">48</span>], <span class="number">65537</span>);</span><br><span class="line">  subKey[<span class="number">1</span>] = -K[<span class="number">49</span>];</span><br><span class="line">  subKey[<span class="number">2</span>] = -K[<span class="number">50</span>];</span><br><span class="line">  subKey[<span class="number">3</span>] = <span class="built_in">modInverse</span>(K[<span class="number">51</span>], <span class="number">65537</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Keys: %04X %04X %04X %04X\n&quot;</span>, subKey[<span class="number">0</span>], subKey[<span class="number">1</span>], subKey[<span class="number">2</span>],</span><br><span class="line">         subKey[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">4</span>; i &lt; <span class="number">52</span>; i += <span class="number">6</span>) &#123;</span><br><span class="line">    subKey[i + <span class="number">0</span>] = K[<span class="number">52</span> - i - <span class="number">2</span>];</span><br><span class="line">    subKey[i + <span class="number">1</span>] = K[<span class="number">52</span> - i - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    subKey[i + <span class="number">2</span>] = <span class="built_in">modInverse</span>(K[<span class="number">52</span> - i - <span class="number">6</span>], <span class="number">65537</span>);</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">46</span>) &#123;</span><br><span class="line">      subKey[i + <span class="number">3</span>] = -K[<span class="number">52</span> - i - <span class="number">5</span>];</span><br><span class="line">      subKey[i + <span class="number">4</span>] = -K[<span class="number">52</span> - i - <span class="number">4</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      subKey[i + <span class="number">3</span>] = -K[<span class="number">52</span> - i - <span class="number">4</span>];</span><br><span class="line">      subKey[i + <span class="number">4</span>] = -K[<span class="number">52</span> - i - <span class="number">5</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    subKey[i + <span class="number">5</span>] = <span class="built_in">modInverse</span>(K[<span class="number">52</span> - i - <span class="number">3</span>], <span class="number">65537</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Keys: %04X %04X %04X %04X %04X %04X\n&quot;</span>, subKey[i], subKey[i + <span class="number">1</span>],</span><br><span class="line">           subKey[i + <span class="number">2</span>], subKey[i + <span class="number">3</span>], subKey[i + <span class="number">4</span>], subKey[i + <span class="number">5</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDEA</span><span class="params">(<span class="type">uint16_t</span> data[<span class="number">4</span>], <span class="type">uint16_t</span> key[<span class="number">8</span>], idea_gen_key func)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">uint16_t</span> subKey[<span class="number">52</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Generate keys</span></span><br><span class="line">  <span class="built_in">func</span>(subKey, key);</span><br><span class="line"></span><br><span class="line">  <span class="type">uint16_t</span> X0 = data[<span class="number">0</span>];</span><br><span class="line">  <span class="type">uint16_t</span> X1 = data[<span class="number">1</span>];</span><br><span class="line">  <span class="type">uint16_t</span> X2 = data[<span class="number">2</span>];</span><br><span class="line">  <span class="type">uint16_t</span> X3 = data[<span class="number">3</span>];</span><br><span class="line">  <span class="type">uint16_t</span> tmp1, tmp2;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Apply 8 rounds</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d:   %04X %04X %04X %04X\n&quot;</span>, i, X0, X1, X2, X3);</span><br><span class="line"></span><br><span class="line">    X0 = <span class="built_in">mulMod65537</span>(X0, subKey[<span class="number">6</span> * i + <span class="number">0</span>]);  <span class="comment">// Step 1</span></span><br><span class="line">    X1 += subKey[<span class="number">6</span> * i + <span class="number">1</span>];                  <span class="comment">// Step 2</span></span><br><span class="line">    X2 += subKey[<span class="number">6</span> * i + <span class="number">2</span>];                  <span class="comment">// Step 3</span></span><br><span class="line">    X3 = <span class="built_in">mulMod65537</span>(X3, subKey[<span class="number">6</span> * i + <span class="number">3</span>]);  <span class="comment">// Step 4</span></span><br><span class="line"></span><br><span class="line">    tmp1 = X0 ^ X2;  <span class="comment">// Step 5</span></span><br><span class="line">    tmp2 = X1 ^ X3;  <span class="comment">// Step 6</span></span><br><span class="line"></span><br><span class="line">    tmp1 = <span class="built_in">mulMod65537</span>(tmp1, subKey[<span class="number">6</span> * i + <span class="number">4</span>]);  <span class="comment">// Step 7</span></span><br><span class="line">    tmp2 += tmp1;                                 <span class="comment">// Step 8</span></span><br><span class="line">    tmp2 = <span class="built_in">mulMod65537</span>(tmp2, subKey[<span class="number">6</span> * i + <span class="number">5</span>]);  <span class="comment">// Step 9</span></span><br><span class="line">    tmp1 += tmp2;                                 <span class="comment">// Step 10</span></span><br><span class="line"></span><br><span class="line">    X0 ^= tmp2;</span><br><span class="line">    X1 ^= tmp1;</span><br><span class="line">    X2 ^= tmp2;</span><br><span class="line">    X3 ^= tmp1;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Swap X1 and X2</span></span><br><span class="line">    tmp1 = X1;</span><br><span class="line">    X1 = X2;</span><br><span class="line">    X2 = tmp1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tmp1 = X1;</span><br><span class="line">  tmp2 = X2;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Apply the half round</span></span><br><span class="line">  data[<span class="number">0</span>] = <span class="built_in">mulMod65537</span>(X0, subKey[<span class="number">6</span> * i + <span class="number">0</span>]);</span><br><span class="line">  data[<span class="number">1</span>] = tmp2 + subKey[<span class="number">6</span> * i + <span class="number">1</span>];</span><br><span class="line">  data[<span class="number">2</span>] = tmp1 + subKey[<span class="number">6</span> * i + <span class="number">2</span>];</span><br><span class="line">  data[<span class="number">3</span>] = <span class="built_in">mulMod65537</span>(X3, subKey[<span class="number">6</span> * i + <span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint16_t</span> <span class="title">binToInt</span><span class="params">(<span class="type">char</span>* str)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">uint16_t</span> size = <span class="built_in">strlen</span>(str);</span><br><span class="line">  <span class="type">uint16_t</span> result = <span class="number">0</span>;</span><br><span class="line">  <span class="type">uint16_t</span> pow = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = size - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (str[i] == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">      result += pow;</span><br><span class="line">    pow *= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">convertStringToBin</span><span class="params">(<span class="type">char</span>* str, <span class="type">uint16_t</span>* data, <span class="type">uint16_t</span> size)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i, j = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> sizeBlock = <span class="built_in">sizeof</span>(<span class="type">uint16_t</span>) * <span class="number">8</span>;</span><br><span class="line">  <span class="type">char</span> block[sizeBlock + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str) &amp;&amp; i &lt; size * <span class="built_in">sizeof</span>(<span class="type">uint16_t</span>);</span><br><span class="line">       i += <span class="built_in">sizeof</span>(<span class="type">uint16_t</span>)) &#123;</span><br><span class="line">    <span class="built_in">strncpy</span>(block, str, sizeBlock);</span><br><span class="line">    block[sizeBlock] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    data[j++] = <span class="built_in">binToInt</span>(block);</span><br><span class="line">    str += sizeBlock;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">char</span> Data[<span class="number">64</span>] =</span><br><span class="line">      <span class="string">&quot;0000010100110010000010100110010000010100110010000001100111111010&quot;</span>;</span><br><span class="line">  <span class="type">char</span> Key[<span class="number">128</span>] =</span><br><span class="line">      <span class="string">&quot;000000000110010000000000110010000000000100101100000000011001000000000001&quot;</span></span><br><span class="line">      <span class="string">&quot;11110100000000100101100000000010101111000000001100100000&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">uint16_t</span> data[<span class="number">4</span>];</span><br><span class="line">  <span class="type">uint16_t</span> key[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">convertStringToBin</span>(Data, data, <span class="number">4</span>);</span><br><span class="line">  <span class="built_in">convertStringToBin</span>(Key, key, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Print initial data</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Initial data:   %04X %04X %04X %04X\n&quot;</span>, data[<span class="number">0</span>], data[<span class="number">1</span>], data[<span class="number">2</span>],</span><br><span class="line">         data[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Encrypt data</span></span><br><span class="line">  <span class="built_in">IDEA</span>(data, key, encrypt);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Encrypted data: %04X %04X %04X %04X\n&quot;</span>, data[<span class="number">0</span>], data[<span class="number">1</span>], data[<span class="number">2</span>],</span><br><span class="line">         data[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Decrypt data</span></span><br><span class="line">  <span class="built_in">IDEA</span>(data, key, decrypt);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Decrypted data: %04X %04X %04X %04X\n&quot;</span>, data[<span class="number">0</span>], data[<span class="number">1</span>], data[<span class="number">2</span>],</span><br><span class="line">         data[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h3><p>​		DES(Data Encryption Standard)，是一种块密码，分组大小为64位，密钥长度为56位（长度总共为64位，实际为56位，第8、16、24、32、40、48、56、64位是校验位）</p>
<p>​		</p>
<p>​		逆向×密码学√</p>
<p><strong>DES加密原理</strong>如下：</p>
<img src="/2024/03/03/encrypt-reverse/802212-20161009222915538-1765873611.png" class="" title="img">



<img src="/2024/03/03/encrypt-reverse/image-20240118112522644.png" class="" title="image-20240118112522644">

<ol>
<li><strong>初始置换（Initial Permutation）：</strong> 明文经过一个初始的置换，将明文的每一位按照特定规则重新排列。</li>
<li><strong>轮函数（Feistel Network）：</strong> DES采用Feistel结构，将明文分成两个等长的半块，并且使用一个子密钥对其中一个半块进行处理。这个处理过程包括以下步骤：<ul>
<li>将右半块进行扩展，得到一个更长的半块。</li>
<li>将扩展后的半块与子密钥进行异或操作。</li>
<li>将异或的结果分成8个6位的块，每个块作为S盒的输入，经过S盒置换得到4位的输出。</li>
<li>将S盒输出合并，并经过一个固定的置换，得到一个4位的半块。</li>
<li>将这个半块与左半块进行异或操作，得到新的右半块。</li>
</ul>
</li>
<li><strong>16轮迭代：</strong> DES总共进行16轮的Feistel迭代，每轮使用不同的子密钥。</li>
<li><strong>最终置换（Final Permutation）：</strong> 在最后一轮迭代后，将左右两半块交换，然后进行一个最终的置换。</li>
<li><strong>密钥生成：</strong> DES使用56位的密钥，但实际上只有48位被用于加密过程。密钥经过置换、分割和循环左移等操作，生成16个子密钥，每个子密钥48位长。</li>
</ol>
<h4 id="脚本-4"><a href="#脚本-4" class="headerlink" title="脚本"></a>脚本</h4><p>注意：脚本只能加密8字节密文，cyberchef中使用了padding填充</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  IP 初始置换表</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> IP_Init_Table[<span class="number">64</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>,  <span class="number">9</span>, <span class="number">1</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  E 扩展表</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> E_Table[<span class="number">48</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">32</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>,</span><br><span class="line">     <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">    <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">    <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>,  <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  P 盒</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> P_Table[<span class="number">32</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,  <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,  <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">     <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>,  <span class="number">3</span>,  <span class="number">9</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>,  <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>,  <span class="number">4</span>, <span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  IP 逆置换表</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> IPR_Table[<span class="number">64</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">    <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>, <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">    <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">    <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>,  <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  密钥第一次置换表</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> PC1_Table[<span class="number">56</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>,  <span class="number">9</span>,  <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">    <span class="number">10</span>,  <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">    <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,  <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">    <span class="number">14</span>,  <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>,  <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>,  <span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  密钥第二次置换表</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> PC2_Table[<span class="number">48</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>,  <span class="number">1</span>,  <span class="number">5</span>,  <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>,  <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line">    <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>,  <span class="number">4</span>, <span class="number">26</span>,  <span class="number">8</span>, <span class="number">16</span>,  <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>,  <span class="number">2</span>,</span><br><span class="line">    <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>,</span><br><span class="line">    <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  S 盒</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> S_Box[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//  s1</span></span><br><span class="line">    <span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>,</span><br><span class="line">    <span class="comment">//  s2</span></span><br><span class="line">    <span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">    <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="comment">//  s3</span></span><br><span class="line">    <span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>,</span><br><span class="line">    <span class="comment">//  s4</span></span><br><span class="line">    <span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>,</span><br><span class="line">    <span class="comment">//  s5</span></span><br><span class="line">    <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">    <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">    <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="comment">//  s6</span></span><br><span class="line">    <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">    <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>,</span><br><span class="line">    <span class="comment">//  s7</span></span><br><span class="line">    <span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>,</span><br><span class="line">    <span class="comment">//  s8</span></span><br><span class="line">    <span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,  </span><br><span class="line">    <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  类型转换函数 I</span></span><br><span class="line"><span class="comment"> *  将 char 型转化为二进制形式</span></span><br><span class="line"><span class="comment"> *  8 * sizeof(char) = 8(位) 8 个字符 64 位</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CharToBit</span><span class="params">(<span class="type">const</span> <span class="type">char</span> input[], <span class="type">int</span> output[], <span class="type">int</span> bits)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            output[<span class="number">7</span> * (j + <span class="number">1</span>) - i + j] = (input[j] &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  类型转换函数 II</span></span><br><span class="line"><span class="comment"> *  将二进制形式转化为 char 型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BitToChar</span><span class="params">(<span class="type">const</span> <span class="type">int</span> intput[], <span class="type">char</span> output[], <span class="type">int</span> bits)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            output[j] = output[j] * <span class="number">2</span> + intput[i + <span class="number">8</span> * j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  异或函数</span></span><br><span class="line"><span class="comment"> *  将数组 INA 和 INB 进行异或操作，并且保存在 INA 中</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Xor</span><span class="params">(<span class="type">int</span> *INA, <span class="type">int</span> *INB, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i&lt;len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        *(INA + i) = *(INA + i) ^ *(INB + i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  IP 初始置换函数</span></span><br><span class="line"><span class="comment"> *  IP 根据 IP 初始置换表进行初始置换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IP_Init_Rep</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">64</span>], <span class="type">int</span> output[<span class="number">64</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">64</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[table[i] - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  E 扩展置换函数</span></span><br><span class="line"><span class="comment"> *  根据 E 扩展表进行扩展</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">E_Extend</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">32</span>], <span class="type">int</span> output[<span class="number">48</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">48</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[table[i] - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  P 置换函数</span></span><br><span class="line"><span class="comment"> *  根据 P 盒进行置换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">P_Rep</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">32</span>], <span class="type">int</span> output[<span class="number">32</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">32</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[table[i] - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  IP 逆置换函数</span></span><br><span class="line"><span class="comment"> *  IP 根据 IP 逆置换表进行置换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IP_Inv_Rep</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">64</span>], <span class="type">int</span> output[<span class="number">64</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">64</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[table[i] - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  密匙第一次置换函数</span></span><br><span class="line"><span class="comment"> *  根据密匙第一次置换表进行置换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PC_1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">64</span>], <span class="type">int</span> output[<span class="number">56</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">56</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">56</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[table[i] - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  密匙第二次置换函数</span></span><br><span class="line"><span class="comment"> *  根据密匙第二次置换表进行置换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PC_2</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">56</span>], <span class="type">int</span> output[<span class="number">48</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">48</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[table[i] - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  S 盒压缩函数</span></span><br><span class="line"><span class="comment"> *  根据 8 个 S 盒进行压缩</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">S_Comp</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">48</span>], <span class="type">int</span> output[<span class="number">32</span>], <span class="type">const</span> <span class="type">int</span> table[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> INT[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; <span class="number">48</span>; i = i + <span class="number">6</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        INT[j] = table[j][(input[i] &lt;&lt; <span class="number">1</span>)</span><br><span class="line">               + (input[i + <span class="number">5</span>])][(input[i + <span class="number">1</span>] &lt;&lt; <span class="number">3</span>)</span><br><span class="line">               + (input[i + <span class="number">2</span>] &lt;&lt; <span class="number">2</span>)</span><br><span class="line">               + (input[i + <span class="number">3</span>] &lt;&lt; <span class="number">1</span>)</span><br><span class="line">               + (input[i + <span class="number">4</span>])];</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            output[<span class="number">3</span> * (j + <span class="number">1</span>) - i + j] = (INT[j] &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  轮迭代函数</span></span><br><span class="line"><span class="comment"> *  DES 核心迭代部分</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F_func</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">32</span>], <span class="type">int</span> output[<span class="number">32</span>], <span class="type">int</span> subKey[<span class="number">48</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">48</span>;</span><br><span class="line">    <span class="type">int</span> temp0[<span class="number">48</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> temp1[<span class="number">32</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">E_Extend</span>(input, temp0, E_Table);</span><br><span class="line">    <span class="built_in">Xor</span>(temp0, subKey, len);</span><br><span class="line">    <span class="built_in">S_Comp</span>(temp0, temp1, S_Box);</span><br><span class="line">    <span class="built_in">P_Rep</span>(temp1, output, P_Table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  密匙循环左移函数</span></span><br><span class="line"><span class="comment"> *  密匙在不同轮数都要进行不同的左移操作</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RotateL</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">28</span>], <span class="type">int</span> output[<span class="number">28</span>], <span class="type">int</span> leftCount)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">28</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[(i + leftCount) % len];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  子密匙生成函数</span></span><br><span class="line"><span class="comment"> *  生成 subKey，在第 1、2、9、16 轮循环左移 1 位，其他轮循环左移 2 位</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">subKey_fun</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">64</span>], <span class="type">int</span> subKey[<span class="number">16</span>][<span class="number">48</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> loop0 = <span class="number">1</span>, loop1 = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> c[<span class="number">28</span>], d[<span class="number">28</span>];</span><br><span class="line">    <span class="type">int</span> pc_1[<span class="number">56</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> pc_2[<span class="number">16</span>][<span class="number">56</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> rotatel_c[<span class="number">16</span>][<span class="number">28</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> rotatel_d[<span class="number">16</span>][<span class="number">28</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">PC_1</span>(input, pc_1, PC1_Table);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">28</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        c[i] = pc_1[i];</span><br><span class="line">        d[i] = pc_1[i + <span class="number">28</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> leftCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">17</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">1</span> || i == <span class="number">2</span> || i == <span class="number">9</span> || i == <span class="number">16</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            leftCount += loop0;</span><br><span class="line">            <span class="built_in">RotateL</span>(c, rotatel_c[i - <span class="number">1</span>], leftCount);</span><br><span class="line">            <span class="built_in">RotateL</span>(d, rotatel_d[i - <span class="number">1</span>], leftCount);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            leftCount += loop1;</span><br><span class="line">            <span class="built_in">RotateL</span>(c, rotatel_c[i - <span class="number">1</span>], leftCount);</span><br><span class="line">            <span class="built_in">RotateL</span>(d, rotatel_d[i - <span class="number">1</span>], leftCount);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">28</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            pc_2[i][j] = rotatel_c[i][j];</span><br><span class="line">            pc_2[i][j + <span class="number">28</span>] = rotatel_d[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">PC_2</span>(pc_2[i], subKey[i], PC2_Table);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  DES 加密函数</span></span><br><span class="line"><span class="comment"> *  传入明文 input 和密匙 inKey，获取 64 位二进制密文 output</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DES_Efun</span><span class="params">(<span class="type">const</span> <span class="type">char</span> input[<span class="number">8</span>], <span class="type">char</span> inKey[<span class="number">8</span>], <span class="type">int</span> output[<span class="number">64</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ip[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> output_1[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> subKeys[<span class="number">16</span>][<span class="number">48</span>];</span><br><span class="line">    <span class="type">int</span> chartobit[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> key[<span class="number">64</span>];</span><br><span class="line">    <span class="type">int</span> l[<span class="number">17</span>][<span class="number">32</span>], r[<span class="number">17</span>][<span class="number">32</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CharToBit</span>(input, chartobit, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">IP_Init_Rep</span>(chartobit, ip, IP_Init_Table);</span><br><span class="line">    <span class="built_in">CharToBit</span>(inKey, key, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">subKey_fun</span>(key, subKeys);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        l[<span class="number">0</span>][i] = ip[i];</span><br><span class="line">        r[<span class="number">0</span>][i] = ip[<span class="number">32</span> + i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; <span class="number">16</span>; j++)    <span class="comment">//  15 轮迭代</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">32</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            l[j][k] = r[j - <span class="number">1</span>][k];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">F_func</span>(r[j - <span class="number">1</span>], r[j], subKeys[j - <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">Xor</span>(r[j], l[j - <span class="number">1</span>], <span class="number">32</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; <span class="number">32</span>; t++)        <span class="comment">//  第 16 轮迭代</span></span><br><span class="line">    &#123;</span><br><span class="line">        r[<span class="number">16</span>][t] = r[<span class="number">15</span>][t];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">F_func</span>(r[<span class="number">15</span>], l[<span class="number">16</span>], subKeys[<span class="number">15</span>]);</span><br><span class="line">    <span class="built_in">Xor</span>(l[<span class="number">16</span>], l[<span class="number">15</span>], <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; <span class="number">32</span>; t++)</span><br><span class="line">    &#123;</span><br><span class="line">        output_1[t] = l[<span class="number">16</span>][t];</span><br><span class="line">        output_1[<span class="number">32</span> + t] = r[<span class="number">16</span>][t];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">IP_Inv_Rep</span>(output_1, output, IPR_Table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *  DES 解密函数</span></span><br><span class="line"><span class="comment"> *  传入 64 位二进制密文 input 和密匙 inKey 获取明文 output</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DES_Dfun</span><span class="params">(<span class="type">const</span> <span class="type">int</span> input[<span class="number">64</span>], <span class="type">char</span> inKey[<span class="number">8</span>], <span class="type">char</span> output[<span class="number">8</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ip[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> output_1[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> output_2[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> subKeys[<span class="number">16</span>][<span class="number">48</span>];</span><br><span class="line">    <span class="type">int</span> key[<span class="number">64</span>];</span><br><span class="line">    <span class="type">int</span> l[<span class="number">17</span>][<span class="number">32</span>], r[<span class="number">17</span>][<span class="number">32</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">IP_Init_Rep</span>(input, ip, IP_Init_Table);</span><br><span class="line">    <span class="built_in">CharToBit</span>(inKey, key, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">subKey_fun</span>(key, subKeys);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        l[<span class="number">0</span>][i] = ip[i];</span><br><span class="line">        r[<span class="number">0</span>][i] = ip[<span class="number">32</span> + i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; <span class="number">16</span>; j++)    <span class="comment">//  15 轮迭代</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">32</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            l[j][k] = r[j - <span class="number">1</span>][k];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">F_func</span>(r[j - <span class="number">1</span>], r[j], subKeys[<span class="number">16</span> - j]);</span><br><span class="line">        <span class="built_in">Xor</span>(r[j], l[j - <span class="number">1</span>], <span class="number">32</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; <span class="number">32</span>; t++)        <span class="comment">//  第 16 轮迭代</span></span><br><span class="line">    &#123;</span><br><span class="line">        r[<span class="number">16</span>][t] = r[<span class="number">15</span>][t];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">F_func</span>(r[<span class="number">15</span>], l[<span class="number">16</span>], subKeys[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">Xor</span>(l[<span class="number">16</span>], l[<span class="number">15</span>], <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; <span class="number">32</span>; t++)</span><br><span class="line">    &#123;</span><br><span class="line">        output_1[t] = l[<span class="number">16</span>][t];</span><br><span class="line">        output_1[<span class="number">32</span> + t] = r[<span class="number">16</span>][t];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">IP_Inv_Rep</span>(output_1, output_2, IPR_Table);</span><br><span class="line">    <span class="built_in">BitToChar</span>(output_2, output, <span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> output[<span class="number">64</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> A[<span class="number">9</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> B[<span class="number">9</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入明文(8字节)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, A);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入密匙(8字节)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, B);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">DES_Efun</span>(A, B, output);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;对明文进行加密\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;密文:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, output[i]);</span><br><span class="line">        <span class="keyword">if</span> ((i + <span class="number">1</span>) % <span class="number">8</span> == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((i + <span class="number">1</span>) % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;对密文进行解密\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">DES_Dfun</span>(output, B, A);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;明文:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, A[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>代码的主要流程：</p>
<ol>
<li>输入明文和密钥。</li>
<li>将明文和密钥转换为二进制形式。</li>
<li>初始置换（IP_Init_Rep）：对明文进行初始置换。</li>
<li>子密钥生成（subKey_fun）：生成16轮的子密钥。</li>
<li>进行16轮的迭代加密&#x2F;解密过程（F_func、Xor）。</li>
<li>逆置换（IP_Inv_Rep）：对得到的结果进行逆置换，得到最终加密&#x2F;解密结果。</li>
<li>输出密文或明文。</li>
</ol>
<h4 id="拓展：3DES"><a href="#拓展：3DES" class="headerlink" title="拓展：3DES"></a>拓展：3DES</h4><p>3DES使用“密钥包”，其包含3个DES密钥，K1，K2和K3，均为56位（除去奇偶校验位）。加密算法为：</p>
<p>使用K1为密钥进行DES加密，再用K2为密钥进行DES“解密”，最后以K3进行DES加密。</p>
<p>而解密则为其反过程：</p>
<p>即以K3解密，以K2“加密”，最后以K1解密。</p>
<p>每次加密操作都只处理64位数据，称为一块。</p>
<p>无论是加密还是解密，中间一步都是前后两步的逆。这种做法提高了使用密钥选项2时的算法强度，并在使用密钥选项3时与DES兼容。</p>
<ul>
<li>密钥选项1：三个密钥是独立的。</li>
<li>密钥选项2：K1和K2是独立的，而K3&#x3D;K1</li>
<li>密钥选项3：三个密钥均相等，即K1&#x3D;K2&#x3D;K3</li>
</ul>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>AES（Advanced Encryption Standard）是一种对称加密算法，其加密过程涉及几个主要步骤，包括轮密钥加、轮替代、轮混淆和轮置换。以下是AES加密的简要过程：</p>
<ol>
<li><strong>密钥扩展（Key Expansion）：</strong><ul>
<li>根据初始密钥，生成一系列轮密钥（Round Keys），这些轮密钥将用于后续的加密轮次。</li>
</ul>
</li>
<li><strong>初始轮密钥加（AddRoundKey）：</strong><ul>
<li>将明文与第一个轮密钥进行异或操作。</li>
</ul>
</li>
<li><strong>多轮加密（Rounds）：</strong><ul>
<li>AES的加密过程包含多轮加密。标准的AES分为10轮（128位密钥）、12轮（192位密钥）和14轮（256位密钥）。</li>
<li>每一轮加密包括四个步骤：轮替代（SubBytes）、行移位（ShiftRows）、列混淆（MixColumns）和轮密钥加（AddRoundKey）。<ul>
<li><strong>轮替代（SubBytes）：</strong> 对每个字节使用S盒进行替代。</li>
<li><strong>行移位（ShiftRows）：</strong> 对每一行进行循环左移。第一行不移动，第二行左移1字节，第三行左移2字节，第四行左移3字节。</li>
<li><strong>列混淆（MixColumns）：</strong> 对列进行混淆操作，涉及到一系列的线性变换。</li>
<li><strong>轮密钥加（AddRoundKey）：</strong> 将当前状态与对应的轮密钥进行异或操作。</li>
</ul>
</li>
</ul>
</li>
<li><strong>最终轮：</strong><ul>
<li>在最后一轮，省略列混淆步骤，只执行轮替代、行移位和轮密钥加。</li>
</ul>
</li>
<li><strong>输出密文：</strong><ul>
<li>在多轮加密完成后，得到最终的密文。</li>
</ul>
</li>
</ol>
<p>总体而言，AES的加密过程是一个迭代的过程，每一轮都涉及一系列的操作，其中包括字节替代、行移位、列混淆和轮密钥加。这些步骤的组合确保了AES的安全性。密文的长度等于明文块的长度，AES支持128位、192位和256位的密钥，对应不同的安全级别。</p>
<p>在加解密过程中，如果输入的数据的长度非16的倍数，则需要对该数据进行padding处理。</p>
<p><strong>简单总结AES</strong>：</p>
<p>明文与密钥表进行异或，然后多轮（每轮先用S盒替换，再行移位，列混淆，轮密钥异或），最后一轮省略列混淆。</p>
<h4 id="AES的分类"><a href="#AES的分类" class="headerlink" title="AES的分类"></a>AES的分类</h4><p><code>cbc</code>本质上和<code>ecb</code>差别不大，唯一区别是<code>cbc</code>将前一次加密结果，与要加密的内容异或。因此，<code>cbc</code>的并行性较差，因为每次都要等待前一次的结果，而<code>ecb</code>则不用，速度较快。</p>
<p>加密过程比较复杂，可以看这个视频：</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1i341187fK/?share_source=copy_web&vd_source=e96311532f2f7af12b275834dfed9adb">【AES加密算法】| AES加密过程详解| 对称加密| Rijndael-128| 密码学| 信息安全</a></p>
<p>脚本来源：<a target="_blank" rel="noopener" href="https://github.com/dhuertas/AES">GitHub - dhuertas&#x2F;AES: AES algorithm implementation in C</a></p>
<p>在Linux运行，修改main.c里面的数据即可。好像这个只能对16字节明文加密。</p>
<h3 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h3><p>SM4是一种<strong>分组密码算法</strong>，由我国国家密码管理局在2012年发布，常用于无线互联网加密等领域。</p>
<h4 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h4><p><strong>F函数</strong></p>
<p><em>F(X0, X1, X2, X3, rk) &#x3D; X0 ⊕ T(X1 ⊕ X2 ⊕ X3 ⊕ rk)</em></p>
<p><strong>合成置换T</strong></p>
<p>由非线性变换τ 和线性变换L复合合成 <em>T(x)&#x3D;L(τ(x))</em></p>
<p><strong>非线性变换τ</strong></p>
<p>τ由四个并行的S-box组成（S-box为16*16 * 8bits，输入8bits，输出8bits）</p>
<p>若输出为<em>A(A0, A1, A2, A3)*，输出为*B(B0, B1, B2, B3)</em></p>
<p>则<em>B(B0, B1, B2, B3) &#x3D; τ(A) &#x3D; (S-box(A0), S-box(A1), S-box(A2), S-box(A3)</em></p>
<p><strong>线性变换L</strong></p>
<p>线性变换L的输入是非线性变换τ的输出</p>
<p>输出<em>C &#x3D; L(B) &#x3D; B ⊕ (B &lt;&lt;&lt; 2) ⊕ (B &lt;&lt;&lt; 10) ⊕ (B &lt;&lt;&lt; 18) ⊕ (B &lt;&lt;&lt; 24)</em></p>
<p><strong>T’变换</strong></p>
<p><em>T’(x)&#x3D;L’(τ(x))</em></p>
<p><strong>L’变换</strong></p>
<p><em>C &#x3D; L(B) &#x3D; B ⊕ (B &lt;&lt;&lt; 13) ⊕ (B &lt;&lt;&lt; 23)</em></p>
<p>反序变换<em>R(A0, A1, A2, A3) &#x3D; (A3, A2, A1, A0)</em></p>
<h4 id="密钥扩展算法"><a href="#密钥扩展算法" class="headerlink" title="密钥扩展算法"></a>密钥扩展算法</h4><p>加密密钥128位为 <em>MK(MK0, MK1, MK2, MK3)</em></p>
<p>子密钥128位，共32个为<em>rk0, rk1 , … , rk31</em></p>
<p>系统参数<strong>FKi</strong>取值为FK[4] &#x3D; {0xa3b1bac6, 0x56aa3350, 0x677d9197, 0xb27022dc}</p>
<p>固定参数<strong>CKi</strong>取值为 CK[32] &#x3D; {</p>
<p> 0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1,</p>
<p> 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249,</p>
<p> 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1,</p>
<p> 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299,</p>
<p> 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41,</p>
<p> 0x484f565d, 0x646b7279};</p>
<p><strong>子密钥生成算法如下</strong></p>
<p>(K0,K1,K2,K3)&#x3D;(MK0 ⊕ FK0, MK1⊕FK1, MK2⊕FK2, MK3⊕FK3)</p>
<p>rki &#x3D; K(i+4) &#x3D; Ki ⊕ T’(K(i+1) ⊕ K(i+2) ⊕ K(i+3) ⊕ CKi) (i &#x3D; 0 ,1 , … , 31)*</p>
<h4 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h4><p>明文输入为X(X0, X1, X2, X3)*，密文输出为*Y(Y0, Y1, Y2, Y3)</p>
<p>Xi+4 &#x3D; F(Xi, Xi+1, Xi+2, Xi+3, rki) &#x3D; Xi ⊕ T(Xi+1 ⊕ Xi+2 ⊕ Xi+3 ⊕ rki) (i &#x3D; 0 ,1 , … , 31)</p>
<p>Y(Y0, Y1, Y2, Y3) &#x3D; R(X32, X33, X34, X35) &#x3D; (X35, X34, X33, X32)</p>
<h4 id="解密算法"><a href="#解密算法" class="headerlink" title="解密算法"></a>解密算法</h4><p>解密算法和加密算法相同，唯一区别是密钥使用顺序要<strong>逆序</strong>使用</p>
<h4 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h4><p>CK值是固定的</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">long</span> CK[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>, <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>,</span><br><span class="line">    <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>, <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>,</span><br><span class="line">    <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>, <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>,</span><br><span class="line">    <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>, <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">    <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>, <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>,</span><br><span class="line">    <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span>&#125;;</span><br></pre></td></tr></table></figure>



<h4 id="脚本-5"><a href="#脚本-5" class="headerlink" title="脚本"></a>脚本</h4><p>只进行ecb加密</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * \file sm4.h</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> XYSSL_SM4_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> XYSSL_SM4_H</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SM4_ENCRYPT     1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SM4_DECRYPT     0</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> GET_ULONG_BE</span></span><br><span class="line"><span class="comment">//将字符型数组b的第i到第i+3位的二进制拼接成一个4*8=32bit的整数，存入n中</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GET_ULONG_BE(n,b,i)                             \</span></span><br><span class="line"><span class="meta">&#123;                                                       \</span></span><br><span class="line"><span class="meta">    (n) = ( (unsigned long) (b)[(i)    ] &lt;&lt; 24 )        \</span></span><br><span class="line"><span class="meta">        | ( (unsigned long) (b)[(i) + 1] &lt;&lt; 16 )        \</span></span><br><span class="line"><span class="meta">        | ( (unsigned long) (b)[(i) + 2] &lt;&lt;  8 )        \</span></span><br><span class="line"><span class="meta">        | ( (unsigned long) (b)[(i) + 3]       );       \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">//将整数n的32位的二进制表示转换为4个char的数组，存入数组b的第i到第i+3位</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PUT_ULONG_BE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PUT_ULONG_BE(n,b,i)                             \</span></span><br><span class="line"><span class="meta">&#123;                                                       \</span></span><br><span class="line"><span class="meta">    (b)[(i)    ] = (unsigned char) ( (n) &gt;&gt; 24 );       \</span></span><br><span class="line"><span class="meta">    (b)[(i) + 1] = (unsigned char) ( (n) &gt;&gt; 16 );       \</span></span><br><span class="line"><span class="meta">    (b)[(i) + 2] = (unsigned char) ( (n) &gt;&gt;  8 );       \</span></span><br><span class="line"><span class="meta">    (b)[(i) + 3] = (unsigned char) ( (n)       );       \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">//循环左移 的巧妙实现（SHL(x,n)可以得到左移n位之后的结果，然后与右移的结果((x) &gt;&gt; (32 - n))逐位或来将右边空缺的n位补齐，效率比较高。） </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  SHL(x,n) (((x) &amp; 0xFFFFFFFF) &lt;&lt; n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROTL(x,n) (SHL((x),n) | ((x) &gt;&gt; (32 - n)))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SWAP(a,b) &#123; unsigned long t = a; a = b; b = t; t = 0; &#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * \brief          SM4 context structure</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> mode;                   <span class="comment">/*!&lt;  encrypt/decrypt   */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> sk[<span class="number">32</span>];       <span class="comment">/*!&lt;  SM4 subkeys       */</span></span><br><span class="line">&#125;</span><br><span class="line">sm4_context;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * \brief          SM4 key schedule (128-bit, encryption)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * \param ctx      SM4 context to be initialized</span></span><br><span class="line"><span class="comment"> * \param key      16-byte secret key</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_setkey_enc</span><span class="params">( sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>] )</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * \brief          SM4 key schedule (128-bit, decryption)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * \param ctx      SM4 context to be initialized</span></span><br><span class="line"><span class="comment"> * \param key      16-byte secret key</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_setkey_dec</span><span class="params">( sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>] )</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * \brief          SM4-ECB block encryption/decryption</span></span><br><span class="line"><span class="comment"> * \param ctx      SM4 context</span></span><br><span class="line"><span class="comment"> * \param mode     SM4_ENCRYPT or SM4_DECRYPT</span></span><br><span class="line"><span class="comment"> * \param length   length of the input data</span></span><br><span class="line"><span class="comment"> * \param input    input block</span></span><br><span class="line"><span class="comment"> * \param output   output block</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_crypt_ecb</span><span class="params">( sm4_context *ctx,</span></span></span><br><span class="line"><span class="params"><span class="function">				     <span class="type">int</span> mode,</span></span></span><br><span class="line"><span class="params"><span class="function">					 <span class="type">int</span> length,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">unsigned</span> <span class="type">char</span> *input,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">unsigned</span> <span class="type">char</span> *output)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * \brief          SM4-CBC buffer encryption/decryption</span></span><br><span class="line"><span class="comment"> * \param ctx      SM4 context</span></span><br><span class="line"><span class="comment"> * \param mode     SM4_ENCRYPT or SM4_DECRYPT</span></span><br><span class="line"><span class="comment"> * \param length   length of the input data</span></span><br><span class="line"><span class="comment"> * \param iv       initialization vector (updated after use)</span></span><br><span class="line"><span class="comment"> * \param input    buffer holding the input data</span></span><br><span class="line"><span class="comment"> * \param output   buffer holding the output data</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_crypt_cbc</span><span class="params">( sm4_context *ctx,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">int</span> mode,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">int</span> length,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">unsigned</span> <span class="type">char</span> iv[<span class="number">16</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">unsigned</span> <span class="type">char</span> *input,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">unsigned</span> <span class="type">char</span> *output )</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* sm4.h */</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">sm4.cpp</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;sm4.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">//S盒 </span></span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> Sbox[<span class="number">256</span>] = &#123;  </span><br><span class="line">    <span class="number">0xd6</span>,<span class="number">0x90</span>,<span class="number">0xe9</span>,<span class="number">0xfe</span>,<span class="number">0xcc</span>,<span class="number">0xe1</span>,<span class="number">0x3d</span>,<span class="number">0xb7</span>,<span class="number">0x16</span>,<span class="number">0xb6</span>,<span class="number">0x14</span>,<span class="number">0xc2</span>,<span class="number">0x28</span>,<span class="number">0xfb</span>,<span class="number">0x2c</span>,<span class="number">0x05</span>,  </span><br><span class="line">    <span class="number">0x2b</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x76</span>,<span class="number">0x2a</span>,<span class="number">0xbe</span>,<span class="number">0x04</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0x44</span>,<span class="number">0x13</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x86</span>,<span class="number">0x06</span>,<span class="number">0x99</span>,  </span><br><span class="line">    <span class="number">0x9c</span>,<span class="number">0x42</span>,<span class="number">0x50</span>,<span class="number">0xf4</span>,<span class="number">0x91</span>,<span class="number">0xef</span>,<span class="number">0x98</span>,<span class="number">0x7a</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x0b</span>,<span class="number">0x43</span>,<span class="number">0xed</span>,<span class="number">0xcf</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,  </span><br><span class="line">    <span class="number">0xe4</span>,<span class="number">0xb3</span>,<span class="number">0x1c</span>,<span class="number">0xa9</span>,<span class="number">0xc9</span>,<span class="number">0x08</span>,<span class="number">0xe8</span>,<span class="number">0x95</span>,<span class="number">0x80</span>,<span class="number">0xdf</span>,<span class="number">0x94</span>,<span class="number">0xfa</span>,<span class="number">0x75</span>,<span class="number">0x8f</span>,<span class="number">0x3f</span>,<span class="number">0xa6</span>,  </span><br><span class="line">    <span class="number">0x47</span>,<span class="number">0x07</span>,<span class="number">0xa7</span>,<span class="number">0xfc</span>,<span class="number">0xf3</span>,<span class="number">0x73</span>,<span class="number">0x17</span>,<span class="number">0xba</span>,<span class="number">0x83</span>,<span class="number">0x59</span>,<span class="number">0x3c</span>,<span class="number">0x19</span>,<span class="number">0xe6</span>,<span class="number">0x85</span>,<span class="number">0x4f</span>,<span class="number">0xa8</span>,  </span><br><span class="line">    <span class="number">0x68</span>,<span class="number">0x6b</span>,<span class="number">0x81</span>,<span class="number">0xb2</span>,<span class="number">0x71</span>,<span class="number">0x64</span>,<span class="number">0xda</span>,<span class="number">0x8b</span>,<span class="number">0xf8</span>,<span class="number">0xeb</span>,<span class="number">0x0f</span>,<span class="number">0x4b</span>,<span class="number">0x70</span>,<span class="number">0x56</span>,<span class="number">0x9d</span>,<span class="number">0x35</span>,  </span><br><span class="line">    <span class="number">0x1e</span>,<span class="number">0x24</span>,<span class="number">0x0e</span>,<span class="number">0x5e</span>,<span class="number">0x63</span>,<span class="number">0x58</span>,<span class="number">0xd1</span>,<span class="number">0xa2</span>,<span class="number">0x25</span>,<span class="number">0x22</span>,<span class="number">0x7c</span>,<span class="number">0x3b</span>,<span class="number">0x01</span>,<span class="number">0x21</span>,<span class="number">0x78</span>,<span class="number">0x87</span>,  </span><br><span class="line">    <span class="number">0xd4</span>,<span class="number">0x00</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0x9f</span>,<span class="number">0xd3</span>,<span class="number">0x27</span>,<span class="number">0x52</span>,<span class="number">0x4c</span>,<span class="number">0x36</span>,<span class="number">0x02</span>,<span class="number">0xe7</span>,<span class="number">0xa0</span>,<span class="number">0xc4</span>,<span class="number">0xc8</span>,<span class="number">0x9e</span>,  </span><br><span class="line">    <span class="number">0xea</span>,<span class="number">0xbf</span>,<span class="number">0x8a</span>,<span class="number">0xd2</span>,<span class="number">0x40</span>,<span class="number">0xc7</span>,<span class="number">0x38</span>,<span class="number">0xb5</span>,<span class="number">0xa3</span>,<span class="number">0xf7</span>,<span class="number">0xf2</span>,<span class="number">0xce</span>,<span class="number">0xf9</span>,<span class="number">0x61</span>,<span class="number">0x15</span>,<span class="number">0xa1</span>,  </span><br><span class="line">    <span class="number">0xe0</span>,<span class="number">0xae</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x9b</span>,<span class="number">0x34</span>,<span class="number">0x1a</span>,<span class="number">0x55</span>,<span class="number">0xad</span>,<span class="number">0x93</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0xf5</span>,<span class="number">0x8c</span>,<span class="number">0xb1</span>,<span class="number">0xe3</span>,  </span><br><span class="line">    <span class="number">0x1d</span>,<span class="number">0xf6</span>,<span class="number">0xe2</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x66</span>,<span class="number">0xca</span>,<span class="number">0x60</span>,<span class="number">0xc0</span>,<span class="number">0x29</span>,<span class="number">0x23</span>,<span class="number">0xab</span>,<span class="number">0x0d</span>,<span class="number">0x53</span>,<span class="number">0x4e</span>,<span class="number">0x6f</span>,  </span><br><span class="line">    <span class="number">0xd5</span>,<span class="number">0xdb</span>,<span class="number">0x37</span>,<span class="number">0x45</span>,<span class="number">0xde</span>,<span class="number">0xfd</span>,<span class="number">0x8e</span>,<span class="number">0x2f</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0x6a</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x6c</span>,<span class="number">0x5b</span>,<span class="number">0x51</span>,  </span><br><span class="line">    <span class="number">0x8d</span>,<span class="number">0x1b</span>,<span class="number">0xaf</span>,<span class="number">0x92</span>,<span class="number">0xbb</span>,<span class="number">0xdd</span>,<span class="number">0xbc</span>,<span class="number">0x7f</span>,<span class="number">0x11</span>,<span class="number">0xd9</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x1f</span>,<span class="number">0x10</span>,<span class="number">0x5a</span>,<span class="number">0xd8</span>,  </span><br><span class="line">    <span class="number">0x0a</span>,<span class="number">0xc1</span>,<span class="number">0x31</span>,<span class="number">0x88</span>,<span class="number">0xa5</span>,<span class="number">0xcd</span>,<span class="number">0x7b</span>,<span class="number">0xbd</span>,<span class="number">0x2d</span>,<span class="number">0x74</span>,<span class="number">0xd0</span>,<span class="number">0x12</span>,<span class="number">0xb8</span>,<span class="number">0xe5</span>,<span class="number">0xb4</span>,<span class="number">0xb0</span>,  </span><br><span class="line">    <span class="number">0x89</span>,<span class="number">0x69</span>,<span class="number">0x97</span>,<span class="number">0x4a</span>,<span class="number">0x0c</span>,<span class="number">0x96</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>,<span class="number">0x65</span>,<span class="number">0xb9</span>,<span class="number">0xf1</span>,<span class="number">0x09</span>,<span class="number">0xc5</span>,<span class="number">0x6e</span>,<span class="number">0xc6</span>,<span class="number">0x84</span>,  </span><br><span class="line">    <span class="number">0x18</span>,<span class="number">0xf0</span>,<span class="number">0x7d</span>,<span class="number">0xec</span>,<span class="number">0x3a</span>,<span class="number">0xdc</span>,<span class="number">0x4d</span>,<span class="number">0x20</span>,<span class="number">0x79</span>,<span class="number">0xee</span>,<span class="number">0x5f</span>,<span class="number">0x3e</span>,<span class="number">0xd7</span>,<span class="number">0xcb</span>,<span class="number">0x39</span>,<span class="number">0x48</span>  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//CK为固定参数 </span></span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">int</span> CK[<span class="number">32</span>] = &#123;  </span><br><span class="line">    <span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>,  </span><br><span class="line">    <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,  </span><br><span class="line">    <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>,  </span><br><span class="line">    <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,  </span><br><span class="line">    <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>,  </span><br><span class="line">    <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,  </span><br><span class="line">    <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>,  </span><br><span class="line">    <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span> &#125;;</span><br><span class="line"><span class="comment">//FK为系统参数 </span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">long</span> FK[<span class="number">4</span>] = &#123;<span class="number">0xa3b1bac6</span>,<span class="number">0x56aa3350</span>,<span class="number">0x677d9197</span>,<span class="number">0xb27022dc</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> <span class="title">sm4Sbox</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> inch)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *pTable = (<span class="type">unsigned</span> <span class="type">char</span> *)Sbox;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> retVal = (<span class="type">unsigned</span> <span class="type">char</span>)(pTable[inch]);</span><br><span class="line">    <span class="keyword">return</span> retVal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//已知加密密钥MK，求轮转密钥rk</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="title">sm4CaliRk</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> ka)</span></span>&#123; <span class="comment">//复合变换T</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> bb = <span class="number">0</span>; <span class="comment">//unsigned long 4字节( 32bit ) </span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> rk = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> b[<span class="number">4</span>];</span><br><span class="line">	<span class="built_in">PUT_ULONG_BE</span>(ka,a,<span class="number">0</span>)  <span class="comment">//换转成8bit一个字符 </span></span><br><span class="line">	b[<span class="number">0</span>] = <span class="built_in">sm4Sbox</span>(a[<span class="number">0</span>]);</span><br><span class="line">    b[<span class="number">1</span>] = <span class="built_in">sm4Sbox</span>(a[<span class="number">1</span>]);</span><br><span class="line">    b[<span class="number">2</span>] = <span class="built_in">sm4Sbox</span>(a[<span class="number">2</span>]);</span><br><span class="line">    b[<span class="number">3</span>] = <span class="built_in">sm4Sbox</span>(a[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">GET_ULONG_BE</span>(bb,b,<span class="number">0</span>)  <span class="comment">//将变换结果转换为32bit的整数</span></span><br><span class="line">	<span class="comment">//对得到的32位整数bb进行线性变换	</span></span><br><span class="line">	rk = bb^<span class="built_in">ROTL</span>(bb,<span class="number">13</span>)^<span class="built_in">ROTL</span>(bb,<span class="number">23</span>);</span><br><span class="line">	<span class="keyword">return</span> rk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">sm4_setkey</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> SK[<span class="number">32</span>],<span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> MK[<span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> k[<span class="number">36</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">GET_ULONG_BE</span>(MK[<span class="number">0</span>],key,<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">GET_ULONG_BE</span>(MK[<span class="number">1</span>],key,<span class="number">4</span>);</span><br><span class="line">	<span class="built_in">GET_ULONG_BE</span>(MK[<span class="number">2</span>],key,<span class="number">8</span>);</span><br><span class="line">	<span class="built_in">GET_ULONG_BE</span>(MK[<span class="number">3</span>],key,<span class="number">12</span>);</span><br><span class="line">	k[<span class="number">0</span>] = MK[<span class="number">0</span>]^FK[<span class="number">0</span>];</span><br><span class="line">	k[<span class="number">1</span>] = MK[<span class="number">1</span>]^FK[<span class="number">1</span>];</span><br><span class="line">	k[<span class="number">2</span>] = MK[<span class="number">2</span>]^FK[<span class="number">2</span>];</span><br><span class="line">	k[<span class="number">3</span>] = MK[<span class="number">3</span>]^FK[<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">for</span>(;i&lt;<span class="number">32</span>;i++)&#123;</span><br><span class="line">		k[i+<span class="number">4</span>] = k[i]^<span class="built_in">sm4CaliRk</span>(k[i+<span class="number">1</span>]^k[i+<span class="number">2</span>]^k[i+<span class="number">3</span>]^CK[i]);</span><br><span class="line">		SK[i] = k[i+<span class="number">4</span>];</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_setkey_enc</span><span class="params">(sm4_context *ctx,<span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span></span>&#123;</span><br><span class="line">	ctx-&gt;mode = SM4_ENCRYPT;</span><br><span class="line">	<span class="built_in">sm4_setkey</span>(ctx-&gt;sk,key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="title">sm4Lt</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> ka)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> bb = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">4</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> b[<span class="number">4</span>];</span><br><span class="line">    <span class="built_in">PUT_ULONG_BE</span>(ka,a,<span class="number">0</span>)</span><br><span class="line"><span class="comment">//    b[0] = sm4Sbox(a[0]);</span></span><br><span class="line"><span class="comment">//    b[1] = sm4Sbox(a[1]);</span></span><br><span class="line"><span class="comment">//    b[2] = sm4Sbox(a[2]);</span></span><br><span class="line"><span class="comment">//    b[3] = sm4Sbox(a[3]);</span></span><br><span class="line">    b[<span class="number">0</span>] = Sbox[a[<span class="number">0</span>]];</span><br><span class="line">    b[<span class="number">1</span>] = Sbox[a[<span class="number">1</span>]];</span><br><span class="line">    b[<span class="number">2</span>] = Sbox[a[<span class="number">2</span>]];</span><br><span class="line">    b[<span class="number">3</span>] = Sbox[a[<span class="number">3</span>]];</span><br><span class="line">    <span class="built_in">GET_ULONG_BE</span>(bb,b,<span class="number">0</span>)</span><br><span class="line">    c =bb^(<span class="built_in">ROTL</span>(bb, <span class="number">2</span>))^(<span class="built_in">ROTL</span>(bb, <span class="number">10</span>))^(<span class="built_in">ROTL</span>(bb, <span class="number">18</span>))^(<span class="built_in">ROTL</span>(bb, <span class="number">24</span>));</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//一轮加密 </span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="title">sm4F</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> x0, <span class="type">unsigned</span> <span class="type">long</span> x1, <span class="type">unsigned</span> <span class="type">long</span> x2, <span class="type">unsigned</span> <span class="type">long</span> x3, <span class="type">unsigned</span> <span class="type">long</span> rk)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x0^<span class="built_in">sm4Lt</span>(x1^x2^x3^rk));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">sm4_one_round</span><span class="params">( <span class="type">unsigned</span> <span class="type">long</span> sk[<span class="number">32</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">16</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">16</span>] )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> ulbuf[<span class="number">36</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(ulbuf, <span class="number">0</span>, <span class="built_in">sizeof</span>(ulbuf));</span><br><span class="line">    <span class="built_in">GET_ULONG_BE</span>( ulbuf[<span class="number">0</span>], input, <span class="number">0</span> )</span><br><span class="line">    <span class="built_in">GET_ULONG_BE</span>( ulbuf[<span class="number">1</span>], input, <span class="number">4</span> )</span><br><span class="line">    <span class="built_in">GET_ULONG_BE</span>( ulbuf[<span class="number">2</span>], input, <span class="number">8</span> )</span><br><span class="line">    <span class="built_in">GET_ULONG_BE</span>( ulbuf[<span class="number">3</span>], input, <span class="number">12</span> )</span><br><span class="line">    <span class="keyword">while</span>(i&lt;<span class="number">32</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ulbuf[i+<span class="number">4</span>] = <span class="built_in">sm4F</span>(ulbuf[i], ulbuf[i+<span class="number">1</span>], ulbuf[i+<span class="number">2</span>], ulbuf[i+<span class="number">3</span>], sk[i]);</span><br><span class="line"><span class="comment">// #ifdef _DEBUG</span></span><br><span class="line"><span class="comment">//          printf(&quot;rk(%02d) = 0x%08x,  X(%02d) = 0x%08x \n&quot;,i,sk[i], i, ulbuf[i+4] );</span></span><br><span class="line"><span class="comment">// #endif</span></span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">PUT_ULONG_BE</span>(ulbuf[<span class="number">35</span>],output,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">PUT_ULONG_BE</span>(ulbuf[<span class="number">34</span>],output,<span class="number">4</span>);</span><br><span class="line">    <span class="built_in">PUT_ULONG_BE</span>(ulbuf[<span class="number">33</span>],output,<span class="number">8</span>);</span><br><span class="line">    <span class="built_in">PUT_ULONG_BE</span>(ulbuf[<span class="number">32</span>],output,<span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ECB模式 </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_crypt_ecb</span><span class="params">( sm4_context *ctx,</span></span></span><br><span class="line"><span class="params"><span class="function">				   <span class="type">int</span> mode,</span></span></span><br><span class="line"><span class="params"><span class="function">				   <span class="type">int</span> length,</span></span></span><br><span class="line"><span class="params"><span class="function">				   <span class="type">unsigned</span> <span class="type">char</span> *input,</span></span></span><br><span class="line"><span class="params"><span class="function">                   <span class="type">unsigned</span> <span class="type">char</span> *output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>( length &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sm4_one_round</span>( ctx-&gt;sk, input, output );</span><br><span class="line">        input  += <span class="number">16</span>;</span><br><span class="line">        output += <span class="number">16</span>;</span><br><span class="line">        length -= <span class="number">16</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ECB模式解密密钥 </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_setkey_dec</span><span class="params">( sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>] )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">	ctx-&gt;mode = SM4_ENCRYPT;</span><br><span class="line">    <span class="built_in">sm4_setkey</span>( ctx-&gt;sk, key );</span><br><span class="line">    <span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">SWAP</span>( ctx-&gt;sk[ i ], ctx-&gt;sk[ <span class="number">31</span>-i] );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//CBC模式加解密 </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sm4_crypt_cbc</span><span class="params">( sm4_context *ctx,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">int</span> mode,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">int</span> length,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">unsigned</span> <span class="type">char</span> iv[<span class="number">16</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">unsigned</span> <span class="type">char</span> *input,</span></span></span><br><span class="line"><span class="params"><span class="function">                    <span class="type">unsigned</span> <span class="type">char</span> *output )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">16</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>( mode == SM4_ENCRYPT )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>( length &gt; <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++ )</span><br><span class="line">                output[i] = (<span class="type">unsigned</span> <span class="type">char</span>)( input[i] ^ iv[i] );</span><br><span class="line"> </span><br><span class="line">            <span class="built_in">sm4_one_round</span>( ctx-&gt;sk, output, output );</span><br><span class="line">            <span class="built_in">memcpy</span>( iv, output, <span class="number">16</span> );</span><br><span class="line"> </span><br><span class="line">            input  += <span class="number">16</span>;</span><br><span class="line">            output += <span class="number">16</span>;</span><br><span class="line">            length -= <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="comment">/* SM4_DECRYPT */</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>( length &gt; <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>( temp, input, <span class="number">16</span> );</span><br><span class="line">            <span class="built_in">sm4_one_round</span>( ctx-&gt;sk, input, output );</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++ )</span><br><span class="line">                output[i] = (<span class="type">unsigned</span> <span class="type">char</span>)( output[i] ^ iv[i] );</span><br><span class="line"> </span><br><span class="line">            <span class="built_in">memcpy</span>( iv, temp, <span class="number">16</span> );</span><br><span class="line"> </span><br><span class="line">            input  += <span class="number">16</span>;</span><br><span class="line">            output += <span class="number">16</span>;</span><br><span class="line">            length -= <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>] = &#123;<span class="number">0x01</span>,<span class="number">0x23</span>,<span class="number">0x45</span>,<span class="number">0x67</span>,<span class="number">0x89</span>,<span class="number">0xab</span>,<span class="number">0xcd</span>,<span class="number">0xef</span>,<span class="number">0xfe</span>,<span class="number">0xdc</span>,<span class="number">0xba</span>,<span class="number">0x98</span>,<span class="number">0x76</span>,<span class="number">0x54</span>,<span class="number">0x32</span>,<span class="number">0x10</span>&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">16</span>] = &#123;<span class="number">0x01</span>,<span class="number">0x23</span>,<span class="number">0x45</span>,<span class="number">0x67</span>,<span class="number">0x89</span>,<span class="number">0xab</span>,<span class="number">0xcd</span>,<span class="number">0xef</span>,<span class="number">0xfe</span>,<span class="number">0xdc</span>,<span class="number">0xba</span>,<span class="number">0x98</span>,<span class="number">0x76</span>,<span class="number">0x54</span>,<span class="number">0x32</span>,<span class="number">0x10</span>&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">16</span>];</span><br><span class="line">	sm4_context ctx;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> i;</span><br><span class="line">	<span class="comment">//encrypt</span></span><br><span class="line">	<span class="built_in">sm4_setkey_enc</span>(&amp;ctx,key);</span><br><span class="line">	<span class="built_in">sm4_crypt_ecb</span>(&amp;ctx,<span class="number">1</span>,<span class="number">16</span>,input,output);</span><br><span class="line">	<span class="comment">//加密结果 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;encrypt：\n&quot;</span>); </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>;i&lt; <span class="number">16</span>;i ++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>,output[i]);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="built_in">sm4_setkey_dec</span>(&amp;ctx,key);</span><br><span class="line">	<span class="built_in">sm4_crypt_ecb</span>(&amp;ctx,<span class="number">0</span>,<span class="number">16</span>,output,output);</span><br><span class="line">	<span class="comment">//解密结果 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;decrypt：\n&quot;</span>); </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>;i&lt; <span class="number">16</span>;i ++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>,output[i]);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>两个文件放在同一目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ -o sm4 sm4.cpp</span><br></pre></td></tr></table></figure>



<h3 id="BlowFish"><a href="#BlowFish" class="headerlink" title="BlowFish"></a>BlowFish</h3><p> <strong>BlowFish</strong> 是一个对称加密的加密算法。由<strong>Bruce Schneier</strong>，1993年设计的。是一个免费自由使用的加密算法。</p>
<ul>
<li>BlowFish是一个对称区块加密算法。每次加密数据为 <strong>64位</strong> （8 Byte)</li>
<li>BlowFish 密钥采用32-448位(密钥可以是动态长度)</li>
<li>BlowFish是由一个16轮循环的Feistel结构进行加密的。</li>
</ul>
<p>总结：就是将一个数 拆分为 左右各32位数值 （也就是 8个字节 左边四个字节，右边四个字节），然后左边进行 ^ key_pbox 当作下一次循环的右边。 右边则是 右边 ^ F(左边) 下次当作循环的左边。</p>
<img src="/2024/03/03/encrypt-reverse/1197364-20210614225109286-1752341738.png" class="" title="img">

<h4 id="算法原理-1"><a href="#算法原理-1" class="headerlink" title="算法原理"></a>算法原理</h4><h5 id="子密钥生成-1"><a href="#子密钥生成-1" class="headerlink" title="子密钥生成"></a>子密钥生成</h5><p>子密钥生成使用了由18个32位字组成的<strong>P数组</strong>，就是要将我们的<strong>Key</strong> 与 <strong>pbox</strong>进行 异或</p>
<p>4个8*32的包含1024个32位字的S-box</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> P[<span class="number">18</span>];</span><br><span class="line"><span class="type">uint32_t</span> S[<span class="number">4</span>][<span class="number">256</span>];</span><br></pre></td></tr></table></figure>

<p><strong>步骤：</strong></p>
<p>1.按顺序使用常数Π的小数部分初始化P数组和S-box</p>
<p>2.对P数组和密钥进行逐位异或，必要时重用密钥</p>
<p>3.使用当前的P数组和S-box对全0的64位分组使用BlowFish算法进行加密，用输出代替P[1]、P[2]</p>
<p>4.重复以上步骤使用当前的P数组和S-box对上一步输出进行加密，并用输出代替P[3]、P[4]，直到按顺序替代所有的P数组和S-box中的元素为止</p>
<h5 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h5><p>f函数输入是一个32位双字，共4个字节，分别作为4个S-box的索引，取出相应的S-box的值然后进行模2^32加运算</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">F</span>(x) = <span class="built_in">F</span>(a, b, c, d) = ((S1[a] + S2[b]) ^ S3[c]) + S4[d]</span><br><span class="line"><span class="comment">// x = a &lt;&lt; 24 + b &lt;&lt; 16 + c &lt;&lt; 8 + d</span></span><br></pre></td></tr></table></figure>

<p>加密是由16轮的Feistel网络组成</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span> <span class="params">(<span class="type">uint32_t</span> &amp; L, <span class="type">uint32_t</span> &amp; R)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span> ; i&lt;<span class="number">16</span> ; i += <span class="number">2</span>) &#123;</span><br><span class="line">      L ^= P[i];</span><br><span class="line">      R ^= <span class="built_in">f</span>(L);</span><br><span class="line">      R ^= P[i+<span class="number">1</span>];</span><br><span class="line">      L ^= <span class="built_in">f</span>(R);</span><br><span class="line">   &#125;</span><br><span class="line">   L ^= P[<span class="number">16</span>];</span><br><span class="line">   R ^= P[<span class="number">17</span>];</span><br><span class="line">   <span class="built_in">swap</span> (L, R);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h5><p>解密方法与加密方法相同，只是P数组要逆序使用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span> &amp; L, <span class="type">uint32_t</span> &amp; R)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">16</span> ; i &gt; <span class="number">0</span> ; i -= <span class="number">2</span>) &#123;</span><br><span class="line">      L ^= P[i+<span class="number">1</span>];</span><br><span class="line">      R ^= <span class="built_in">f</span>(L);</span><br><span class="line">      R ^= P[i];</span><br><span class="line">      L ^= <span class="built_in">f</span>(R);</span><br><span class="line">   &#125;</span><br><span class="line">   L ^= P[<span class="number">1</span>];</span><br><span class="line">   R ^= P[<span class="number">0</span>];</span><br><span class="line">   <span class="built_in">swap</span> (L, R);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="脚本-6"><a href="#脚本-6" class="headerlink" title="脚本"></a>脚本</h4><p>目前只找到这个，具体怎么样把明文分割为l和r有待研究</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">// P array</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> P[<span class="number">18</span>] = &#123;<span class="number">0x243F6A88</span>L, <span class="number">0x85A308D3</span>L, <span class="number">0x13198A2E</span>L, <span class="number">0x03707344</span>L,</span><br><span class="line">                      <span class="number">0xA4093822</span>L, <span class="number">0x299F31D0</span>L, <span class="number">0x082EFA98</span>L, <span class="number">0xEC4E6C89</span>L,</span><br><span class="line">                      <span class="number">0x452821E6</span>L, <span class="number">0x38D01377</span>L, <span class="number">0xBE5466CF</span>L, <span class="number">0x34E90C6C</span>L,</span><br><span class="line">                      <span class="number">0xC0AC29B7</span>L, <span class="number">0xC97C50DD</span>L, <span class="number">0x3F84D5B5</span>L, <span class="number">0xB5470917</span>L,</span><br><span class="line">                      <span class="number">0x9216D5D9</span>L, <span class="number">0x8979FB1B</span>L&#125;;</span><br><span class="line"><span class="comment">// S-box</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> S[<span class="number">4</span>][<span class="number">256</span>] = &#123;</span><br><span class="line">    &#123;<span class="number">0xD1310BA6</span>L, <span class="number">0x98DFB5AC</span>L, <span class="number">0x2FFD72DB</span>L, <span class="number">0xD01ADFB7</span>L, <span class="number">0xB8E1AFED</span>L,</span><br><span class="line">     <span class="number">0x6A267E96</span>L, <span class="number">0xBA7C9045</span>L, <span class="number">0xF12C7F99</span>L, <span class="number">0x24A19947</span>L, <span class="number">0xB3916CF7</span>L,</span><br><span class="line">     <span class="number">0x0801F2E2</span>L, <span class="number">0x858EFC16</span>L, <span class="number">0x636920D8</span>L, <span class="number">0x71574E69</span>L, <span class="number">0xA458FEA3</span>L,</span><br><span class="line">     <span class="number">0xF4933D7E</span>L, <span class="number">0x0D95748F</span>L, <span class="number">0x728EB658</span>L, <span class="number">0x718BCD58</span>L, <span class="number">0x82154AEE</span>L,</span><br><span class="line">     <span class="number">0x7B54A41D</span>L, <span class="number">0xC25A59B5</span>L, <span class="number">0x9C30D539</span>L, <span class="number">0x2AF26013</span>L, <span class="number">0xC5D1B023</span>L,</span><br><span class="line">     <span class="number">0x286085F0</span>L, <span class="number">0xCA417918</span>L, <span class="number">0xB8DB38EF</span>L, <span class="number">0x8E79DCB0</span>L, <span class="number">0x603A180E</span>L,</span><br><span class="line">     <span class="number">0x6C9E0E8B</span>L, <span class="number">0xB01E8A3E</span>L, <span class="number">0xD71577C1</span>L, <span class="number">0xBD314B27</span>L, <span class="number">0x78AF2FDA</span>L,</span><br><span class="line">     <span class="number">0x55605C60</span>L, <span class="number">0xE65525F3</span>L, <span class="number">0xAA55AB94</span>L, <span class="number">0x57489862</span>L, <span class="number">0x63E81440</span>L,</span><br><span class="line">     <span class="number">0x55CA396A</span>L, <span class="number">0x2AAB10B6</span>L, <span class="number">0xB4CC5C34</span>L, <span class="number">0x1141E8CE</span>L, <span class="number">0xA15486AF</span>L,</span><br><span class="line">     <span class="number">0x7C72E993</span>L, <span class="number">0xB3EE1411</span>L, <span class="number">0x636FBC2A</span>L, <span class="number">0x2BA9C55D</span>L, <span class="number">0x741831F6</span>L,</span><br><span class="line">     <span class="number">0xCE5C3E16</span>L, <span class="number">0x9B87931E</span>L, <span class="number">0xAFD6BA33</span>L, <span class="number">0x6C24CF5C</span>L, <span class="number">0x7A325381</span>L,</span><br><span class="line">     <span class="number">0x28958677</span>L, <span class="number">0x3B8F4898</span>L, <span class="number">0x6B4BB9AF</span>L, <span class="number">0xC4BFE81B</span>L, <span class="number">0x66282193</span>L,</span><br><span class="line">     <span class="number">0x61D809CC</span>L, <span class="number">0xFB21A991</span>L, <span class="number">0x487CAC60</span>L, <span class="number">0x5DEC8032</span>L, <span class="number">0xEF845D5D</span>L,</span><br><span class="line">     <span class="number">0xE98575B1</span>L, <span class="number">0xDC262302</span>L, <span class="number">0xEB651B88</span>L, <span class="number">0x23893E81</span>L, <span class="number">0xD396ACC5</span>L,</span><br><span class="line">     <span class="number">0x0F6D6FF3</span>L, <span class="number">0x83F44239</span>L, <span class="number">0x2E0B4482</span>L, <span class="number">0xA4842004</span>L, <span class="number">0x69C8F04A</span>L,</span><br><span class="line">     <span class="number">0x9E1F9B5E</span>L, <span class="number">0x21C66842</span>L, <span class="number">0xF6E96C9A</span>L, <span class="number">0x670C9C61</span>L, <span class="number">0xABD388F0</span>L,</span><br><span class="line">     <span class="number">0x6A51A0D2</span>L, <span class="number">0xD8542F68</span>L, <span class="number">0x960FA728</span>L, <span class="number">0xAB5133A3</span>L, <span class="number">0x6EEF0B6C</span>L,</span><br><span class="line">     <span class="number">0x137A3BE4</span>L, <span class="number">0xBA3BF050</span>L, <span class="number">0x7EFB2A98</span>L, <span class="number">0xA1F1651D</span>L, <span class="number">0x39AF0176</span>L,</span><br><span class="line">     <span class="number">0x66CA593E</span>L, <span class="number">0x82430E88</span>L, <span class="number">0x8CEE8619</span>L, <span class="number">0x456F9FB4</span>L, <span class="number">0x7D84A5C3</span>L,</span><br><span class="line">     <span class="number">0x3B8B5EBE</span>L, <span class="number">0xE06F75D8</span>L, <span class="number">0x85C12073</span>L, <span class="number">0x401A449F</span>L, <span class="number">0x56C16AA6</span>L,</span><br><span class="line">     <span class="number">0x4ED3AA62</span>L, <span class="number">0x363F7706</span>L, <span class="number">0x1BFEDF72</span>L, <span class="number">0x429B023D</span>L, <span class="number">0x37D0D724</span>L,</span><br><span class="line">     <span class="number">0xD00A1248</span>L, <span class="number">0xDB0FEAD3</span>L, <span class="number">0x49F1C09B</span>L, <span class="number">0x075372C9</span>L, <span class="number">0x80991B7B</span>L,</span><br><span class="line">     <span class="number">0x25D479D8</span>L, <span class="number">0xF6E8DEF7</span>L, <span class="number">0xE3FE501A</span>L, <span class="number">0xB6794C3B</span>L, <span class="number">0x976CE0BD</span>L,</span><br><span class="line">     <span class="number">0x04C006BA</span>L, <span class="number">0xC1A94FB6</span>L, <span class="number">0x409F60C4</span>L, <span class="number">0x5E5C9EC2</span>L, <span class="number">0x196A2463</span>L,</span><br><span class="line">     <span class="number">0x68FB6FAF</span>L, <span class="number">0x3E6C53B5</span>L, <span class="number">0x1339B2EB</span>L, <span class="number">0x3B52EC6F</span>L, <span class="number">0x6DFC511F</span>L,</span><br><span class="line">     <span class="number">0x9B30952C</span>L, <span class="number">0xCC814544</span>L, <span class="number">0xAF5EBD09</span>L, <span class="number">0xBEE3D004</span>L, <span class="number">0xDE334AFD</span>L,</span><br><span class="line">     <span class="number">0x660F2807</span>L, <span class="number">0x192E4BB3</span>L, <span class="number">0xC0CBA857</span>L, <span class="number">0x45C8740F</span>L, <span class="number">0xD20B5F39</span>L,</span><br><span class="line">     <span class="number">0xB9D3FBDB</span>L, <span class="number">0x5579C0BD</span>L, <span class="number">0x1A60320A</span>L, <span class="number">0xD6A100C6</span>L, <span class="number">0x402C7279</span>L,</span><br><span class="line">     <span class="number">0x679F25FE</span>L, <span class="number">0xFB1FA3CC</span>L, <span class="number">0x8EA5E9F8</span>L, <span class="number">0xDB3222F8</span>L, <span class="number">0x3C7516DF</span>L,</span><br><span class="line">     <span class="number">0xFD616B15</span>L, <span class="number">0x2F501EC8</span>L, <span class="number">0xAD0552AB</span>L, <span class="number">0x323DB5FA</span>L, <span class="number">0xFD238760</span>L,</span><br><span class="line">     <span class="number">0x53317B48</span>L, <span class="number">0x3E00DF82</span>L, <span class="number">0x9E5C57BB</span>L, <span class="number">0xCA6F8CA0</span>L, <span class="number">0x1A87562E</span>L,</span><br><span class="line">     <span class="number">0xDF1769DB</span>L, <span class="number">0xD542A8F6</span>L, <span class="number">0x287EFFC3</span>L, <span class="number">0xAC6732C6</span>L, <span class="number">0x8C4F5573</span>L,</span><br><span class="line">     <span class="number">0x695B27B0</span>L, <span class="number">0xBBCA58C8</span>L, <span class="number">0xE1FFA35D</span>L, <span class="number">0xB8F011A0</span>L, <span class="number">0x10FA3D98</span>L,</span><br><span class="line">     <span class="number">0xFD2183B8</span>L, <span class="number">0x4AFCB56C</span>L, <span class="number">0x2DD1D35B</span>L, <span class="number">0x9A53E479</span>L, <span class="number">0xB6F84565</span>L,</span><br><span class="line">     <span class="number">0xD28E49BC</span>L, <span class="number">0x4BFB9790</span>L, <span class="number">0xE1DDF2DA</span>L, <span class="number">0xA4CB7E33</span>L, <span class="number">0x62FB1341</span>L,</span><br><span class="line">     <span class="number">0xCEE4C6E8</span>L, <span class="number">0xEF20CADA</span>L, <span class="number">0x36774C01</span>L, <span class="number">0xD07E9EFE</span>L, <span class="number">0x2BF11FB4</span>L,</span><br><span class="line">     <span class="number">0x95DBDA4D</span>L, <span class="number">0xAE909198</span>L, <span class="number">0xEAAD8E71</span>L, <span class="number">0x6B93D5A0</span>L, <span class="number">0xD08ED1D0</span>L,</span><br><span class="line">     <span class="number">0xAFC725E0</span>L, <span class="number">0x8E3C5B2F</span>L, <span class="number">0x8E7594B7</span>L, <span class="number">0x8FF6E2FB</span>L, <span class="number">0xF2122B64</span>L,</span><br><span class="line">     <span class="number">0x8888B812</span>L, <span class="number">0x900DF01C</span>L, <span class="number">0x4FAD5EA0</span>L, <span class="number">0x688FC31C</span>L, <span class="number">0xD1CFF191</span>L,</span><br><span class="line">     <span class="number">0xB3A8C1AD</span>L, <span class="number">0x2F2F2218</span>L, <span class="number">0xBE0E1777</span>L, <span class="number">0xEA752DFE</span>L, <span class="number">0x8B021FA1</span>L,</span><br><span class="line">     <span class="number">0xE5A0CC0F</span>L, <span class="number">0xB56F74E8</span>L, <span class="number">0x18ACF3D6</span>L, <span class="number">0xCE89E299</span>L, <span class="number">0xB4A84FE0</span>L,</span><br><span class="line">     <span class="number">0xFD13E0B7</span>L, <span class="number">0x7CC43B81</span>L, <span class="number">0xD2ADA8D9</span>L, <span class="number">0x165FA266</span>L, <span class="number">0x80957705</span>L,</span><br><span class="line">     <span class="number">0x93CC7314</span>L, <span class="number">0x211A1477</span>L, <span class="number">0xE6AD2065</span>L, <span class="number">0x77B5FA86</span>L, <span class="number">0xC75442F5</span>L,</span><br><span class="line">     <span class="number">0xFB9D35CF</span>L, <span class="number">0xEBCDAF0C</span>L, <span class="number">0x7B3E89A0</span>L, <span class="number">0xD6411BD3</span>L, <span class="number">0xAE1E7E49</span>L,</span><br><span class="line">     <span class="number">0x00250E2D</span>L, <span class="number">0x2071B35E</span>L, <span class="number">0x226800BB</span>L, <span class="number">0x57B8E0AF</span>L, <span class="number">0x2464369B</span>L,</span><br><span class="line">     <span class="number">0xF009B91E</span>L, <span class="number">0x5563911D</span>L, <span class="number">0x59DFA6AA</span>L, <span class="number">0x78C14389</span>L, <span class="number">0xD95A537F</span>L,</span><br><span class="line">     <span class="number">0x207D5BA2</span>L, <span class="number">0x02E5B9C5</span>L, <span class="number">0x83260376</span>L, <span class="number">0x6295CFA9</span>L, <span class="number">0x11C81968</span>L,</span><br><span class="line">     <span class="number">0x4E734A41</span>L, <span class="number">0xB3472DCA</span>L, <span class="number">0x7B14A94A</span>L, <span class="number">0x1B510052</span>L, <span class="number">0x9A532915</span>L,</span><br><span class="line">     <span class="number">0xD60F573F</span>L, <span class="number">0xBC9BC6E4</span>L, <span class="number">0x2B60A476</span>L, <span class="number">0x81E67400</span>L, <span class="number">0x08BA6FB5</span>L,</span><br><span class="line">     <span class="number">0x571BE91F</span>L, <span class="number">0xF296EC6B</span>L, <span class="number">0x2A0DD915</span>L, <span class="number">0xB6636521</span>L, <span class="number">0xE7B9F9B6</span>L,</span><br><span class="line">     <span class="number">0xFF34052E</span>L, <span class="number">0xC5855664</span>L, <span class="number">0x53B02D5D</span>L, <span class="number">0xA99F8FA1</span>L, <span class="number">0x08BA4799</span>L,</span><br><span class="line">     <span class="number">0x6E85076A</span>L&#125;,</span><br><span class="line">    &#123;<span class="number">0x4B7A70E9</span>L, <span class="number">0xB5B32944</span>L, <span class="number">0xDB75092E</span>L, <span class="number">0xC4192623</span>L, <span class="number">0xAD6EA6B0</span>L,</span><br><span class="line">     <span class="number">0x49A7DF7D</span>L, <span class="number">0x9CEE60B8</span>L, <span class="number">0x8FEDB266</span>L, <span class="number">0xECAA8C71</span>L, <span class="number">0x699A17FF</span>L,</span><br><span class="line">     <span class="number">0x5664526C</span>L, <span class="number">0xC2B19EE1</span>L, <span class="number">0x193602A5</span>L, <span class="number">0x75094C29</span>L, <span class="number">0xA0591340</span>L,</span><br><span class="line">     <span class="number">0xE4183A3E</span>L, <span class="number">0x3F54989A</span>L, <span class="number">0x5B429D65</span>L, <span class="number">0x6B8FE4D6</span>L, <span class="number">0x99F73FD6</span>L,</span><br><span class="line">     <span class="number">0xA1D29C07</span>L, <span class="number">0xEFE830F5</span>L, <span class="number">0x4D2D38E6</span>L, <span class="number">0xF0255DC1</span>L, <span class="number">0x4CDD2086</span>L,</span><br><span class="line">     <span class="number">0x8470EB26</span>L, <span class="number">0x6382E9C6</span>L, <span class="number">0x021ECC5E</span>L, <span class="number">0x09686B3F</span>L, <span class="number">0x3EBAEFC9</span>L,</span><br><span class="line">     <span class="number">0x3C971814</span>L, <span class="number">0x6B6A70A1</span>L, <span class="number">0x687F3584</span>L, <span class="number">0x52A0E286</span>L, <span class="number">0xB79C5305</span>L,</span><br><span class="line">     <span class="number">0xAA500737</span>L, <span class="number">0x3E07841C</span>L, <span class="number">0x7FDEAE5C</span>L, <span class="number">0x8E7D44EC</span>L, <span class="number">0x5716F2B8</span>L,</span><br><span class="line">     <span class="number">0xB03ADA37</span>L, <span class="number">0xF0500C0D</span>L, <span class="number">0xF01C1F04</span>L, <span class="number">0x0200B3FF</span>L, <span class="number">0xAE0CF51A</span>L,</span><br><span class="line">     <span class="number">0x3CB574B2</span>L, <span class="number">0x25837A58</span>L, <span class="number">0xDC0921BD</span>L, <span class="number">0xD19113F9</span>L, <span class="number">0x7CA92FF6</span>L,</span><br><span class="line">     <span class="number">0x94324773</span>L, <span class="number">0x22F54701</span>L, <span class="number">0x3AE5E581</span>L, <span class="number">0x37C2DADC</span>L, <span class="number">0xC8B57634</span>L,</span><br><span class="line">     <span class="number">0x9AF3DDA7</span>L, <span class="number">0xA9446146</span>L, <span class="number">0x0FD0030E</span>L, <span class="number">0xECC8C73E</span>L, <span class="number">0xA4751E41</span>L,</span><br><span class="line">     <span class="number">0xE238CD99</span>L, <span class="number">0x3BEA0E2F</span>L, <span class="number">0x3280BBA1</span>L, <span class="number">0x183EB331</span>L, <span class="number">0x4E548B38</span>L,</span><br><span class="line">     <span class="number">0x4F6DB908</span>L, <span class="number">0x6F420D03</span>L, <span class="number">0xF60A04BF</span>L, <span class="number">0x2CB81290</span>L, <span class="number">0x24977C79</span>L,</span><br><span class="line">     <span class="number">0x5679B072</span>L, <span class="number">0xBCAF89AF</span>L, <span class="number">0xDE9A771F</span>L, <span class="number">0xD9930810</span>L, <span class="number">0xB38BAE12</span>L,</span><br><span class="line">     <span class="number">0xDCCF3F2E</span>L, <span class="number">0x5512721F</span>L, <span class="number">0x2E6B7124</span>L, <span class="number">0x501ADDE6</span>L, <span class="number">0x9F84CD87</span>L,</span><br><span class="line">     <span class="number">0x7A584718</span>L, <span class="number">0x7408DA17</span>L, <span class="number">0xBC9F9ABC</span>L, <span class="number">0xE94B7D8C</span>L, <span class="number">0xEC7AEC3A</span>L,</span><br><span class="line">     <span class="number">0xDB851DFA</span>L, <span class="number">0x63094366</span>L, <span class="number">0xC464C3D2</span>L, <span class="number">0xEF1C1847</span>L, <span class="number">0x3215D908</span>L,</span><br><span class="line">     <span class="number">0xDD433B37</span>L, <span class="number">0x24C2BA16</span>L, <span class="number">0x12A14D43</span>L, <span class="number">0x2A65C451</span>L, <span class="number">0x50940002</span>L,</span><br><span class="line">     <span class="number">0x133AE4DD</span>L, <span class="number">0x71DFF89E</span>L, <span class="number">0x10314E55</span>L, <span class="number">0x81AC77D6</span>L, <span class="number">0x5F11199B</span>L,</span><br><span class="line">     <span class="number">0x043556F1</span>L, <span class="number">0xD7A3C76B</span>L, <span class="number">0x3C11183B</span>L, <span class="number">0x5924A509</span>L, <span class="number">0xF28FE6ED</span>L,</span><br><span class="line">     <span class="number">0x97F1FBFA</span>L, <span class="number">0x9EBABF2C</span>L, <span class="number">0x1E153C6E</span>L, <span class="number">0x86E34570</span>L, <span class="number">0xEAE96FB1</span>L,</span><br><span class="line">     <span class="number">0x860E5E0A</span>L, <span class="number">0x5A3E2AB3</span>L, <span class="number">0x771FE71C</span>L, <span class="number">0x4E3D06FA</span>L, <span class="number">0x2965DCB9</span>L,</span><br><span class="line">     <span class="number">0x99E71D0F</span>L, <span class="number">0x803E89D6</span>L, <span class="number">0x5266C825</span>L, <span class="number">0x2E4CC978</span>L, <span class="number">0x9C10B36A</span>L,</span><br><span class="line">     <span class="number">0xC6150EBA</span>L, <span class="number">0x94E2EA78</span>L, <span class="number">0xA5FC3C53</span>L, <span class="number">0x1E0A2DF4</span>L, <span class="number">0xF2F74EA7</span>L,</span><br><span class="line">     <span class="number">0x361D2B3D</span>L, <span class="number">0x1939260F</span>L, <span class="number">0x19C27960</span>L, <span class="number">0x5223A708</span>L, <span class="number">0xF71312B6</span>L,</span><br><span class="line">     <span class="number">0xEBADFE6E</span>L, <span class="number">0xEAC31F66</span>L, <span class="number">0xE3BC4595</span>L, <span class="number">0xA67BC883</span>L, <span class="number">0xB17F37D1</span>L,</span><br><span class="line">     <span class="number">0x018CFF28</span>L, <span class="number">0xC332DDEF</span>L, <span class="number">0xBE6C5AA5</span>L, <span class="number">0x65582185</span>L, <span class="number">0x68AB9802</span>L,</span><br><span class="line">     <span class="number">0xEECEA50F</span>L, <span class="number">0xDB2F953B</span>L, <span class="number">0x2AEF7DAD</span>L, <span class="number">0x5B6E2F84</span>L, <span class="number">0x1521B628</span>L,</span><br><span class="line">     <span class="number">0x29076170</span>L, <span class="number">0xECDD4775</span>L, <span class="number">0x619F1510</span>L, <span class="number">0x13CCA830</span>L, <span class="number">0xEB61BD96</span>L,</span><br><span class="line">     <span class="number">0x0334FE1E</span>L, <span class="number">0xAA0363CF</span>L, <span class="number">0xB5735C90</span>L, <span class="number">0x4C70A239</span>L, <span class="number">0xD59E9E0B</span>L,</span><br><span class="line">     <span class="number">0xCBAADE14</span>L, <span class="number">0xEECC86BC</span>L, <span class="number">0x60622CA7</span>L, <span class="number">0x9CAB5CAB</span>L, <span class="number">0xB2F3846E</span>L,</span><br><span class="line">     <span class="number">0x648B1EAF</span>L, <span class="number">0x19BDF0CA</span>L, <span class="number">0xA02369B9</span>L, <span class="number">0x655ABB50</span>L, <span class="number">0x40685A32</span>L,</span><br><span class="line">     <span class="number">0x3C2AB4B3</span>L, <span class="number">0x319EE9D5</span>L, <span class="number">0xC021B8F7</span>L, <span class="number">0x9B540B19</span>L, <span class="number">0x875FA099</span>L,</span><br><span class="line">     <span class="number">0x95F7997E</span>L, <span class="number">0x623D7DA8</span>L, <span class="number">0xF837889A</span>L, <span class="number">0x97E32D77</span>L, <span class="number">0x11ED935F</span>L,</span><br><span class="line">     <span class="number">0x16681281</span>L, <span class="number">0x0E358829</span>L, <span class="number">0xC7E61FD6</span>L, <span class="number">0x96DEDFA1</span>L, <span class="number">0x7858BA99</span>L,</span><br><span class="line">     <span class="number">0x57F584A5</span>L, <span class="number">0x1B227263</span>L, <span class="number">0x9B83C3FF</span>L, <span class="number">0x1AC24696</span>L, <span class="number">0xCDB30AEB</span>L,</span><br><span class="line">     <span class="number">0x532E3054</span>L, <span class="number">0x8FD948E4</span>L, <span class="number">0x6DBC3128</span>L, <span class="number">0x58EBF2EF</span>L, <span class="number">0x34C6FFEA</span>L,</span><br><span class="line">     <span class="number">0xFE28ED61</span>L, <span class="number">0xEE7C3C73</span>L, <span class="number">0x5D4A14D9</span>L, <span class="number">0xE864B7E3</span>L, <span class="number">0x42105D14</span>L,</span><br><span class="line">     <span class="number">0x203E13E0</span>L, <span class="number">0x45EEE2B6</span>L, <span class="number">0xA3AAABEA</span>L, <span class="number">0xDB6C4F15</span>L, <span class="number">0xFACB4FD0</span>L,</span><br><span class="line">     <span class="number">0xC742F442</span>L, <span class="number">0xEF6ABBB5</span>L, <span class="number">0x654F3B1D</span>L, <span class="number">0x41CD2105</span>L, <span class="number">0xD81E799E</span>L,</span><br><span class="line">     <span class="number">0x86854DC7</span>L, <span class="number">0xE44B476A</span>L, <span class="number">0x3D816250</span>L, <span class="number">0xCF62A1F2</span>L, <span class="number">0x5B8D2646</span>L,</span><br><span class="line">     <span class="number">0xFC8883A0</span>L, <span class="number">0xC1C7B6A3</span>L, <span class="number">0x7F1524C3</span>L, <span class="number">0x69CB7492</span>L, <span class="number">0x47848A0B</span>L,</span><br><span class="line">     <span class="number">0x5692B285</span>L, <span class="number">0x095BBF00</span>L, <span class="number">0xAD19489D</span>L, <span class="number">0x1462B174</span>L, <span class="number">0x23820E00</span>L,</span><br><span class="line">     <span class="number">0x58428D2A</span>L, <span class="number">0x0C55F5EA</span>L, <span class="number">0x1DADF43E</span>L, <span class="number">0x233F7061</span>L, <span class="number">0x3372F092</span>L,</span><br><span class="line">     <span class="number">0x8D937E41</span>L, <span class="number">0xD65FECF1</span>L, <span class="number">0x6C223BDB</span>L, <span class="number">0x7CDE3759</span>L, <span class="number">0xCBEE7460</span>L,</span><br><span class="line">     <span class="number">0x4085F2A7</span>L, <span class="number">0xCE77326E</span>L, <span class="number">0xA6078084</span>L, <span class="number">0x19F8509E</span>L, <span class="number">0xE8EFD855</span>L,</span><br><span class="line">     <span class="number">0x61D99735</span>L, <span class="number">0xA969A7AA</span>L, <span class="number">0xC50C06C2</span>L, <span class="number">0x5A04ABFC</span>L, <span class="number">0x800BCADC</span>L,</span><br><span class="line">     <span class="number">0x9E447A2E</span>L, <span class="number">0xC3453484</span>L, <span class="number">0xFDD56705</span>L, <span class="number">0x0E1E9EC9</span>L, <span class="number">0xDB73DBD3</span>L,</span><br><span class="line">     <span class="number">0x105588CD</span>L, <span class="number">0x675FDA79</span>L, <span class="number">0xE3674340</span>L, <span class="number">0xC5C43465</span>L, <span class="number">0x713E38D8</span>L,</span><br><span class="line">     <span class="number">0x3D28F89E</span>L, <span class="number">0xF16DFF20</span>L, <span class="number">0x153E21E7</span>L, <span class="number">0x8FB03D4A</span>L, <span class="number">0xE6E39F2B</span>L,</span><br><span class="line">     <span class="number">0xDB83ADF7</span>L&#125;,</span><br><span class="line">    &#123;<span class="number">0xE93D5A68</span>L, <span class="number">0x948140F7</span>L, <span class="number">0xF64C261C</span>L, <span class="number">0x94692934</span>L, <span class="number">0x411520F7</span>L,</span><br><span class="line">     <span class="number">0x7602D4F7</span>L, <span class="number">0xBCF46B2E</span>L, <span class="number">0xD4A20068</span>L, <span class="number">0xD4082471</span>L, <span class="number">0x3320F46A</span>L,</span><br><span class="line">     <span class="number">0x43B7D4B7</span>L, <span class="number">0x500061AF</span>L, <span class="number">0x1E39F62E</span>L, <span class="number">0x97244546</span>L, <span class="number">0x14214F74</span>L,</span><br><span class="line">     <span class="number">0xBF8B8840</span>L, <span class="number">0x4D95FC1D</span>L, <span class="number">0x96B591AF</span>L, <span class="number">0x70F4DDD3</span>L, <span class="number">0x66A02F45</span>L,</span><br><span class="line">     <span class="number">0xBFBC09EC</span>L, <span class="number">0x03BD9785</span>L, <span class="number">0x7FAC6DD0</span>L, <span class="number">0x31CB8504</span>L, <span class="number">0x96EB27B3</span>L,</span><br><span class="line">     <span class="number">0x55FD3941</span>L, <span class="number">0xDA2547E6</span>L, <span class="number">0xABCA0A9A</span>L, <span class="number">0x28507825</span>L, <span class="number">0x530429F4</span>L,</span><br><span class="line">     <span class="number">0x0A2C86DA</span>L, <span class="number">0xE9B66DFB</span>L, <span class="number">0x68DC1462</span>L, <span class="number">0xD7486900</span>L, <span class="number">0x680EC0A4</span>L,</span><br><span class="line">     <span class="number">0x27A18DEE</span>L, <span class="number">0x4F3FFEA2</span>L, <span class="number">0xE887AD8C</span>L, <span class="number">0xB58CE006</span>L, <span class="number">0x7AF4D6B6</span>L,</span><br><span class="line">     <span class="number">0xAACE1E7C</span>L, <span class="number">0xD3375FEC</span>L, <span class="number">0xCE78A399</span>L, <span class="number">0x406B2A42</span>L, <span class="number">0x20FE9E35</span>L,</span><br><span class="line">     <span class="number">0xD9F385B9</span>L, <span class="number">0xEE39D7AB</span>L, <span class="number">0x3B124E8B</span>L, <span class="number">0x1DC9FAF7</span>L, <span class="number">0x4B6D1856</span>L,</span><br><span class="line">     <span class="number">0x26A36631</span>L, <span class="number">0xEAE397B2</span>L, <span class="number">0x3A6EFA74</span>L, <span class="number">0xDD5B4332</span>L, <span class="number">0x6841E7F7</span>L,</span><br><span class="line">     <span class="number">0xCA7820FB</span>L, <span class="number">0xFB0AF54E</span>L, <span class="number">0xD8FEB397</span>L, <span class="number">0x454056AC</span>L, <span class="number">0xBA489527</span>L,</span><br><span class="line">     <span class="number">0x55533A3A</span>L, <span class="number">0x20838D87</span>L, <span class="number">0xFE6BA9B7</span>L, <span class="number">0xD096954B</span>L, <span class="number">0x55A867BC</span>L,</span><br><span class="line">     <span class="number">0xA1159A58</span>L, <span class="number">0xCCA92963</span>L, <span class="number">0x99E1DB33</span>L, <span class="number">0xA62A4A56</span>L, <span class="number">0x3F3125F9</span>L,</span><br><span class="line">     <span class="number">0x5EF47E1C</span>L, <span class="number">0x9029317C</span>L, <span class="number">0xFDF8E802</span>L, <span class="number">0x04272F70</span>L, <span class="number">0x80BB155C</span>L,</span><br><span class="line">     <span class="number">0x05282CE3</span>L, <span class="number">0x95C11548</span>L, <span class="number">0xE4C66D22</span>L, <span class="number">0x48C1133F</span>L, <span class="number">0xC70F86DC</span>L,</span><br><span class="line">     <span class="number">0x07F9C9EE</span>L, <span class="number">0x41041F0F</span>L, <span class="number">0x404779A4</span>L, <span class="number">0x5D886E17</span>L, <span class="number">0x325F51EB</span>L,</span><br><span class="line">     <span class="number">0xD59BC0D1</span>L, <span class="number">0xF2BCC18F</span>L, <span class="number">0x41113564</span>L, <span class="number">0x257B7834</span>L, <span class="number">0x602A9C60</span>L,</span><br><span class="line">     <span class="number">0xDFF8E8A3</span>L, <span class="number">0x1F636C1B</span>L, <span class="number">0x0E12B4C2</span>L, <span class="number">0x02E1329E</span>L, <span class="number">0xAF664FD1</span>L,</span><br><span class="line">     <span class="number">0xCAD18115</span>L, <span class="number">0x6B2395E0</span>L, <span class="number">0x333E92E1</span>L, <span class="number">0x3B240B62</span>L, <span class="number">0xEEBEB922</span>L,</span><br><span class="line">     <span class="number">0x85B2A20E</span>L, <span class="number">0xE6BA0D99</span>L, <span class="number">0xDE720C8C</span>L, <span class="number">0x2DA2F728</span>L, <span class="number">0xD0127845</span>L,</span><br><span class="line">     <span class="number">0x95B794FD</span>L, <span class="number">0x647D0862</span>L, <span class="number">0xE7CCF5F0</span>L, <span class="number">0x5449A36F</span>L, <span class="number">0x877D48FA</span>L,</span><br><span class="line">     <span class="number">0xC39DFD27</span>L, <span class="number">0xF33E8D1E</span>L, <span class="number">0x0A476341</span>L, <span class="number">0x992EFF74</span>L, <span class="number">0x3A6F6EAB</span>L,</span><br><span class="line">     <span class="number">0xF4F8FD37</span>L, <span class="number">0xA812DC60</span>L, <span class="number">0xA1EBDDF8</span>L, <span class="number">0x991BE14C</span>L, <span class="number">0xDB6E6B0D</span>L,</span><br><span class="line">     <span class="number">0xC67B5510</span>L, <span class="number">0x6D672C37</span>L, <span class="number">0x2765D43B</span>L, <span class="number">0xDCD0E804</span>L, <span class="number">0xF1290DC7</span>L,</span><br><span class="line">     <span class="number">0xCC00FFA3</span>L, <span class="number">0xB5390F92</span>L, <span class="number">0x690FED0B</span>L, <span class="number">0x667B9FFB</span>L, <span class="number">0xCEDB7D9C</span>L,</span><br><span class="line">     <span class="number">0xA091CF0B</span>L, <span class="number">0xD9155EA3</span>L, <span class="number">0xBB132F88</span>L, <span class="number">0x515BAD24</span>L, <span class="number">0x7B9479BF</span>L,</span><br><span class="line">     <span class="number">0x763BD6EB</span>L, <span class="number">0x37392EB3</span>L, <span class="number">0xCC115979</span>L, <span class="number">0x8026E297</span>L, <span class="number">0xF42E312D</span>L,</span><br><span class="line">     <span class="number">0x6842ADA7</span>L, <span class="number">0xC66A2B3B</span>L, <span class="number">0x12754CCC</span>L, <span class="number">0x782EF11C</span>L, <span class="number">0x6A124237</span>L,</span><br><span class="line">     <span class="number">0xB79251E7</span>L, <span class="number">0x06A1BBE6</span>L, <span class="number">0x4BFB6350</span>L, <span class="number">0x1A6B1018</span>L, <span class="number">0x11CAEDFA</span>L,</span><br><span class="line">     <span class="number">0x3D25BDD8</span>L, <span class="number">0xE2E1C3C9</span>L, <span class="number">0x44421659</span>L, <span class="number">0x0A121386</span>L, <span class="number">0xD90CEC6E</span>L,</span><br><span class="line">     <span class="number">0xD5ABEA2A</span>L, <span class="number">0x64AF674E</span>L, <span class="number">0xDA86A85F</span>L, <span class="number">0xBEBFE988</span>L, <span class="number">0x64E4C3FE</span>L,</span><br><span class="line">     <span class="number">0x9DBC8057</span>L, <span class="number">0xF0F7C086</span>L, <span class="number">0x60787BF8</span>L, <span class="number">0x6003604D</span>L, <span class="number">0xD1FD8346</span>L,</span><br><span class="line">     <span class="number">0xF6381FB0</span>L, <span class="number">0x7745AE04</span>L, <span class="number">0xD736FCCC</span>L, <span class="number">0x83426B33</span>L, <span class="number">0xF01EAB71</span>L,</span><br><span class="line">     <span class="number">0xB0804187</span>L, <span class="number">0x3C005E5F</span>L, <span class="number">0x77A057BE</span>L, <span class="number">0xBDE8AE24</span>L, <span class="number">0x55464299</span>L,</span><br><span class="line">     <span class="number">0xBF582E61</span>L, <span class="number">0x4E58F48F</span>L, <span class="number">0xF2DDFDA2</span>L, <span class="number">0xF474EF38</span>L, <span class="number">0x8789BDC2</span>L,</span><br><span class="line">     <span class="number">0x5366F9C3</span>L, <span class="number">0xC8B38E74</span>L, <span class="number">0xB475F255</span>L, <span class="number">0x46FCD9B9</span>L, <span class="number">0x7AEB2661</span>L,</span><br><span class="line">     <span class="number">0x8B1DDF84</span>L, <span class="number">0x846A0E79</span>L, <span class="number">0x915F95E2</span>L, <span class="number">0x466E598E</span>L, <span class="number">0x20B45770</span>L,</span><br><span class="line">     <span class="number">0x8CD55591</span>L, <span class="number">0xC902DE4C</span>L, <span class="number">0xB90BACE1</span>L, <span class="number">0xBB8205D0</span>L, <span class="number">0x11A86248</span>L,</span><br><span class="line">     <span class="number">0x7574A99E</span>L, <span class="number">0xB77F19B6</span>L, <span class="number">0xE0A9DC09</span>L, <span class="number">0x662D09A1</span>L, <span class="number">0xC4324633</span>L,</span><br><span class="line">     <span class="number">0xE85A1F02</span>L, <span class="number">0x09F0BE8C</span>L, <span class="number">0x4A99A025</span>L, <span class="number">0x1D6EFE10</span>L, <span class="number">0x1AB93D1D</span>L,</span><br><span class="line">     <span class="number">0x0BA5A4DF</span>L, <span class="number">0xA186F20F</span>L, <span class="number">0x2868F169</span>L, <span class="number">0xDCB7DA83</span>L, <span class="number">0x573906FE</span>L,</span><br><span class="line">     <span class="number">0xA1E2CE9B</span>L, <span class="number">0x4FCD7F52</span>L, <span class="number">0x50115E01</span>L, <span class="number">0xA70683FA</span>L, <span class="number">0xA002B5C4</span>L,</span><br><span class="line">     <span class="number">0x0DE6D027</span>L, <span class="number">0x9AF88C27</span>L, <span class="number">0x773F8641</span>L, <span class="number">0xC3604C06</span>L, <span class="number">0x61A806B5</span>L,</span><br><span class="line">     <span class="number">0xF0177A28</span>L, <span class="number">0xC0F586E0</span>L, <span class="number">0x006058AA</span>L, <span class="number">0x30DC7D62</span>L, <span class="number">0x11E69ED7</span>L,</span><br><span class="line">     <span class="number">0x2338EA63</span>L, <span class="number">0x53C2DD94</span>L, <span class="number">0xC2C21634</span>L, <span class="number">0xBBCBEE56</span>L, <span class="number">0x90BCB6DE</span>L,</span><br><span class="line">     <span class="number">0xEBFC7DA1</span>L, <span class="number">0xCE591D76</span>L, <span class="number">0x6F05E409</span>L, <span class="number">0x4B7C0188</span>L, <span class="number">0x39720A3D</span>L,</span><br><span class="line">     <span class="number">0x7C927C24</span>L, <span class="number">0x86E3725F</span>L, <span class="number">0x724D9DB9</span>L, <span class="number">0x1AC15BB4</span>L, <span class="number">0xD39EB8FC</span>L,</span><br><span class="line">     <span class="number">0xED545578</span>L, <span class="number">0x08FCA5B5</span>L, <span class="number">0xD83D7CD3</span>L, <span class="number">0x4DAD0FC4</span>L, <span class="number">0x1E50EF5E</span>L,</span><br><span class="line">     <span class="number">0xB161E6F8</span>L, <span class="number">0xA28514D9</span>L, <span class="number">0x6C51133C</span>L, <span class="number">0x6FD5C7E7</span>L, <span class="number">0x56E14EC4</span>L,</span><br><span class="line">     <span class="number">0x362ABFCE</span>L, <span class="number">0xDDC6C837</span>L, <span class="number">0xD79A3234</span>L, <span class="number">0x92638212</span>L, <span class="number">0x670EFA8E</span>L,</span><br><span class="line">     <span class="number">0x406000E0</span>L&#125;,</span><br><span class="line">    &#123;<span class="number">0x3A39CE37</span>L, <span class="number">0xD3FAF5CF</span>L, <span class="number">0xABC27737</span>L, <span class="number">0x5AC52D1B</span>L, <span class="number">0x5CB0679E</span>L,</span><br><span class="line">     <span class="number">0x4FA33742</span>L, <span class="number">0xD3822740</span>L, <span class="number">0x99BC9BBE</span>L, <span class="number">0xD5118E9D</span>L, <span class="number">0xBF0F7315</span>L,</span><br><span class="line">     <span class="number">0xD62D1C7E</span>L, <span class="number">0xC700C47B</span>L, <span class="number">0xB78C1B6B</span>L, <span class="number">0x21A19045</span>L, <span class="number">0xB26EB1BE</span>L,</span><br><span class="line">     <span class="number">0x6A366EB4</span>L, <span class="number">0x5748AB2F</span>L, <span class="number">0xBC946E79</span>L, <span class="number">0xC6A376D2</span>L, <span class="number">0x6549C2C8</span>L,</span><br><span class="line">     <span class="number">0x530FF8EE</span>L, <span class="number">0x468DDE7D</span>L, <span class="number">0xD5730A1D</span>L, <span class="number">0x4CD04DC6</span>L, <span class="number">0x2939BBDB</span>L,</span><br><span class="line">     <span class="number">0xA9BA4650</span>L, <span class="number">0xAC9526E8</span>L, <span class="number">0xBE5EE304</span>L, <span class="number">0xA1FAD5F0</span>L, <span class="number">0x6A2D519A</span>L,</span><br><span class="line">     <span class="number">0x63EF8CE2</span>L, <span class="number">0x9A86EE22</span>L, <span class="number">0xC089C2B8</span>L, <span class="number">0x43242EF6</span>L, <span class="number">0xA51E03AA</span>L,</span><br><span class="line">     <span class="number">0x9CF2D0A4</span>L, <span class="number">0x83C061BA</span>L, <span class="number">0x9BE96A4D</span>L, <span class="number">0x8FE51550</span>L, <span class="number">0xBA645BD6</span>L,</span><br><span class="line">     <span class="number">0x2826A2F9</span>L, <span class="number">0xA73A3AE1</span>L, <span class="number">0x4BA99586</span>L, <span class="number">0xEF5562E9</span>L, <span class="number">0xC72FEFD3</span>L,</span><br><span class="line">     <span class="number">0xF752F7DA</span>L, <span class="number">0x3F046F69</span>L, <span class="number">0x77FA0A59</span>L, <span class="number">0x80E4A915</span>L, <span class="number">0x87B08601</span>L,</span><br><span class="line">     <span class="number">0x9B09E6AD</span>L, <span class="number">0x3B3EE593</span>L, <span class="number">0xE990FD5A</span>L, <span class="number">0x9E34D797</span>L, <span class="number">0x2CF0B7D9</span>L,</span><br><span class="line">     <span class="number">0x022B8B51</span>L, <span class="number">0x96D5AC3A</span>L, <span class="number">0x017DA67D</span>L, <span class="number">0xD1CF3ED6</span>L, <span class="number">0x7C7D2D28</span>L,</span><br><span class="line">     <span class="number">0x1F9F25CF</span>L, <span class="number">0xADF2B89B</span>L, <span class="number">0x5AD6B472</span>L, <span class="number">0x5A88F54C</span>L, <span class="number">0xE029AC71</span>L,</span><br><span class="line">     <span class="number">0xE019A5E6</span>L, <span class="number">0x47B0ACFD</span>L, <span class="number">0xED93FA9B</span>L, <span class="number">0xE8D3C48D</span>L, <span class="number">0x283B57CC</span>L,</span><br><span class="line">     <span class="number">0xF8D56629</span>L, <span class="number">0x79132E28</span>L, <span class="number">0x785F0191</span>L, <span class="number">0xED756055</span>L, <span class="number">0xF7960E44</span>L,</span><br><span class="line">     <span class="number">0xE3D35E8C</span>L, <span class="number">0x15056DD4</span>L, <span class="number">0x88F46DBA</span>L, <span class="number">0x03A16125</span>L, <span class="number">0x0564F0BD</span>L,</span><br><span class="line">     <span class="number">0xC3EB9E15</span>L, <span class="number">0x3C9057A2</span>L, <span class="number">0x97271AEC</span>L, <span class="number">0xA93A072A</span>L, <span class="number">0x1B3F6D9B</span>L,</span><br><span class="line">     <span class="number">0x1E6321F5</span>L, <span class="number">0xF59C66FB</span>L, <span class="number">0x26DCF319</span>L, <span class="number">0x7533D928</span>L, <span class="number">0xB155FDF5</span>L,</span><br><span class="line">     <span class="number">0x03563482</span>L, <span class="number">0x8ABA3CBB</span>L, <span class="number">0x28517711</span>L, <span class="number">0xC20AD9F8</span>L, <span class="number">0xABCC5167</span>L,</span><br><span class="line">     <span class="number">0xCCAD925F</span>L, <span class="number">0x4DE81751</span>L, <span class="number">0x3830DC8E</span>L, <span class="number">0x379D5862</span>L, <span class="number">0x9320F991</span>L,</span><br><span class="line">     <span class="number">0xEA7A90C2</span>L, <span class="number">0xFB3E7BCE</span>L, <span class="number">0x5121CE64</span>L, <span class="number">0x774FBE32</span>L, <span class="number">0xA8B6E37E</span>L,</span><br><span class="line">     <span class="number">0xC3293D46</span>L, <span class="number">0x48DE5369</span>L, <span class="number">0x6413E680</span>L, <span class="number">0xA2AE0810</span>L, <span class="number">0xDD6DB224</span>L,</span><br><span class="line">     <span class="number">0x69852DFD</span>L, <span class="number">0x09072166</span>L, <span class="number">0xB39A460A</span>L, <span class="number">0x6445C0DD</span>L, <span class="number">0x586CDECF</span>L,</span><br><span class="line">     <span class="number">0x1C20C8AE</span>L, <span class="number">0x5BBEF7DD</span>L, <span class="number">0x1B588D40</span>L, <span class="number">0xCCD2017F</span>L, <span class="number">0x6BB4E3BB</span>L,</span><br><span class="line">     <span class="number">0xDDA26A7E</span>L, <span class="number">0x3A59FF45</span>L, <span class="number">0x3E350A44</span>L, <span class="number">0xBCB4CDD5</span>L, <span class="number">0x72EACEA8</span>L,</span><br><span class="line">     <span class="number">0xFA6484BB</span>L, <span class="number">0x8D6612AE</span>L, <span class="number">0xBF3C6F47</span>L, <span class="number">0xD29BE463</span>L, <span class="number">0x542F5D9E</span>L,</span><br><span class="line">     <span class="number">0xAEC2771B</span>L, <span class="number">0xF64E6370</span>L, <span class="number">0x740E0D8D</span>L, <span class="number">0xE75B1357</span>L, <span class="number">0xF8721671</span>L,</span><br><span class="line">     <span class="number">0xAF537D5D</span>L, <span class="number">0x4040CB08</span>L, <span class="number">0x4EB4E2CC</span>L, <span class="number">0x34D2466A</span>L, <span class="number">0x0115AF84</span>L,</span><br><span class="line">     <span class="number">0xE1B00428</span>L, <span class="number">0x95983A1D</span>L, <span class="number">0x06B89FB4</span>L, <span class="number">0xCE6EA048</span>L, <span class="number">0x6F3F3B82</span>L,</span><br><span class="line">     <span class="number">0x3520AB82</span>L, <span class="number">0x011A1D4B</span>L, <span class="number">0x277227F8</span>L, <span class="number">0x611560B1</span>L, <span class="number">0xE7933FDC</span>L,</span><br><span class="line">     <span class="number">0xBB3A792B</span>L, <span class="number">0x344525BD</span>L, <span class="number">0xA08839E1</span>L, <span class="number">0x51CE794B</span>L, <span class="number">0x2F32C9B7</span>L,</span><br><span class="line">     <span class="number">0xA01FBAC9</span>L, <span class="number">0xE01CC87E</span>L, <span class="number">0xBCC7D1F6</span>L, <span class="number">0xCF0111C3</span>L, <span class="number">0xA1E8AAC7</span>L,</span><br><span class="line">     <span class="number">0x1A908749</span>L, <span class="number">0xD44FBD9A</span>L, <span class="number">0xD0DADECB</span>L, <span class="number">0xD50ADA38</span>L, <span class="number">0x0339C32A</span>L,</span><br><span class="line">     <span class="number">0xC6913667</span>L, <span class="number">0x8DF9317C</span>L, <span class="number">0xE0B12B4F</span>L, <span class="number">0xF79E59B7</span>L, <span class="number">0x43F5BB3A</span>L,</span><br><span class="line">     <span class="number">0xF2D519FF</span>L, <span class="number">0x27D9459C</span>L, <span class="number">0xBF97222C</span>L, <span class="number">0x15E6FC2A</span>L, <span class="number">0x0F91FC71</span>L,</span><br><span class="line">     <span class="number">0x9B941525</span>L, <span class="number">0xFAE59361</span>L, <span class="number">0xCEB69CEB</span>L, <span class="number">0xC2A86459</span>L, <span class="number">0x12BAA8D1</span>L,</span><br><span class="line">     <span class="number">0xB6C1075E</span>L, <span class="number">0xE3056A0C</span>L, <span class="number">0x10D25065</span>L, <span class="number">0xCB03A442</span>L, <span class="number">0xE0EC6E0E</span>L,</span><br><span class="line">     <span class="number">0x1698DB3B</span>L, <span class="number">0x4C98A0BE</span>L, <span class="number">0x3278E964</span>L, <span class="number">0x9F1F9532</span>L, <span class="number">0xE0D392DF</span>L,</span><br><span class="line">     <span class="number">0xD3A0342B</span>L, <span class="number">0x8971F21E</span>L, <span class="number">0x1B0A7441</span>L, <span class="number">0x4BA3348C</span>L, <span class="number">0xC5BE7120</span>L,</span><br><span class="line">     <span class="number">0xC37632D8</span>L, <span class="number">0xDF359F8D</span>L, <span class="number">0x9B992F2E</span>L, <span class="number">0xE60B6F47</span>L, <span class="number">0x0FE3F11D</span>L,</span><br><span class="line">     <span class="number">0xE54CDA54</span>L, <span class="number">0x1EDAD891</span>L, <span class="number">0xCE6279CF</span>L, <span class="number">0xCD3E7E6F</span>L, <span class="number">0x1618B166</span>L,</span><br><span class="line">     <span class="number">0xFD2C1D05</span>L, <span class="number">0x848FD2C5</span>L, <span class="number">0xF6FB2299</span>L, <span class="number">0xF523F357</span>L, <span class="number">0xA6327623</span>L,</span><br><span class="line">     <span class="number">0x93A83531</span>L, <span class="number">0x56CCCD02</span>L, <span class="number">0xACF08162</span>L, <span class="number">0x5A75EBB5</span>L, <span class="number">0x6E163697</span>L,</span><br><span class="line">     <span class="number">0x88D273CC</span>L, <span class="number">0xDE966292</span>L, <span class="number">0x81B949D0</span>L, <span class="number">0x4C50901B</span>L, <span class="number">0x71C65614</span>L,</span><br><span class="line">     <span class="number">0xE6C6C7BD</span>L, <span class="number">0x327A140A</span>L, <span class="number">0x45E1D006</span>L, <span class="number">0xC3F27B9A</span>L, <span class="number">0xC9AA53FD</span>L,</span><br><span class="line">     <span class="number">0x62A80F00</span>L, <span class="number">0xBB25BFE2</span>L, <span class="number">0x35BDD2F6</span>L, <span class="number">0x71126905</span>L, <span class="number">0xB2040222</span>L,</span><br><span class="line">     <span class="number">0xB6CBCF7C</span>L, <span class="number">0xCD769C2B</span>L, <span class="number">0x53113EC0</span>L, <span class="number">0x1640E3D3</span>L, <span class="number">0x38ABBD60</span>L,</span><br><span class="line">     <span class="number">0x2547ADF0</span>L, <span class="number">0xBA38209C</span>L, <span class="number">0xF746CE76</span>L, <span class="number">0x77AFA1C5</span>L, <span class="number">0x20756060</span>L,</span><br><span class="line">     <span class="number">0x85CBFE4E</span>L, <span class="number">0x8AE88DD8</span>L, <span class="number">0x7AAAF9B0</span>L, <span class="number">0x4CF9AA7E</span>L, <span class="number">0x1948C25C</span>L,</span><br><span class="line">     <span class="number">0x02FB8A8C</span>L, <span class="number">0x01C36AE4</span>L, <span class="number">0xD6EBE1F9</span>L, <span class="number">0x90D4F869</span>L, <span class="number">0xA65CDEA0</span>L,</span><br><span class="line">     <span class="number">0x3F09252D</span>L, <span class="number">0xC208E69F</span>L, <span class="number">0xB74E6132</span>L, <span class="number">0xCE77E25B</span>L, <span class="number">0x578FDFE3</span>L,</span><br><span class="line">     <span class="number">0x3AC372E6</span>L&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// f函数</span></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> res;</span><br><span class="line">  res = S[<span class="number">0</span>][(x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>];</span><br><span class="line">  res += S[<span class="number">1</span>][(x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>];</span><br><span class="line">  res ^= S[<span class="number">2</span>][(x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>];</span><br><span class="line">  res += S[<span class="number">3</span>][x &amp; <span class="number">0xff</span>];</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* L, <span class="type">unsigned</span> <span class="type">int</span>* R)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">    *L ^= P[i];</span><br><span class="line">    *R ^= <span class="built_in">f</span>(*L);</span><br><span class="line">    *R ^= P[i + <span class="number">1</span>];</span><br><span class="line">    *L ^= <span class="built_in">f</span>(*R);</span><br><span class="line">  &#125;</span><br><span class="line">  *L ^= P[<span class="number">16</span>];</span><br><span class="line">  *R ^= P[<span class="number">17</span>];</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> temp = *L;</span><br><span class="line">  *L = *R;</span><br><span class="line">  *R = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* L, <span class="type">unsigned</span> <span class="type">int</span>* R)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">16</span>; i &gt; <span class="number">0</span>; i -= <span class="number">2</span>) &#123;</span><br><span class="line">    *L ^= P[i + <span class="number">1</span>];</span><br><span class="line">    *R ^= <span class="built_in">f</span>(*L);</span><br><span class="line">    *R ^= P[i];</span><br><span class="line">    *L ^= <span class="built_in">f</span>(*R);</span><br><span class="line">  &#125;</span><br><span class="line">  *L ^= P[<span class="number">1</span>];</span><br><span class="line">  *R ^= P[<span class="number">0</span>];</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> temp = *L;</span><br><span class="line">  *L = *R;</span><br><span class="line">  *R = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">int</span> keylen)</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>, data = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//对P数组和密钥进行逐位异或，必要时重用密钥</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++) &#123;</span><br><span class="line">    data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">      data &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">      data |= key[index];</span><br><span class="line">      index++;</span><br><span class="line">      <span class="keyword">if</span> (index == keylen) &#123;</span><br><span class="line">        index = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    P[i] ^= data;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 使用当前的P数组和S-box对全0的64位分组使用BlowFish算法进行加密，用输出代替P[1]、P[2]</span></span><br><span class="line">  <span class="comment">// 重复以上步骤使用当前的P数组和S-box对上一步输出进行加密，并用输出代替P[3]、P[4]，</span></span><br><span class="line">  <span class="comment">//   直到按顺序替代所有的P数组和S-box中的元素为止</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">encrypt</span>(&amp;l, &amp;r);</span><br><span class="line">    P[i] = l;</span><br><span class="line">    P[i + <span class="number">1</span>] = r;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j += <span class="number">2</span>) &#123;</span><br><span class="line">      <span class="built_in">encrypt</span>(&amp;l, &amp;r);</span><br><span class="line">      S[i][j] = l;</span><br><span class="line">      S[i][j + <span class="number">1</span>] = r;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span>* argv[])</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> l = <span class="number">1</span>;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> r = <span class="number">2</span>;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">char</span>* key = <span class="string">&quot;ASimpleKey&quot;</span>;</span><br><span class="line">  <span class="built_in">init</span>(key, <span class="number">10</span>);<span class="comment">//init subkey</span></span><br><span class="line">  <span class="built_in">encrypt</span>(&amp;l, &amp;r);<span class="comment">//encrypt</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x,%x\n&quot;</span>, l, r);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="非对称密码"><a href="#非对称密码" class="headerlink" title="非对称密码"></a>非对称密码</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/RC4">RC4_百度百科</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/reverse/identify-encode-encryption/introduction/">常见加密算法和编码识别 - CTF Wiki </a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1016180">DES算法-C&#x2F;C++实现</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1KQ4y127AT/?share_source=copy_web&vd_source=e96311532f2f7af12b275834dfed9adb">DES加密算法｜密码学｜信息安全</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xzj8023tp/p/12970790.html">AES加解密-CBC ECB - 独孤剑—宇枫 - 博客园 </a></p>
<p><a target="_blank" rel="noopener" href="https://yfli.top/2020/02/18/encrypt_document/">对称加密算法&amp;&amp;Hash算法 文档 | feng’s blog (yfli.top)</a></p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/SM4.0/3901780">SM4.0 百度百科</a></p>
<p><a target="_blank" rel="noopener" href="https://n0va-scy.github.io/2022/02/14/sm4%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">国密加密算法sm4 </a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://liquor-vague.github.io">Bag</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://liquor-vague.github.io/2024/03/03/encrypt-reverse/">http://liquor-vague.github.io/2024/03/03/encrypt-reverse/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://liquor-vague.github.io" target="_blank">BAG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="/img/jill.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/19/2024-algorithm-learning/" title="2024算法复健"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">2024算法复健</div></div></a></div><div class="next-post pull-right"><a href="/2024/02/28/2024-learning-records/" title="2024的学习记录"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2024的学习记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/28/2024-ctf-training/" title="2024_ctf_training"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-28</div><div class="title">2024_ctf_training</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/jill.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Bag</div><div class="author-info__description">A rolling stone gathers no moss.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">对称加密算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RC4"><span class="toc-number">1.1.</span> <span class="toc-text">RC4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC"><span class="toc-number">1.1.1.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TEA%E7%B3%BB%E5%88%97%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">TEA系列算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TEA"><span class="toc-number">1.2.1.</span> <span class="toc-text">TEA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-1"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XTEA"><span class="toc-number">1.2.2.</span> <span class="toc-text">XTEA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-2"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XXTEA"><span class="toc-number">1.2.3.</span> <span class="toc-text">XXTEA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-3"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDEA"><span class="toc-number">1.3.</span> <span class="toc-text">IDEA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%90%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">子密钥生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#IDEA%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">IDEA加密</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#IDEA%E8%A7%A3%E5%AF%86"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">IDEA解密</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DES"><span class="toc-number">1.4.</span> <span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-4"><span class="toc-number">1.4.1.</span> <span class="toc-text">脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%93%E5%B1%95%EF%BC%9A3DES"><span class="toc-number">1.4.2.</span> <span class="toc-text">拓展：3DES</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES"><span class="toc-number">1.5.</span> <span class="toc-text">AES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AES%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.1.</span> <span class="toc-text">AES的分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SM4"><span class="toc-number">1.6.</span> <span class="toc-text">SM4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.6.1.</span> <span class="toc-text">前置知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.2.</span> <span class="toc-text">密钥扩展算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.3.</span> <span class="toc-text">加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.4.</span> <span class="toc-text">解密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81"><span class="toc-number">1.6.5.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-5"><span class="toc-number">1.6.6.</span> <span class="toc-text">脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BlowFish"><span class="toc-number">1.7.</span> <span class="toc-text">BlowFish</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86-1"><span class="toc-number">1.7.1.</span> <span class="toc-text">算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%90%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90-1"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">子密钥生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">加密</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">解密</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-6"><span class="toc-number">1.7.2.</span> <span class="toc-text">脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">非对称密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">3.</span> <span class="toc-text">参考资料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/03/Assembly-Language-Experiment-5/" title="王爽《汇编语言》实验五">王爽《汇编语言》实验五</a><time datetime="2024-04-03T08:52:36.000Z" title="发表于 2024-04-03 16:52:36">2024-04-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/01/Assembly-Language-Experiment-4/" title="汇编语言实验四">汇编语言实验四</a><time datetime="2024-04-01T13:36:28.000Z" title="发表于 2024-04-01 21:36:28">2024-04-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/28/2024-ctf-training/" title="2024_ctf_training">2024_ctf_training</a><time datetime="2024-03-28T03:27:48.000Z" title="发表于 2024-03-28 11:27:48">2024-03-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/19/2024-algorithm-learning/" title="2024算法复健">2024算法复健</a><time datetime="2024-03-19T02:22:30.000Z" title="发表于 2024-03-19 10:22:30">2024-03-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/03/encrypt-reverse/" title="逆向中常见加解密算法总结（待更新）">逆向中常见加解密算法总结（待更新）</a><time datetime="2024-03-03T13:20:26.000Z" title="发表于 2024-03-03 21:20:26">2024-03-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Bag</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>